// ============================================================
// VYOMTECH ERP - COMPLETE PRISMA SCHEMA
// ============================================================
// This file is auto-generated by build-schema.js
// Do NOT edit manually - modify the modular schemas in /prisma/schemas/

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// ============================================================
// MODULAR SCHEMAS COMBINED
// ============================================================  id                      String                   @id @db.Char(36)
  name                    String                   @db.VarChar(255)
  domain                  String                   @unique @db.VarChar(255)
  status                  String                   @default("active") @db.VarChar(50)
  maxUsers                Int                      @default(100) @map("max_users")
  maxConcurrentCalls      Int                      @default(50) @map("max_concurrent_calls")
  aiBudgetMonthly         Decimal                  @default(1000.00) @map("ai_budget_monthly") @db.Decimal(15, 2)
  createdAt               DateTime                 @default(now()) @map("created_at")
  updatedAt               DateTime                 @updatedAt @map("updated_at")
  users                   User[]
  currentTenantUsers      User[]                   @relation(name: "currentTenant")
  teams                   Team[]
  systemConfigs           SystemConfig[]
  auditLogs               AuditLog[]
  callCenters             CallCenter[]
  agents                  Agent[]
  aiAgents                AIAgent[]
  skills                  Skill[]
  agentSkills             AgentSkill[]
  campaigns               Campaign[]
  aiCampaigns             AICampaign[]
  queues                  Queue[]
  queueSkillRequirements  QueueSkillRequirement[]
  queueAssignments        QueueAssignment[]
  agentCampaigns          AgentCampaign[]
  calls                   Call[]
  callDispositions        CallDisposition[]
  callRecordings          CallRecording[]
  aiAgentDialogues        AIAgentDialogue[]
  aiConversationLogs      AIConversationLog[]
  callScripts             CallScript[]
  externalProviders       ExternalProvider[]
  providerConnections     ProviderConnection[]
  agentNotes              AgentNote[]
  agentPerformanceMetrics AgentPerformanceMetric[]

  @@index([domain])
  @@index([status])
  @@map("tenant")
}

model User {
  id                  String               @id @db.Char(36) // UUID
  email               String               @unique @db.VarChar(255)
  passwordHash        String               @map("password_hash") @db.VarChar(255)
  role                String               @default("user") @db.VarChar(50)
  tenantId            String               @map("tenant_id") @db.VarChar(36)
  currentTenantId     String?              @map("current_tenant_id") @db.VarChar(36)
  createdAt           DateTime             @default(now()) @map("created_at")
  updatedAt           DateTime             @updatedAt @map("updated_at")
  tenant              Tenant               @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  currentTenant       Tenant?              @relation(name: "currentTenant", fields: [currentTenantId], references: [id], onDelete: SetNull)
  passwordResetTokens PasswordResetToken[]
  authTokens          AuthToken[]
  auditLogs           AuditLog[]
  userRoles           UserRole[]
  accessLogs          AccessLog[]

  @@index([email])
  @@index([tenantId])
  @@index([role])
  @@map("user")
}

model PasswordResetToken {
  id        String   @id @db.Char(26) // ULID
  userId    String   @map("user_id") @db.Char(36)
  token     String   @unique @db.VarChar(255)
  expiresAt DateTime @map("expires_at")
  createdAt DateTime @default(now()) @map("created_at")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([token])
  @@map("password_reset_token")
}

model AuthToken {
  id        String   @id @db.Char(26) // ULID
  userId    String   @map("user_id") @db.Char(36)
  token     String   @unique @db.VarChar(500)
  expiresAt DateTime @map("expires_at")
  createdAt DateTime @default(now()) @map("created_at")
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
  @@index([token])
  @@map("auth_token")
}

model Team {
  id          String   @id @db.Char(26) // ULID
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  teamName    String   @map("team_name") @db.VarChar(255)
  description String?  @db.LongText
  status      String   @default("active") @db.VarChar(50)
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([status])
  @@map("team")
}

model SystemConfig {
  id          String   @id @db.Char(26) // ULID
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  configKey   String   @map("config_key") @db.VarChar(255)
  configValue String?  @map("config_value") @db.LongText
  configType  String   @map("config_type") @db.VarChar(50)
  description String?  @db.LongText
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")
  tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)

  @@unique([tenantId, configKey])
  @@index([tenantId])
  @@map("system_config")
}

model AuditLog {
  id         String   @id @db.Char(26) // ULID
  tenantId   String   @map("tenant_id") @db.VarChar(36)
  userId     String?  @map("user_id") @db.Char(36)
  action     String   @db.VarChar(100)
  entityType String   @map("entity_type") @db.VarChar(100)
  entityId   String?  @map("entity_id") @db.VarChar(36)
  changes    Json?    @map("changes")
  ipAddress  String?  @map("ip_address") @db.VarChar(45)
  createdAt  DateTime @default(now()) @map("created_at")
  tenant     Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  user       User?    @relation(fields: [userId], references: [id], onDelete: SetNull)

  @@index([tenantId])
  @@index([userId])
  @@index([entityType, entityId])
  @@index([createdAt])
  @@map("audit_log")
}

model CallCenter {
  id                  String             @id @default(uuid()) @db.Char(36)
  tenantId            String             @db.Char(36)
  tenant              Tenant             @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  name                String             @db.VarChar(255)
  description         String?            @db.Text
  type                String             @db.VarChar(50) // "INBOUND", "OUTBOUND", "BLENDED"
  status              String             @default("ACTIVE") @db.VarChar(50) // "ACTIVE", "INACTIVE", "SUSPENDED"
  location            String?            @db.VarChar(255)
  phone               String?            @db.VarChar(20)
  email               String?            @db.VarChar(255)
  timezone            String             @default("Asia/Kolkata") @db.VarChar(100)
  operatingHoursStart String?            @db.VarChar(10) // HH:MM format
  operatingHoursEnd   String?            @db.VarChar(10) // HH:MM format
  isHolidayOperating  Boolean            @default(false)
  maxAgents           Int                @default(50)
  maxCampaigns        Int                @default(10)
  maxQueues           Int                @default(20)
  currencyCode        String             @default("INR") @db.VarChar(10)
  costPerMinute       Decimal            @default(0) @db.Decimal(10, 2)
  costPerCall         Decimal            @default(0) @db.Decimal(10, 2)
  createdAt           DateTime           @default(now())
  updatedAt           DateTime           @updatedAt
  agents              Agent[]
  campaigns           Campaign[]
  queues              Queue[]
  dispositions        CallDisposition[]
  calls               Call[]
  recordings          CallRecording[]
  scripts             CallScript[]
  aiAgents            AIAgent[]
  skills              Skill[]
  externalProviders   ExternalProvider[]

  @@index([tenantId])
  @@map("call_centers")
}

model Agent {
  id                    String                   @id @default(uuid()) @db.Char(36)
  tenantId              String                   @db.Char(36)
  tenant                Tenant                   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId          String                   @db.Char(36)
  callCenter            CallCenter               @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  employeeId            String?                  @db.Char(36) // Link to HR Employee if exists
  agentId               String                   @unique @db.VarChar(50) // Unique agent ID like CC001, CC002
  name                  String                   @db.VarChar(255)
  email                 String                   @db.VarChar(255)
  phone                 String                   @db.VarChar(20)
  status                String                   @default("OFFLINE") @db.VarChar(50)
  currentCallId         String?                  @unique @db.Char(36)
  currentCall           Call?                    @relation("CurrentCall", fields: [currentCallId], references: [id], onDelete: SetNull)
  lastStatusChangeTime  DateTime?
  lastCallEndTime       DateTime?
  assignmentType        String                   @default("ANY") @db.VarChar(50)
  stickyAgentPreference Boolean                  @default(false) // If true, tries to assign same agent to same customer
  totalCalls            Int                      @default(0)
  totalHandleTime       Int                      @default(0) // In seconds
  averageHandleTime     Int                      @default(0) // In seconds
  totalWrapUpTime       Int                      @default(0) // In seconds
  startDate             DateTime
  endDate               DateTime?
  workDaysJson          String?                  @db.Text // JSON: ["MON", "TUE", "WED", "THU", "FRI"]
  workingHoursStart     String                   @default("09:00") @db.VarChar(10)
  workingHoursEnd       String                   @default("18:00") @db.VarChar(10)
  breakDurationMinutes  Int                      @default(15)
  lunchDurationMinutes  Int                      @default(60)
  isTraining            Boolean                  @default(false)
  trainingUntil         DateTime?
  createdAt             DateTime                 @default(now())
  updatedAt             DateTime                 @updatedAt
  agentSkills           AgentSkill[]
  agentCampaigns        AgentCampaign[]
  performanceMetrics    AgentPerformanceMetric[]
  notes                 AgentNote[]
  queueAssignments      QueueAssignment[]

  @@index([tenantId])
  @@index([callCenterId])
  @@index([employeeId])
  @@index([status])
  @@map("agents")
}

model AIAgent {
  id                   String              @id @default(uuid()) @db.Char(36)
  tenantId             String              @db.Char(36)
  tenant               Tenant              @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId         String              @db.Char(36)
  callCenter           CallCenter          @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  agentId              String              @unique @db.VarChar(50) // Like AI_AGENT_001
  name                 String              @db.VarChar(255)
  description          String?             @db.Text
  provider             String              @db.VarChar(100)
  providerAgentId      String              @db.VarChar(255) // External AI agent ID from provider
  providerApiKey       String?             @db.Text // Encrypted
  providerConfig       String?             @db.Text // JSON: detailed provider config
  language             String              @default("hi") @db.VarChar(10) // ISO 639-1 code: "en", "hi", "ta", "te", etc.
  voiceType            String              @default("FEMALE") @db.VarChar(50) // "MALE", "FEMALE", "NEUTRAL"
  voiceAccent          String?             @db.VarChar(100) // "INDIAN", "AMERICAN", "BRITISH", etc.
  supportedLanguages   String              @default("en,hi") @db.Text // CSV
  sentiment            String              @default("PROFESSIONAL") @db.VarChar(50) // "PROFESSIONAL", "FRIENDLY", "FORMAL", "CASUAL"
  usesNLU              Boolean             @default(true) // Natural Language Understanding
  usesNLG              Boolean             @default(true) // Natural Language Generation
  learningEnabled      Boolean             @default(true) // Improve from conversations
  emotionDetection     Boolean             @default(true)
  intentRecognition    Boolean             @default(true)
  canMakeOutbound      Boolean             @default(true)
  canReceiveInbound    Boolean             @default(true)
  canConferenceCall    Boolean             @default(false)
  canTransfer          Boolean             @default(true)
  handoverThreshold    Decimal             @default(0.6) @db.Decimal(3, 2) // Confidence threshold (0-1) for handover to human
  handoverPreference   String              @db.VarChar(50) // "AUTO", "REQUIRED", "OPTIONAL"
  status               String              @default("ACTIVE") @db.VarChar(50) // "ACTIVE", "INACTIVE", "TRAINING", "MAINTENANCE"
  isAvailable          Boolean             @default(true)
  currentCallId        String?             @unique @db.Char(36)
  currentCall          Call?               @relation("CurrentAICall", fields: [currentCallId], references: [id], onDelete: SetNull)
  totalCalls           Int                 @default(0)
  successfulCalls      Int                 @default(0) // Calls completed without transfer
  transferredCalls     Int                 @default(0) // Calls transferred to human
  averageConfidence    Decimal             @default(0) @db.Decimal(5, 2) // % confidence in responses
  customerSatisfaction Decimal             @default(0) @db.Decimal(5, 2) // CSAT score
  scriptId             String?             @db.Char(36)
  script               CallScript?         @relation("AIAgentScript", fields: [scriptId], references: [id], onDelete: SetNull)
  knowledgeBaseId      String?             @db.Char(36) // Reference to knowledge base
  createdAt            DateTime            @default(now())
  updatedAt            DateTime            @updatedAt
  calls                Call[]
  aiCampaigns          AICampaign[]
  aiAgentDialogues     AIAgentDialogue[]
  aiConversationLogs   AIConversationLog[]

  @@index([tenantId])
  @@index([callCenterId])
  @@index([status])
  @@map("ai_agents")
}

model Skill {
  id                     String                  @id @default(uuid()) @db.Char(36)
  tenantId               String                  @db.Char(36)
  tenant                 Tenant                  @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId           String                  @db.Char(36)
  callCenter             CallCenter              @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  skillName              String                  @db.VarChar(255)
  description            String?                 @db.Text
  skillCategory          String                  @db.VarChar(100) // "PRODUCT", "LANGUAGE", "TECHNICAL", "CUSTOMER_TYPE", etc.
  level                  String                  @default("BEGINNER") @db.VarChar(50) // "BEGINNER", "INTERMEDIATE", "ADVANCED", "EXPERT"
  routingPriority        Int                     @default(1) // Lower = higher priority for routing
  minimumProficiency     String                  @default("BEGINNER") @db.VarChar(50)
  createdAt              DateTime                @default(now())
  updatedAt              DateTime                @updatedAt
  agentSkills            AgentSkill[]
  queueSkillRequirements QueueSkillRequirement[]

  @@index([tenantId])
  @@index([callCenterId])
  @@map("skills")
}

model AgentSkill {
  id                String   @id @default(uuid()) @db.Char(36)
  tenantId          String   @db.Char(36)
  tenant            Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  agentId           String   @db.Char(36)
  agent             Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)
  skillId           String   @db.Char(36)
  skill             Skill    @relation(fields: [skillId], references: [id], onDelete: Cascade)
  proficiency       String   @default("BEGINNER") @db.VarChar(50)
  yearsOfExperience Int      @default(0)
  isVerified        Boolean  @default(false)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@unique([agentId, skillId])
  @@index([tenantId])
  @@map("agent_skills")
}

model Campaign {
  id                    String          @id @default(uuid()) @db.Char(36)
  tenantId              String          @db.Char(36)
  tenant                Tenant          @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId          String          @db.Char(36)
  callCenter            CallCenter      @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  campaignName          String          @db.VarChar(255)
  description           String?         @db.Text
  campaignType          String          @db.VarChar(50) // "INBOUND", "OUTBOUND", "BLENDED"
  purpose               String          @db.VarChar(100) // "PRESALES", "SALES", "SUPPORT", "FEEDBACK", "COLLECTION"
  status                String          @default("DRAFT") @db.VarChar(50) // "DRAFT", "ACTIVE", "PAUSED", "COMPLETED", "CANCELLED"
  startDate             DateTime?
  endDate               DateTime?
  assignmentStrategy    String          @default("LEAST_BUSY") @db.VarChar(50)
  stickyAgentEnabled    Boolean         @default(false)
  stickyAgentDuration   Int             @default(86400) // In seconds, 24 hours default
  allowAIAgent          Boolean         @default(false)
  allowHumanAgent       Boolean         @default(true)
  aiAgentPriority       Int             @default(1) // 1 = AI first, 2 = Human first, 3 = Balanced
  routeBySource         Boolean         @default(false)
  routeBySubSource      Boolean         @default(false)
  routeByLeadSource     Boolean         @default(true)
  maxWaitTime           Int             @default(900) // In seconds, 15 minutes
  abandonedCallHandling String          @db.VarChar(50) // "VOICEMAIL", "CALLBACK", "SMS", "EMAIL"
  salesProjectId        String?         @db.Char(36) // Link to CRM Project
  createdAt             DateTime        @default(now())
  updatedAt             DateTime        @updatedAt
  agentCampaigns        AgentCampaign[]
  aicampaigns           AICampaign[]
  calls                 Call[]

  @@index([tenantId])
  @@index([callCenterId])
  @@index([status])
  @@map("campaigns")
}

model AICampaign {
  id                   String   @id @default(uuid()) @db.Char(36)
  tenantId             String   @db.Char(36)
  tenant               Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  campaignId           String   @db.Char(36)
  campaign             Campaign @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  aiAgentId            String   @db.Char(36)
  aiAgent              AIAgent  @relation(fields: [aiAgentId], references: [id], onDelete: Cascade)
  assignmentPercentage Int      @default(50) // % of calls to route to this AI agent
  priority             Int      @default(1)
  isActive             Boolean  @default(true)
  createdAt            DateTime @default(now())
  updatedAt            DateTime @updatedAt

  @@unique([campaignId, aiAgentId])
  @@index([tenantId])
  @@map("ai_campaigns")
}

model Queue {
  id                     String                  @id @default(uuid()) @db.Char(36)
  tenantId               String                  @db.Char(36)
  tenant                 Tenant                  @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId           String                  @db.Char(36)
  callCenter             CallCenter              @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  queueName              String                  @db.VarChar(255)
  queueNumber            String                  @db.VarChar(50)
  description            String?                 @db.Text
  maxCapacity            Int                     @default(100)
  currentSize            Int                     @default(0)
  routingStrategy        String                  @default("FIFO") @db.VarChar(50) // "FIFO", "PRIORITY", "SKILL_BASED", "WEIGHTED"
  priorityQueueEnabled   Boolean                 @default(false)
  timeoutSeconds         Int                     @default(300) // Call timeout in queue
  abandonmentThreshold   Int                     @default(600) // When to mark as abandoned
  welcomeMessageId       String?                 @db.Char(36)
  hasWelcomeMessage      Boolean                 @default(false)
  holdMusicUrl           String?                 @db.Text
  hasHoldMusic           Boolean                 @default(false)
  status                 String                  @default("ACTIVE") @db.VarChar(50)
  createdAt              DateTime                @default(now())
  updatedAt              DateTime                @updatedAt
  calls                  Call[]
  queueAssignments       QueueAssignment[]
  queueSkillRequirements QueueSkillRequirement[]

  @@index([tenantId])
  @@index([callCenterId])
  @@map("queues")
}

model QueueSkillRequirement {
  id                 String  @id @default(uuid()) @db.Char(36)
  tenantId           String  @db.Char(36)
  tenant             Tenant  @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  queueId            String  @db.Char(36)
  queue              Queue   @relation(fields: [queueId], references: [id], onDelete: Cascade)
  skillId            String  @db.Char(36)
  skill              Skill   @relation(fields: [skillId], references: [id], onDelete: Cascade)
  isRequired         Boolean @default(false)
  minimumProficiency String  @default("BEGINNER") @db.VarChar(50)
  weight             Int     @default(1) // Importance in routing

  @@unique([queueId, skillId])
  @@index([tenantId])
  @@map("queue_skill_requirements")
}

model QueueAssignment {
  id                  String    @id @default(uuid()) @db.Char(36)
  tenantId            String    @db.Char(36)
  tenant              Tenant    @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  agentId             String    @db.Char(36)
  agent               Agent     @relation(fields: [agentId], references: [id], onDelete: Cascade)
  queueId             String    @db.Char(36)
  queue               Queue     @relation(fields: [queueId], references: [id], onDelete: Cascade)
  assignmentType      String    @default("PRIMARY") @db.VarChar(50) // "PRIMARY", "SECONDARY", "BACKUP"
  priority            Int       @default(1)
  assignmentStartTime DateTime  @default(now())
  assignmentEndTime   DateTime?
  isActive            Boolean   @default(true)

  @@unique([agentId, queueId, assignmentStartTime])
  @@index([tenantId])
  @@map("queue_assignments")
}

model AgentCampaign {
  id                  String    @id @default(uuid()) @db.Char(36)
  tenantId            String    @db.Char(36)
  tenant              Tenant    @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  agentId             String    @db.Char(36)
  agent               Agent     @relation(fields: [agentId], references: [id], onDelete: Cascade)
  campaignId          String    @db.Char(36)
  campaign            Campaign  @relation(fields: [campaignId], references: [id], onDelete: Cascade)
  assignmentType      String    @default("PRIMARY") @db.VarChar(50)
  priority            Int       @default(1)
  assignmentStartTime DateTime  @default(now())
  assignmentEndTime   DateTime?
  isActive            Boolean   @default(true)

  @@unique([agentId, campaignId, assignmentStartTime])
  @@index([tenantId])
  @@map("agent_campaigns")
}

model Call {
  id                     String              @id @default(uuid()) @db.Char(36)
  tenantId               String              @db.Char(36)
  tenant                 Tenant              @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId           String              @db.Char(36)
  callCenter             CallCenter          @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  callId                 String              @unique @db.VarChar(50) // Unique call reference
  callULID               String              @unique @db.Char(26) // ULID for transaction tracking
  campaignId             String?             @db.Char(36)
  campaign               Campaign?           @relation(fields: [campaignId], references: [id], onDelete: SetNull)
  queueId                String?             @db.Char(36)
  queue                  Queue?              @relation(fields: [queueId], references: [id], onDelete: SetNull)
  callDirection          String              @db.VarChar(20) // "INBOUND", "OUTBOUND"
  callerId               String              @db.VarChar(20)
  callerName             String?             @db.VarChar(255)
  callerEmail            String?             @db.VarChar(255)
  recipientId            String?             @db.VarChar(20)
  recipientName          String?             @db.VarChar(255)
  leadId                 String?             @db.Char(36) // CRM SalesLead
  customerId             String?             @db.Char(36) // CRM Customer
  agentId                String?             @db.Char(36)
  aiAgentId              String?             @db.Char(36)
  aiAgent                AIAgent?            @relation(fields: [aiAgentId], references: [id], onDelete: SetNull)
  callType               String              @db.VarChar(50) // "VOICE", "VIDEO", "VOICEMAIL", "CALLBACK"
  source                 String              @db.VarChar(100) // "INBOUND_CALL", "WEBSITE_FORM", "APP", "SMS", "EMAIL", "SOCIAL_MEDIA"
  subSource              String?             @db.VarChar(100) // "GOOGLE_SEARCH", "FACEBOOK_AD", "INSTAGRAM", etc.
  campaignSource         String?             @db.VarChar(100) // Campaign that generated the lead
  callStatus             String              @default("INITIATED") @db.VarChar(50)
  callInitiatedAt        DateTime            @default(now())
  callConnectedAt        DateTime?
  callEndedAt            DateTime?
  callDurationSeconds    Int                 @default(0)
  dispositionId          String?             @db.Char(36)
  disposition            CallDisposition?    @relation(fields: [dispositionId], references: [id], onDelete: SetNull)
  notes                  String?             @db.Text
  transferredFromAgentId String?             @db.Char(36)
  transferredToAgentId   String?             @db.Char(36)
  transferredToAIAgentId String?             @db.Char(36)
  transferReason         String?             @db.VarChar(255)
  transferredAt          DateTime?
  aiHandlingDuration     Int? // In seconds, how long AI handled before transfer
  aiConfidenceScore      Decimal?            @db.Decimal(5, 2) // Confidence in AI response
  wasHandledByAI         Boolean             @default(false)
  wasTransferredFromAI   Boolean             @default(false)
  aiTranscript           String?             @db.Text // If AI handled call
  recordingUrl           String?             @db.Text
  recordingId            String?             @db.VarChar(255)
  recordingStatus        String?             @db.VarChar(50) // "PENDING", "COMPLETED", "FAILED", "DELETED"
  isCallRecorded         Boolean             @default(false)
  satScore               Int? // 1-5 CSAT score
  feedback               String?             @db.Text
  isSensitive            Boolean             @default(false)
  requiresAudit          Boolean             @default(false)
  createdAt              DateTime            @default(now())
  updatedAt              DateTime            @updatedAt
  currentAgentCall       Agent?              @relation("CurrentCall")
  currentAIAgentCall     AIAgent?            @relation("CurrentAICall")
  recordings             CallRecording[]
  aiDialogues            AIAgentDialogue[]
  conversationLogs       AIConversationLog[]
  salesCustomer          SalesCustomer?      @relation(fields: [salesCustomerId], references: [id])
  salesCustomerId        String?             @db.Char(36)

  @@index([tenantId])
  @@index([callCenterId])
  @@index([campaignId])
  @@index([queueId])
  @@index([agentId])
  @@index([aiAgentId])
  @@index([leadId])
  @@index([customerId])
  @@index([callStatus])
  @@index([callInitiatedAt])
  @@map("calls")
}

model CallDisposition {
  id                  String     @id @default(uuid()) @db.Char(36)
  tenantId            String     @db.Char(36)
  tenant              Tenant     @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId        String     @db.Char(36)
  callCenter          CallCenter @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  dispositionCode     String     @db.VarChar(50)
  dispositionName     String     @db.VarChar(255)
  description         String?    @db.Text
  dispositionCategory String     @db.VarChar(100) // "SUCCESSFUL", "UNSUCCESSFUL", "TRANSFERRED", "VOICEMAIL", "CALLBACK", "DO_NOT_CALL"
  isPositive          Boolean    @default(false)
  allowsNotes         Boolean    @default(true)
  requiresFollowup    Boolean    @default(false)
  requiresCallback    Boolean    @default(false)
  allowsWrapupTime    Boolean    @default(true)
  sequenceOrder       Int        @default(1)
  isActive            Boolean    @default(true)
  createdAt           DateTime   @default(now())
  updatedAt           DateTime   @updatedAt
  calls               Call[]

  @@unique([callCenterId, dispositionCode])
  @@index([tenantId])
  @@index([callCenterId])
  @@map("call_dispositions")
}

model CallRecording {
  id                    String     @id @default(uuid()) @db.Char(36)
  tenantId              String     @db.Char(36)
  tenant                Tenant     @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId          String     @db.Char(36)
  callCenter            CallCenter @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  callId                String     @db.Char(36)
  call                  Call       @relation(fields: [callId], references: [id], onDelete: Cascade)
  recordingUrl          String     @db.Text
  recordingExternalId   String     @db.VarChar(255)
  fileSize              BigInt? // In bytes
  fileDuration          Int? // In seconds
  fileFormat            String     @db.VarChar(20) // "MP3", "WAV", "OGG"
  status                String     @default("PROCESSING") @db.VarChar(50) // "PROCESSING", "COMPLETED", "FAILED"
  hasTranscript         Boolean    @default(false)
  transcriptUrl         String?    @db.Text
  transcriptText        String?    @db.LongText // Full transcript
  transcriptionAccuracy Decimal?   @db.Decimal(5, 2) // Confidence %
  hasSentimentAnalysis  Boolean    @default(false)
  overallSentiment      String?    @db.VarChar(50) // "POSITIVE", "NEUTRAL", "NEGATIVE"
  sentimentScore        Decimal?   @db.Decimal(5, 2) // -1 to 1
  isCompliant           Boolean? // Null = not checked
  complianceNotes       String?    @db.Text
  retentionDays         Int? // Days to retain
  deleteAfterDate       DateTime?
  createdAt             DateTime   @default(now())
  updatedAt             DateTime   @updatedAt

  @@index([tenantId])
  @@index([callCenterId])
  @@index([callId])
  @@map("call_recordings")
}

model AIAgentDialogue {
  id                  String   @id @default(uuid()) @db.Char(36)
  tenantId            String   @db.Char(36)
  tenant              Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callId              String   @db.Char(36)
  call                Call     @relation(fields: [callId], references: [id], onDelete: Cascade)
  aiAgentId           String   @db.Char(36)
  aiAgent             AIAgent  @relation(fields: [aiAgentId], references: [id], onDelete: Cascade)
  turnNumber          Int
  speaker             String   @db.VarChar(20) // "CALLER", "AI_AGENT"
  rawText             String   @db.Text
  cleanedText         String   @db.Text
  intent              String?  @db.VarChar(255)
  entities            String?  @db.Text // JSON array of entities
  sentiment           String?  @db.VarChar(50) // "POSITIVE", "NEUTRAL", "NEGATIVE"
  sentimentScore      Decimal? @db.Decimal(5, 2)
  confidence          Decimal  @default(0) @db.Decimal(5, 2) // AI confidence in response
  generatedResponse   String?  @db.Text
  responseType        String?  @db.VarChar(100) // "ANSWER", "CLARIFICATION", "HANDOVER_NOTICE", "GOODBYE"
  turnStartTime       DateTime @default(now())
  turnDurationSeconds Int? // Time to generate response
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  @@index([tenantId])
  @@index([callId])
  @@index([aiAgentId])
  @@map("ai_agent_dialogues")
}

model AIConversationLog {
  id                 String   @id @default(uuid()) @db.Char(36)
  tenantId           String   @db.Char(36)
  tenant             Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callId             String   @db.Char(36)
  call               Call     @relation(fields: [callId], references: [id], onDelete: Cascade)
  aiAgentId          String   @db.Char(36)
  aiAgent            AIAgent  @relation(fields: [aiAgentId], references: [id], onDelete: Cascade)
  totalTurns         Int
  averageConfidence  Decimal  @db.Decimal(5, 2)
  dominantIntent     String?  @db.VarChar(255)
  multipleIntents    Boolean  @default(false)
  overallSentiment   String?  @db.VarChar(50)
  sentimentTrend     String?  @db.VarChar(20) // "IMPROVING", "DECLINING", "STABLE"
  handoverReason     String?  @db.VarChar(255)
  handoverConfidence Decimal? @db.Decimal(5, 2)
  flaggedForReview   Boolean  @default(false)
  reviewNotes        String?  @db.Text
  trainingDataUsed   Boolean  @default(true)
  callerSatisfaction Decimal? @db.Decimal(5, 2) // CSAT from post-call survey
  issueResolved      Boolean?
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  @@index([tenantId])
  @@index([callId])
  @@index([aiAgentId])
  @@map("ai_conversation_logs")
}

model CallScript {
  id                String     @id @default(uuid()) @db.Char(36)
  tenantId          String     @db.Char(36)
  tenant            Tenant     @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId      String     @db.Char(36)
  callCenter        CallCenter @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  scriptName        String     @db.VarChar(255)
  description       String?    @db.Text
  scriptType        String     @db.VarChar(50) // "GREETING", "PITCH", "OBJECTION_HANDLING", "CLOSING", "CUSTOM"
  purpose           String     @db.VarChar(100) // "PRESALES", "SALES", "SUPPORT", "FEEDBACK"
  scriptContent     String     @db.LongText // Detailed script text
  scriptVariations  String?    @db.Text // JSON: alternative phrasings
  isAIOptimized     Boolean    @default(false)
  aiTrainingScore   Decimal?   @db.Decimal(5, 2) // How well AI performs with this script
  complianceChecked Boolean    @default(false)
  complianceNotes   String?    @db.Text
  isActive          Boolean    @default(true)
  version           Int        @default(1)
  createdAt         DateTime   @default(now())
  updatedAt         DateTime   @updatedAt
  aiAgents          AIAgent[]  @relation("AIAgentScript")

  @@index([tenantId])
  @@index([callCenterId])
  @@map("call_scripts")
}

model ExternalProvider {
  id                  String               @id @default(uuid()) @db.Char(36)
  tenantId            String               @db.Char(36)
  tenant              Tenant               @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  callCenterId        String               @db.Char(36)
  callCenter          CallCenter           @relation(fields: [callCenterId], references: [id], onDelete: Cascade)
  providerName        String               @db.VarChar(100)
  providerType        String               @db.VarChar(50)
  apiEndpoint         String               @db.Text
  apiKey              String               @db.Text // Encrypted
  apiSecret           String?              @db.Text // Encrypted
  accountId           String?              @db.VarChar(255)
  country             String               @default("IN") @db.VarChar(10)
  supportedCountries  String               @db.Text // CSV
  supportsInbound     Boolean              @default(true)
  supportsOutbound    Boolean              @default(true)
  supportsConference  Boolean              @default(false)
  supportsRecording   Boolean              @default(true)
  supportsIVR         Boolean              @default(true)
  supportsTransfer    Boolean              @default(true)
  allocatedNumbers    String               @db.Text // JSON: list of phone numbers
  numberFormat        String               @default("E.164") @db.VarChar(20)
  costModel           String               @db.VarChar(50) // "PER_MINUTE", "PER_CALL", "MONTHLY", "HYBRID"
  costPerMinute       Decimal?             @db.Decimal(10, 4)
  costPerCall         Decimal?             @db.Decimal(10, 2)
  setupCost           Decimal?             @db.Decimal(10, 2)
  status              String               @default("ACTIVE") @db.VarChar(50) // "ACTIVE", "INACTIVE", "TESTING", "ERROR"
  lastHealthCheck     DateTime?
  isHealthy           Boolean              @default(true)
  webhookUrl          String?              @db.Text // Our webhook URL for provider callbacks
  webhookSecret       String?              @db.Text // Encrypted
  notes               String?              @db.Text
  createdAt           DateTime             @default(now())
  updatedAt           DateTime             @updatedAt
  providerConnections ProviderConnection[]

  @@unique([tenantId, callCenterId, providerName])
  @@index([tenantId])
  @@index([callCenterId])
  @@index([status])
  @@map("external_providers")
}

model ProviderConnection {
  id                   String           @id @default(uuid()) @db.Char(36)
  tenantId             String           @db.Char(36)
  tenant               Tenant           @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  providerId           String           @db.Char(36)
  provider             ExternalProvider @relation(fields: [providerId], references: [id], onDelete: Cascade)
  callCenterId         String           @db.Char(36)
  isPrimary            Boolean          @default(false) // Primary provider for failover
  priority             Int              @default(1) // Lower = higher priority
  allocationPercentage Int              @default(100) // % of calls to route to this provider
  isActive             Boolean          @default(true)
  connectionStatus     String           @default("CONNECTED") @db.VarChar(50) // "CONNECTED", "DISCONNECTED", "ERROR", "TESTING"
  connectedAt          DateTime?
  lastActivityAt       DateTime?
  createdAt            DateTime         @default(now())
  updatedAt            DateTime         @updatedAt

  @@unique([providerId, callCenterId])
  @@index([tenantId])
  @@map("provider_connections")
}

model AgentNote {
  id          String   @id @default(uuid()) @db.Char(36)
  tenantId    String   @db.Char(36)
  tenant      Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  agentId     String   @db.Char(36)
  agent       Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)
  noteType    String   @db.VarChar(50) // "PERFORMANCE", "FEEDBACK", "TRAINING", "INCIDENT", "PERSONAL"
  noteTitle   String   @db.VarChar(255)
  noteContent String   @db.Text
  severity    String?  @db.VarChar(20) // "LOW", "MEDIUM", "HIGH", "CRITICAL"
  createdBy   String   @db.VarChar(255)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@index([tenantId])
  @@index([agentId])
  @@map("agent_notes")
}

model AgentPerformanceMetric {
  id                String   @id @default(uuid()) @db.Char(36)
  tenantId          String   @db.Char(36)
  tenant            Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade)
  agentId           String   @db.Char(36)
  agent             Agent    @relation(fields: [agentId], references: [id], onDelete: Cascade)
  metricDate        DateTime
  metricPeriod      String   @default("DAILY") @db.VarChar(20) // "DAILY", "WEEKLY", "MONTHLY"
  totalCalls        Int      @default(0)
  inboundCalls      Int      @default(0)
  outboundCalls     Int      @default(0)
  answeredCalls     Int      @default(0)
  missedCalls       Int      @default(0)
  totalTalkTime     Int      @default(0) // In seconds
  totalHoldTime     Int      @default(0)
  totalWrapUpTime   Int      @default(0)
  totalBreakTime    Int      @default(0)
  answerRate        Decimal  @default(0) @db.Decimal(5, 2) // %
  averageHandleTime Int      @default(0) // In seconds
  averageHoldTime   Decimal  @default(0) @db.Decimal(8, 2)
  averageCSAT       Decimal  @default(0) @db.Decimal(5, 2) // CSAT score
  transferRate      Decimal  @default(0) @db.Decimal(5, 2) // %
  salesConversions  Int      @default(0)
  conversionRate    Decimal  @default(0) @db.Decimal(5, 2) // %
  totalSalesValue   Decimal  @default(0) @db.Decimal(15, 2)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@unique([agentId, metricDate, metricPeriod])
  @@index([tenantId])
  @@index([agentId])
  @@index([metricDate])
  @@map("agent_performance_metrics")
}

enum AttributionBucket {
  SEO // Organic search (Google, Bing, Yahoo, Discover, Local Pack)
  SEM // Paid search (Google Ads, Bing Ads, etc)
  SMM // Social media (Facebook, Instagram, LinkedIn, Twitter, YouTube)
  PORTALS // Listing platforms (99acres, MagicBricks, Housing, NoBroker, SquareYards)
  OWNED // Your assets (Website, WhatsApp, Email, SMS, CRM Remarketing)
  OFFLINE // Physical touchpoints (Walk-ins, Print, BTL Activations)
  AFFILIATE // Channel partners (Brokers, Referrals, Consultants)
  DIRECT // Residual/Direct traffic (Direct, Bookmark, Typed URL)

  @@map("attribution_bucket")
}

enum AttributionSource {
  google
  bing
  yahoo
  other_search
  meta // Facebook + Instagram parent
  instagram
  facebook
  youtube
  linkedin
  twitter
  portal_99acres
  portal_magicbricks
  portal_housing
  portal_nobroker
  portal_squareyards
  website
  whatsapp
  email
  sms
  crm
  walk_in
  print_media
  btl_activation
  broker
  referral
  consultant
  direct

  @@map("attribution_source")
}

enum AttributionSubSource {
  google_organic
  bing_organic
  yahoo_organic
  discover
  local_pack
  google_search_ads
  google_display_ads
  youtube_ads
  performance_max
  bing_ads
  facebook_ads
  instagram_ads
  linkedin_ads
  twitter_ads
  instagram_organic
  facebook_organic
  youtube_organic
  linkedin_organic
  portal_listing // Generic for all portals
  web_form
  whatsapp_chat
  email_campaign
  sms_campaign
  crm_remarketing
  walk_in_site // At site/project
  walk_in_office // At office
  newspaper
  magazine
  flyers
  brochure
  mall_stall
  roadshow_stall
  expo_stall
  society_activation
  channel_partner
  referral_agent
  property_consultant
  direct_unknown
  bookmark
  typed_url

  @@map("attribution_subsource")
}

model AttributionEvent {
  id                   String               @id @db.Char(36)
  tenantId             String               @map("tenant_id") @db.VarChar(36)
  eventId              String               @map("event_id") @db.Char(26) // ULID
  leadId               String?              @map("lead_id") @db.VarChar(36)
  visitorId            String?              @map("visitor_id") @db.VarChar(36)
  sessionId            String?              @map("session_id") @db.VarChar(100)
  attributionBucket    AttributionBucket    @map("attribution_bucket")
  attributionSource    AttributionSource    @map("attribution_source")
  attributionSubSource AttributionSubSource @map("attribution_subsource")
  eventType            String               @map("event_type") @db.VarChar(100) // page_view, form_submit, call, sms, whatsapp_msg, site_visit, etc
  eventValue           Decimal?             @map("event_value") @db.Decimal(15, 2)
  eventData            String?              @map("event_data") @db.LongText // JSON: {form_fields, call_duration, conversion_type, etc}
  campaign             String?              @db.VarChar(255)
  adSet                String?              @map("ad_set") @db.VarChar(255)
  ad                   String?              @db.VarChar(255)
  keyword              String?              @db.VarChar(255)
  referrer             String?              @db.Text
  userAgent            String?              @map("user_agent") @db.Text
  ipAddress            String?              @map("ip_address") @db.VarChar(45)
  country              String?              @db.VarChar(100)
  state                String?              @db.VarChar(100)
  city                 String?              @db.VarChar(100)
  source               String?              @db.VarChar(100) // e.g., "web_pixel", "api", "manual", "import"
  isTest               Boolean              @default(false) @map("is_test")
  eventTimestamp       DateTime             @map("event_timestamp") @db.DateTime
  createdAt            DateTime             @default(now()) @map("created_at")
  lead                 SalesLead?           @relation(fields: [leadId], references: [id], onDelete: SetNull)

  @@unique([tenantId, eventId])
  @@index([tenantId, attributionBucket])
  @@index([tenantId, attributionSource])
  @@index([tenantId, attributionSubSource])
  @@index([tenantId, eventTimestamp])
  @@index([tenantId, leadId])
  @@index([tenantId, visitorId])
  @@index([tenantId, campaign])
  @@index([leadId])
  @@index([visitorId])
  @@map("attribution_event")
}

model AttributionBucketConfig {
  id                String            @id @db.Char(36)
  tenantId          String            @map("tenant_id") @db.VarChar(36)
  bucket            AttributionBucket @map("bucket")
  bucketLabel       String            @map("bucket_label") @db.VarChar(100)
  bucketDescription String?           @map("bucket_description") @db.Text
  isActive          Boolean           @default(true) @map("is_active")
  priority          Int               @default(0) // For attribution model weighting
  weight            Decimal           @default(1.0) @db.Decimal(5, 2) // For custom attribution models
  createdAt         DateTime          @default(now()) @map("created_at")
  updatedAt         DateTime          @updatedAt @map("updated_at")

  @@unique([tenantId, bucket])
  @@index([tenantId, isActive])
  @@map("attribution_bucket_config")
}

model AttributionSourceConfig {
  id                    String            @id @db.Char(36)
  tenantId              String            @map("tenant_id") @db.VarChar(36)
  source                AttributionSource @map("source")
  sourceLabel           String            @map("source_label") @db.VarChar(100)
  sourceDescription     String?           @map("source_description") @db.Text
  isActive              Boolean           @default(true) @map("is_active")
  requiresAuthorization Boolean           @default(false) @map("requires_authorization")
  apiKeyRequired        Boolean           @default(false) @map("api_key_required")
  integrationUrl        String?           @map("integration_url") @db.VarChar(500)
  lastSyncDate          DateTime?         @map("last_sync_date")
  createdAt             DateTime          @default(now()) @map("created_at")
  updatedAt             DateTime          @updatedAt @map("updated_at")

  @@unique([tenantId, source])
  @@index([tenantId, isActive])
  @@map("attribution_source_config")
}

model LeadAttributionSnapshot {
  id                  String                @id @db.Char(36)
  tenantId            String                @map("tenant_id") @db.VarChar(36)
  leadId              String                @map("lead_id") @db.VarChar(36)
  firstTouchBucket    AttributionBucket?    @map("first_touch_bucket")
  firstTouchSource    AttributionSource?    @map("first_touch_source")
  firstTouchSubSource AttributionSubSource? @map("first_touch_subsource")
  firstTouchCampaign  String?               @map("first_touch_campaign") @db.VarChar(255)
  firstTouchDate      DateTime?             @map("first_touch_date")
  lastTouchBucket     AttributionBucket?    @map("last_touch_bucket")
  lastTouchSource     AttributionSource?    @map("last_touch_source")
  lastTouchSubSource  AttributionSubSource? @map("last_touch_subsource")
  lastTouchCampaign   String?               @map("last_touch_campaign") @db.VarChar(255)
  lastTouchDate       DateTime?             @map("last_touch_date")
  totalTouches        Int                   @default(1) @map("total_touches")
  touchesByBucket     String?               @map("touches_by_bucket") @db.LongText // JSON: {SEO: 2, SEM: 1, SMM: 3}
  touchesBySource     String?               @map("touches_by_source") @db.LongText // JSON: {google: 1, meta: 2, linkedin: 1}
  touchSequence       String?               @map("touch_sequence") @db.LongText // JSON: [{bucket, source, subsource, date}, ...]
  conversionBucket    AttributionBucket?    @map("conversion_bucket")
  conversionSource    AttributionSource?    @map("conversion_source")
  conversionSubSource AttributionSubSource? @map("conversion_subsource")
  conversionDate      DateTime?             @map("conversion_date")
  snaphotDate         DateTime              @map("snapshot_date") @db.Date
  isConverted         Boolean               @default(false) @map("is_converted")
  conversionValue     Decimal?              @map("conversion_value") @db.Decimal(15, 2)
  createdAt           DateTime              @default(now()) @map("created_at")
  updatedAt           DateTime              @updatedAt @map("updated_at")
  lead                SalesLead             @relation(fields: [leadId], references: [id], onDelete: Cascade)

  @@unique([tenantId, leadId, snaphotDate])
  @@index([tenantId, leadId])
  @@index([tenantId, firstTouchBucket])
  @@index([tenantId, lastTouchBucket])
  @@index([tenantId, conversionBucket])
  @@index([tenantId, isConverted])
  @@index([snaphotDate])
  @@map("lead_attribution_snapshot")
}

model AttributionRule {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  ruleName    String   @map("rule_name") @db.VarChar(255)
  description String?  @db.Text
  ruleType    String   @map("rule_type") @db.VarChar(50) // first_touch, last_touch, linear, position_based, time_decay, custom
  conditions  String?  @db.LongText // JSON: {bucket: "SEO", excludeTest: true, ...}
  isActive    Boolean  @default(true) @map("is_active")
  priority    Int      @default(0) // Higher = evaluated first
  createdBy   String?  @map("created_by") @db.VarChar(36)
  createdAt   DateTime @default(now()) @map("created_at")
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([tenantId, isActive])
  @@map("attribution_rule")
}

model AttributionExclusion {
  id              String    @id @db.Char(36)
  tenantId        String    @map("tenant_id") @db.VarChar(36)
  exclusionType   String    @map("exclusion_type") @db.VarChar(100) // bot, test, internal, spam, duplicate
  exclusionName   String    @map("exclusion_name") @db.VarChar(255)
  description     String?   @db.Text
  matchType       String    @map("match_type") @db.VarChar(50) // exact, contains, regex, ip_range
  matchValue      String    @map("match_value") @db.VarChar(500)
  field           String    @db.VarChar(100) // user_agent, ip_address, keyword, etc
  isActive        Boolean   @default(true) @map("is_active")
  appliedCount    Int       @default(0) @map("applied_count")
  lastAppliedDate DateTime? @map("last_applied_date")
  createdAt       DateTime  @default(now()) @map("created_at")

  @@index([tenantId, field])
  @@index([tenantId, isActive])
  @@map("attribution_exclusion")
}

model AttributionMetric {
  id                String            @id @db.Char(36)
  tenantId          String            @map("tenant_id") @db.VarChar(36)
  metricDate        DateTime          @map("metric_date") @db.Date
  bucket            AttributionBucket @map("bucket")
  totalEvents       Int               @map("total_events")
  uniqueLeads       Int               @map("unique_leads")
  uniqueVisitors    Int               @map("unique_visitors")
  conversions       Int
  conversionRate    Decimal           @map("conversion_rate") @db.Decimal(5, 4) // percentage as 0.0523
  avgTouchesPerLead Decimal           @map("avg_touches_per_lead") @db.Decimal(5, 2)
  totalSpend        Decimal?          @map("total_spend") @db.Decimal(15, 2)
  totalRevenue      Decimal?          @map("total_revenue") @db.Decimal(15, 2)
  roi               Decimal?          @map("roi") @db.Decimal(8, 2) // percentage
  dataQuality       String            @map("data_quality") @db.VarChar(50) // complete, partial, estimated
  lastUpdated       DateTime          @map("last_updated") @db.DateTime

  @@unique([tenantId, metricDate, bucket])
  @@index([tenantId, metricDate])
  @@index([tenantId, bucket])
  @@map("attribution_metric")
}

model AttributionAuditLog {
  id         String   @id @db.Char(36)
  tenantId   String   @map("tenant_id") @db.VarChar(36)
  action     String   @db.VarChar(100) // event_created, rule_changed, bucket_updated, etc
  entityType String   @map("entity_type") @db.VarChar(100) // AttributionEvent, AttributionRule, etc
  entityId   String?  @map("entity_id") @db.VarChar(36)
  oldValue   String?  @map("old_value") @db.LongText // JSON
  newValue   String?  @map("new_value") @db.LongText // JSON
  userId     String?  @map("user_id") @db.VarChar(36)
  ipAddress  String?  @map("ip_address") @db.VarChar(45)
  createdAt  DateTime @default(now()) @map("created_at")

  @@index([tenantId, action])
  @@index([tenantId, entityType])
  @@index([tenantId, createdAt])
  @@map("attribution_audit_log")
}

model Vendor {
  id                       String                @id @db.Char(36)
  tenantId                 String                @map("tenant_id") @db.VarChar(36)
  vendorCode               String                @unique @map("vendor_code") @db.VarChar(50)
  name                     String                @db.VarChar(255)
  email                    String?               @db.VarChar(255)
  phone                    String?               @db.VarChar(20)
  address                  String?               @db.Text
  city                     String?               @db.VarChar(100)
  state                    String?               @db.VarChar(100)
  country                  String?               @db.VarChar(100)
  postalCode               String?               @map("postal_code") @db.VarChar(20)
  taxId                    String?               @map("tax_id") @db.VarChar(50)
  paymentTerms             String?               @map("payment_terms") @db.VarChar(100)
  vendorType               String?               @map("vendor_type") @db.VarChar(50)
  rating                   Decimal?              @db.Decimal(3, 1)
  isActive                 Boolean               @default(true) @map("is_active")
  isBlocked                Boolean               @default(false) @map("is_blocked")
  status                   String                @default("active") @db.VarChar(50)
  createdBy                String?               @map("created_by") @db.VarChar(36)
  glVendorPayableAccountId String?               @map("gl_vendor_payable_account_id") @db.VarChar(36)
  createdAt                DateTime              @default(now()) @map("created_at")
  updatedAt                DateTime              @updatedAt @map("updated_at")
  vendorContacts           VendorContact[]
  vendorAddresses          VendorAddress[]
  purchaseOrders           PurchaseOrder[]
  inventoryItemVendors     InventoryItemVendor[]
  vendorInvoices           VendorInvoice[]

  @@index([tenantId])
  @@index([vendorCode])
  @@index([status])
  @@map("vendor")
}

model VendorContact {
  id        String   @id @db.Char(36)
  tenantId  String   @map("tenant_id") @db.VarChar(36)
  vendorId  String   @map("vendor_id") @db.VarChar(36)
  name      String   @db.VarChar(100)
  title     String?  @db.VarChar(100)
  phone     String?  @db.VarChar(20)
  email     String?  @db.VarChar(255)
  isPrimary Boolean  @default(false) @map("is_primary")
  createdAt DateTime @default(now()) @map("created_at")
  vendor    Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([vendorId])
  @@map("vendor_contact")
}

model VendorAddress {
  id        String   @id @db.Char(36)
  tenantId  String   @map("tenant_id") @db.VarChar(36)
  vendorId  String   @map("vendor_id") @db.VarChar(36)
  type      String?  @db.VarChar(50)
  line1     String?  @db.VarChar(255)
  line2     String?  @db.VarChar(255)
  city      String?  @db.VarChar(100)
  state     String?  @db.VarChar(100)
  country   String?  @db.VarChar(100)
  postCode  String?  @map("post_code") @db.VarChar(20)
  isPrimary Boolean  @default(false) @map("is_primary")
  createdAt DateTime @default(now()) @map("created_at")
  vendor    Vendor   @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([vendorId])
  @@map("vendor_address")
}

model PurchaseRequisition {
  id                String          @id @db.Char(36)
  tenantId          String          @map("tenant_id") @db.VarChar(36)
  requisitionNumber String          @unique @map("requisition_number") @db.VarChar(50)
  requesterId       String?         @map("requester_id") @db.VarChar(36)
  department        String?         @db.VarChar(100)
  requestDate       DateTime        @map("request_date") @db.Date
  requiredByDate    DateTime?       @map("required_by_date") @db.Date
  purpose           String?         @db.Text
  status            String          @default("draft") @db.VarChar(50)
  approvedBy        String?         @map("approved_by") @db.VarChar(36)
  approvedAt        DateTime?       @map("approved_at")
  rejectionReason   String?         @map("rejection_reason") @db.Text
  createdBy         String?         @map("created_by") @db.VarChar(36)
  createdAt         DateTime        @default(now()) @map("created_at")
  updatedAt         DateTime        @updatedAt @map("updated_at")
  purchaseOrders    PurchaseOrder[]

  @@index([tenantId])
  @@index([requisitionNumber])
  @@index([status])
  @@map("purchase_requisition")
}

model PurchaseOrder {
  id                   String               @id @db.Char(36)
  tenantId             String               @map("tenant_id") @db.VarChar(36)
  poNumber             String               @unique @map("po_number") @db.VarChar(50)
  vendorId             String               @map("vendor_id") @db.VarChar(36)
  requisitionId        String?              @map("requisition_id") @db.VarChar(36)
  poDate               DateTime             @map("po_date") @db.Date
  deliveryDate         DateTime?            @map("delivery_date") @db.Date
  totalAmount          Decimal?             @map("total_amount") @db.Decimal(18, 2)
  taxAmount            Decimal              @default(0) @map("tax_amount") @db.Decimal(18, 2)
  shippingAmount       Decimal              @default(0) @map("shipping_amount") @db.Decimal(18, 2)
  discountAmount       Decimal              @default(0) @map("discount_amount") @db.Decimal(18, 2)
  netAmount            Decimal?             @map("net_amount") @db.Decimal(18, 2)
  paymentTerms         String?              @map("payment_terms") @db.VarChar(100)
  deliveryLocation     String?              @map("delivery_location") @db.VarChar(255)
  specialInstructions  String?              @map("special_instructions") @db.Text
  status               String               @default("draft") @db.VarChar(50)
  sentToVendorAt       DateTime?            @map("sent_to_vendor_at")
  acknowledgedAt       DateTime?            @map("acknowledged_at")
  createdBy            String?              @map("created_by") @db.VarChar(36)
  glInventoryAccountId String?              @map("gl_inventory_account_id") @db.VarChar(36)
  glExpenseAccountId   String?              @map("gl_expense_account_id") @db.VarChar(36)
  createdAt            DateTime             @default(now()) @map("created_at")
  updatedAt            DateTime             @updatedAt @map("updated_at")
  vendor               Vendor               @relation(fields: [vendorId], references: [id])
  requisition          PurchaseRequisition? @relation(fields: [requisitionId], references: [id])
  poLineItems          PoLineItem[]
  goodsReceipts        GoodsReceipt[]
  inventoryBatches     InventoryBatch[]

  @@index([tenantId])
  @@index([poNumber])
  @@index([vendorId])
  @@index([status])
  @@map("purchase_order")
}

model PoLineItem {
  id               String        @id @db.Char(36)
  tenantId         String        @map("tenant_id") @db.VarChar(36)
  poId             String        @map("po_id") @db.VarChar(36)
  inventoryItemId  String?       @map("inventory_item_id") @db.VarChar(36)
  description      String?       @db.VarChar(500)
  quantity         Decimal       @db.Decimal(18, 4)
  unitPrice        Decimal       @map("unit_price") @db.Decimal(18, 4)
  lineAmount       Decimal       @map("line_amount") @db.Decimal(18, 2)
  taxPercent       Decimal       @default(0) @map("tax_percent") @db.Decimal(5, 2)
  taxAmount        Decimal       @default(0) @map("tax_amount") @db.Decimal(18, 2)
  lineTotal        Decimal       @map("line_total") @db.Decimal(18, 2)
  deliveryDate     DateTime?     @map("delivery_date") @db.Date
  quantityReceived Decimal       @default(0) @map("quantity_received") @db.Decimal(18, 4)
  quantityInvoiced Decimal       @default(0) @map("quantity_invoiced") @db.Decimal(18, 4)
  status           String        @default("pending") @db.VarChar(50)
  createdAt        DateTime      @default(now()) @map("created_at")
  po               PurchaseOrder @relation(fields: [poId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([poId])
  @@map("po_line_item")
}

model GoodsReceipt {
  id               String        @id @db.Char(36)
  tenantId         String        @map("tenant_id") @db.VarChar(36)
  grnNumber        String        @unique @map("grn_number") @db.VarChar(50)
  poId             String        @map("po_id") @db.VarChar(36)
  vendorId         String?       @map("vendor_id") @db.VarChar(36)
  receiptDate      DateTime      @map("receipt_date") @db.Date
  warehouseId      String?       @map("warehouse_id") @db.VarChar(36)
  receivedBy       String?       @map("received_by") @db.VarChar(36)
  inspectionStatus String?       @map("inspection_status") @db.VarChar(50)
  acceptanceStatus String        @default("pending") @map("acceptance_status") @db.VarChar(50)
  notes            String?       @db.Text
  referenceNumber  String?       @map("reference_number") @db.VarChar(100)
  createdAt        DateTime      @default(now()) @map("created_at")
  updatedAt        DateTime      @updatedAt @map("updated_at")
  po               PurchaseOrder @relation(fields: [poId], references: [id])
  grnLineItems     GrnLineItem[]

  @@index([tenantId])
  @@index([grnNumber])
  @@index([poId])
  @@map("goods_receipt")
}

model GrnLineItem {
  id               String       @id @db.Char(36)
  tenantId         String       @map("tenant_id") @db.VarChar(36)
  grnId            String       @map("grn_id") @db.VarChar(36)
  poLineItemId     String?      @map("po_line_item_id") @db.VarChar(36)
  inventoryItemId  String?      @map("inventory_item_id") @db.VarChar(36)
  quantityReceived Decimal      @map("quantity_received") @db.Decimal(18, 4)
  quantityAccepted Decimal      @default(0) @map("quantity_accepted") @db.Decimal(18, 4)
  quantityRejected Decimal      @default(0) @map("quantity_rejected") @db.Decimal(18, 4)
  rejectionReason  String?      @map("rejection_reason") @db.Text
  batchNumber      String?      @map("batch_number") @db.VarChar(100)
  expiryDate       DateTime?    @map("expiry_date") @db.Date
  serialNumbers    String?      @map("serial_numbers") @db.Text
  createdAt        DateTime     @default(now()) @map("created_at")
  grn              GoodsReceipt @relation(fields: [grnId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([grnId])
  @@map("grn_line_item")
}

model VendorInvoice {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  vendorId       String    @map("vendor_id") @db.VarChar(36)
  invoiceNumber  String    @map("invoice_number") @db.VarChar(100)
  invoiceDate    DateTime  @map("invoice_date") @db.Date
  dueDate        DateTime? @map("due_date") @db.Date
  totalAmount    Decimal   @map("total_amount") @db.Decimal(18, 2)
  taxAmount      Decimal   @default(0) @map("tax_amount") @db.Decimal(18, 2)
  discountAmount Decimal   @default(0) @map("discount_amount") @db.Decimal(18, 2)
  payableAmount  Decimal   @map("payable_amount") @db.Decimal(18, 2)
  currency       String    @default("USD") @db.VarChar(3)
  status         String    @default("draft") @db.VarChar(50) // draft, submitted, approved, rejected, paid, cancelled
  description    String?   @db.Text
  notes          String?   @db.Text
  attachments    String?   @db.Text // JSON array of file references
  createdAt      DateTime  @default(now()) @map("created_at")
  updatedAt      DateTime  @updatedAt @map("updated_at")
  vendor         Vendor    @relation(fields: [vendorId], references: [id], onDelete: Restrict)

  @@unique([tenantId, invoiceNumber])
  @@index([tenantId])
  @@index([vendorId])
  @@index([invoiceDate])
  @@map("vendor_invoice")
}

model Warehouse {
  id                   String          @id @db.Char(36)
  tenantId             String          @map("tenant_id") @db.VarChar(36)
  warehouseCode        String          @map("warehouse_code") @db.VarChar(50)
  warehouseName        String          @map("warehouse_name") @db.VarChar(255)
  warehouseType        String?         @map("warehouse_type") @db.VarChar(50)
  address              String?         @db.Text
  city                 String?         @db.VarChar(100)
  state                String?         @db.VarChar(100)
  country              String?         @db.VarChar(100)
  postalCode           String?         @map("postal_code") @db.VarChar(20)
  managerId            String?         @map("manager_id") @db.VarChar(36)
  capacity             Decimal?        @db.Decimal(18, 2)
  currentUtilization   Decimal         @default(0) @map("current_utilization") @db.Decimal(18, 2)
  isActive             Boolean         @default(true) @map("is_active")
  glInventoryAccountId String?         @map("gl_inventory_account_id") @db.VarChar(36)
  createdBy            String?         @map("created_by") @db.VarChar(36)
  createdAt            DateTime        @default(now()) @map("created_at")
  updatedAt            DateTime        @updatedAt @map("updated_at")
  stockLevels          StockLevel[]
  stockMovements       StockMovement[]

  @@unique([tenantId, warehouseCode])
  @@index([tenantId])
  @@index([warehouseCode])
  @@index([isActive])
  @@map("warehouse")
}

model InventoryItem {
  id                       String                    @id @db.Char(36)
  tenantId                 String                    @map("tenant_id") @db.VarChar(36)
  sku                      String                    @db.VarChar(50)
  itemName                 String                    @map("item_name") @db.VarChar(255)
  itemDescription          String?                   @map("item_description") @db.Text
  itemCategory             String?                   @map("item_category") @db.VarChar(100)
  itemType                 String?                   @map("item_type") @db.VarChar(50)
  unitOfMeasure            String?                   @map("unit_of_measure") @db.VarChar(20)
  reorderLevel             Decimal?                  @map("reorder_level") @db.Decimal(18, 4)
  reorderQuantity          Decimal?                  @map("reorder_quantity") @db.Decimal(18, 4)
  safetyStock              Decimal?                  @map("safety_stock") @db.Decimal(18, 4)
  leadTimeDays             Int?                      @map("lead_time_days")
  hsnCode                  String?                   @map("hsn_code") @db.VarChar(50)
  isSerialized             Boolean                   @default(false) @map("is_serialized")
  isBatchTracked           Boolean                   @default(false) @map("is_batch_tracked")
  itemStatus               String                    @default("active") @map("item_status") @db.VarChar(50)
  glInventoryAccountId     String?                   @map("gl_inventory_account_id") @db.VarChar(36)
  glExpenseAccountId       String?                   @map("gl_expense_account_id") @db.VarChar(36)
  createdBy                String?                   @map("created_by") @db.VarChar(36)
  createdAt                DateTime                  @default(now()) @map("created_at")
  updatedAt                DateTime                  @updatedAt @map("updated_at")
  itemVendors              InventoryItemVendor[]
  stockLevels              StockLevel[]
  stockMovements           StockMovement[]
  inventoryBatches         InventoryBatch[]
  inventorySerials         InventorySerial[]
  stockAdjustmentLines     StockAdjustmentLine[]
  physicalInventoryDetails PhysicalInventoryDetail[]

  @@unique([tenantId, sku])
  @@index([tenantId])
  @@index([sku])
  @@index([itemCategory])
  @@index([itemStatus])
  @@map("inventory_item")
}

model InventoryItemVendor {
  id                   String        @id @db.Char(36)
  tenantId             String        @map("tenant_id") @db.VarChar(36)
  inventoryItemId      String        @map("inventory_item_id") @db.VarChar(36)
  vendorId             String        @map("vendor_id") @db.VarChar(36)
  vendorSku            String?       @map("vendor_sku") @db.VarChar(50)
  vendorPartNumber     String?       @map("vendor_part_number") @db.VarChar(100)
  leadTimeDays         Int?          @map("lead_time_days")
  minimumOrderQuantity Decimal?      @map("minimum_order_quantity") @db.Decimal(18, 4)
  unitPrice            Decimal?      @map("unit_price") @db.Decimal(18, 4)
  lastPriceDate        DateTime?     @map("last_price_date") @db.Date
  preferredVendor      Boolean       @default(false) @map("preferred_vendor")
  qualityRating        Decimal?      @map("quality_rating") @db.Decimal(3, 1)
  isActive             Boolean       @default(true) @map("is_active")
  createdAt            DateTime      @default(now()) @map("created_at")
  inventoryItem        InventoryItem @relation(fields: [inventoryItemId], references: [id], onDelete: Cascade)
  vendor               Vendor        @relation(fields: [vendorId], references: [id], onDelete: Cascade)

  @@unique([inventoryItemId, vendorId])
  @@index([tenantId])
  @@index([inventoryItemId])
  @@index([vendorId])
  @@map("inventory_item_vendor")
}

model StockLevel {
  id                    String                 @id @db.Char(36)
  tenantId              String                 @map("tenant_id") @db.VarChar(36)
  inventoryItemId       String                 @map("inventory_item_id") @db.VarChar(36)
  warehouseId           String                 @map("warehouse_id") @db.VarChar(36)
  quantityOnHand        Decimal                @default(0) @map("quantity_on_hand") @db.Decimal(18, 4)
  quantityReserved      Decimal                @default(0) @map("quantity_reserved") @db.Decimal(18, 4)
  quantityAvailable     Decimal                @default(0) @map("quantity_available") @db.Decimal(18, 4)
  quantityInTransit     Decimal                @default(0) @map("quantity_in_transit") @db.Decimal(18, 4)
  lastCountedDate       DateTime?              @map("last_counted_date") @db.Date
  recountRequired       Boolean                @default(false) @map("recount_required")
  createdAt             DateTime               @default(now()) @map("created_at")
  updatedAt             DateTime               @updatedAt @map("updated_at")
  inventoryItem         InventoryItem          @relation(fields: [inventoryItemId], references: [id], onDelete: Cascade)
  warehouse             Warehouse              @relation(fields: [warehouseId], references: [id], onDelete: Cascade)
  importHSCodeLineItems ImportHSCodeLineItem[]

  @@unique([inventoryItemId, warehouseId])
  @@index([tenantId])
  @@index([inventoryItemId])
  @@index([warehouseId])
  @@index([recountRequired])
  @@map("stock_level")
}

model StockMovement {
  id              String        @id @db.Char(36)
  tenantId        String        @map("tenant_id") @db.VarChar(36)
  inventoryItemId String        @map("inventory_item_id") @db.VarChar(36)
  warehouseId     String        @map("warehouse_id") @db.VarChar(36)
  movementType    String?       @map("movement_type") @db.VarChar(50)
  movementDate    DateTime      @map("movement_date") @db.Date
  quantityChange  Decimal?      @map("quantity_change") @db.Decimal(18, 4)
  referenceType   String?       @map("reference_type") @db.VarChar(50)
  referenceId     String?       @map("reference_id") @db.VarChar(36)
  fromLocation    String?       @map("from_location") @db.VarChar(100)
  toLocation      String?       @map("to_location") @db.VarChar(100)
  batchNumber     String?       @map("batch_number") @db.VarChar(100)
  serialNumbers   String?       @map("serial_numbers") @db.Text
  unitPrice       Decimal?      @map("unit_price") @db.Decimal(18, 4)
  totalValue      Decimal?      @map("total_value") @db.Decimal(18, 2)
  reasonCode      String?       @map("reason_code") @db.VarChar(50)
  notes           String?       @db.Text
  createdBy       String?       @map("created_by") @db.VarChar(36)
  createdAt       DateTime      @default(now()) @map("created_at")
  inventoryItem   InventoryItem @relation(fields: [inventoryItemId], references: [id], onDelete: Cascade)
  warehouse       Warehouse     @relation(fields: [warehouseId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([inventoryItemId])
  @@index([warehouseId])
  @@index([movementDate])
  @@index([movementType])
  @@index([referenceId])
  @@map("stock_movement")
}

model InventoryBatch {
  id                  String         @id @db.Char(36)
  tenantId            String         @map("tenant_id") @db.VarChar(36)
  inventoryItemId     String         @map("inventory_item_id") @db.VarChar(36)
  batchNumber         String         @map("batch_number") @db.VarChar(100)
  manufactureDate     DateTime?      @map("manufacture_date") @db.Date
  expiryDate          DateTime?      @map("expiry_date") @db.Date
  quantityReceived    Decimal?       @map("quantity_received") @db.Decimal(18, 4)
  quantityRemaining   Decimal?       @map("quantity_remaining") @db.Decimal(18, 4)
  purchaseOrderId     String?        @map("purchase_order_id") @db.VarChar(36)
  supplierBatchNumber String?        @map("supplier_batch_number") @db.VarChar(100)
  qualityStatus       String?        @map("quality_status") @db.VarChar(50)
  storageLocation     String?        @map("storage_location") @db.VarChar(100)
  createdAt           DateTime       @default(now()) @map("created_at")
  updatedAt           DateTime       @updatedAt @map("updated_at")
  inventoryItem       InventoryItem  @relation(fields: [inventoryItemId], references: [id], onDelete: Cascade)
  po                  PurchaseOrder? @relation(fields: [purchaseOrderId], references: [id])

  @@unique([tenantId, batchNumber])
  @@index([tenantId])
  @@index([inventoryItemId])
  @@index([batchNumber])
  @@index([expiryDate])
  @@index([qualityStatus])
  @@map("inventory_batch")
}

model InventorySerial {
  id                String        @id @db.Char(36)
  tenantId          String        @map("tenant_id") @db.VarChar(36)
  inventoryItemId   String        @map("inventory_item_id") @db.VarChar(36)
  serialNumber      String        @unique @map("serial_number") @db.VarChar(100)
  batchId           String?       @map("batch_id") @db.VarChar(36)
  purchaseOrderId   String?       @map("purchase_order_id") @db.VarChar(36)
  warrantyStartDate DateTime?     @map("warranty_start_date") @db.Date
  warrantyEndDate   DateTime?     @map("warranty_end_date") @db.Date
  currentLocation   String?       @map("current_location") @db.VarChar(100)
  status            String        @default("in_stock") @db.VarChar(50)
  createdAt         DateTime      @default(now()) @map("created_at")
  updatedAt         DateTime      @updatedAt @map("updated_at")
  inventoryItem     InventoryItem @relation(fields: [inventoryItemId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([inventoryItemId])
  @@index([serialNumber])
  @@map("inventory_serial")
}

model InventoryValuation {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  inventoryItemId String   @map("inventory_item_id") @db.VarChar(36)
  warehouseId     String   @map("warehouse_id") @db.VarChar(36)
  valuationDate   DateTime @map("valuation_date") @db.Date
  valuationMethod String   @map("valuation_method") @db.VarChar(50)
  quantityOnHand  Decimal  @map("quantity_on_hand") @db.Decimal(18, 4)
  unitPrice       Decimal  @map("unit_price") @db.Decimal(18, 4)
  totalValue      Decimal  @map("total_value") @db.Decimal(18, 2)
  notes           String?  @db.Text
  createdBy       String?  @map("created_by") @db.VarChar(36)
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([inventoryItemId])
  @@map("inventory_valuation")
}

model StockAdjustment {
  id               String                @id @db.Char(36)
  tenantId         String                @map("tenant_id") @db.VarChar(36)
  adjustmentNumber String                @unique @map("adjustment_number") @db.VarChar(50)
  adjustmentDate   DateTime              @map("adjustment_date") @db.Date
  reason           String?               @db.VarChar(100)
  status           String                @default("draft") @db.VarChar(50)
  approvedBy       String?               @map("approved_by") @db.VarChar(36)
  approvalDate     DateTime?             @map("approval_date")
  notes            String?               @db.Text
  createdBy        String?               @map("created_by") @db.VarChar(36)
  createdAt        DateTime              @default(now()) @map("created_at")
  updatedAt        DateTime              @updatedAt @map("updated_at")
  lineItems        StockAdjustmentLine[]

  @@index([tenantId])
  @@index([adjustmentNumber])
  @@index([status])
  @@map("stock_adjustment")
}

model StockAdjustmentLine {
  id               String          @id @db.Char(36)
  tenantId         String          @map("tenant_id") @db.VarChar(36)
  adjustmentId     String          @map("adjustment_id") @db.VarChar(36)
  inventoryItemId  String          @map("inventory_item_id") @db.VarChar(36)
  warehouseId      String          @map("warehouse_id") @db.VarChar(36)
  quantityVariance Decimal         @map("quantity_variance") @db.Decimal(18, 4)
  reason           String?         @db.VarChar(100)
  createdAt        DateTime        @default(now()) @map("created_at")
  adjustment       StockAdjustment @relation(fields: [adjustmentId], references: [id], onDelete: Cascade)
  inventoryItem    InventoryItem   @relation(fields: [inventoryItemId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([adjustmentId])
  @@map("stock_adjustment_line")
}

model PhysicalInventory {
  id                   String                    @id @db.Char(36)
  tenantId             String                    @map("tenant_id") @db.VarChar(36)
  inventoryNumber      String                    @unique @map("inventory_number") @db.VarChar(50)
  warehouseId          String?                   @map("warehouse_id") @db.VarChar(36)
  countDate            DateTime                  @map("count_date") @db.Date
  status               String                    @default("draft") @db.VarChar(50)
  countersNames        String?                   @map("counters_names") @db.Text
  completionPercentage Decimal                   @default(0) @map("completion_percentage") @db.Decimal(5, 2)
  notes                String?                   @db.Text
  startedBy            String?                   @map("started_by") @db.VarChar(36)
  completedBy          String?                   @map("completed_by") @db.VarChar(36)
  completedAt          DateTime?                 @map("completed_at")
  createdAt            DateTime                  @default(now()) @map("created_at")
  updatedAt            DateTime                  @updatedAt @map("updated_at")
  details              PhysicalInventoryDetail[]

  @@index([tenantId])
  @@index([inventoryNumber])
  @@index([status])
  @@map("physical_inventory")
}

model PhysicalInventoryDetail {
  id                  String            @id @db.Char(36)
  tenantId            String            @map("tenant_id") @db.VarChar(36)
  physicalInventoryId String            @map("physical_inventory_id") @db.VarChar(36)
  inventoryItemId     String            @map("inventory_item_id") @db.VarChar(36)
  quantityExpected    Decimal?          @map("quantity_expected") @db.Decimal(18, 4)
  quantityCounted     Decimal?          @map("quantity_counted") @db.Decimal(18, 4)
  variance            Decimal?          @db.Decimal(18, 4)
  variancePercent     Decimal?          @map("variance_percent") @db.Decimal(5, 2)
  notes               String?           @db.Text
  createdAt           DateTime          @default(now()) @map("created_at")
  physicalInventory   PhysicalInventory @relation(fields: [physicalInventoryId], references: [id], onDelete: Cascade)
  inventoryItem       InventoryItem     @relation(fields: [inventoryItemId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([physicalInventoryId])
  @@map("physical_inventory_detail")
}

model InventoryTransfer {
  id                   String                  @id @db.Char(36)
  tenantId             String                  @map("tenant_id") @db.VarChar(36)
  transferNumber       String                  @unique @map("transfer_number") @db.VarChar(50)
  fromWarehouseId      String?                 @map("from_warehouse_id") @db.VarChar(36)
  toWarehouseId        String?                 @map("to_warehouse_id") @db.VarChar(36)
  transferDate         DateTime                @map("transfer_date") @db.Date
  expectedDeliveryDate DateTime?               @map("expected_delivery_date") @db.Date
  actualDeliveryDate   DateTime?               @map("actual_delivery_date") @db.Date
  status               String                  @default("draft") @db.VarChar(50)
  notes                String?                 @db.Text
  createdBy            String?                 @map("created_by") @db.VarChar(36)
  createdAt            DateTime                @default(now()) @map("created_at")
  updatedAt            DateTime                @updatedAt @map("updated_at")
  lineItems            InventoryTransferLine[]

  @@index([tenantId])
  @@index([transferNumber])
  @@index([status])
  @@map("inventory_transfer")
}

model InventoryTransferLine {
  id                 String            @id @db.Char(36)
  tenantId           String            @map("tenant_id") @db.VarChar(36)
  transferId         String            @map("transfer_id") @db.VarChar(36)
  inventoryItemId    String            @map("inventory_item_id") @db.VarChar(36)
  quantityTransfered Decimal           @map("quantity_transfered") @db.Decimal(18, 4)
  quantityReceived   Decimal           @default(0) @map("quantity_received") @db.Decimal(18, 4)
  quantityShortage   Decimal           @default(0) @map("quantity_shortage") @db.Decimal(18, 4)
  createdAt          DateTime          @default(now()) @map("created_at")
  transfer           InventoryTransfer @relation(fields: [transferId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([transferId])
  @@map("inventory_transfer_line")
}

model MinStockAlert {
  id              String    @id @db.Char(36)
  tenantId        String    @map("tenant_id") @db.VarChar(36)
  inventoryItemId String    @map("inventory_item_id") @db.VarChar(36)
  warehouseId     String    @map("warehouse_id") @db.VarChar(36)
  minStockLevel   Decimal   @map("min_stock_level") @db.Decimal(18, 4)
  maxStockLevel   Decimal   @map("max_stock_level") @db.Decimal(18, 4)
  currentQuantity Decimal?  @map("current_quantity") @db.Decimal(18, 4)
  alertStatus     String    @map("alert_status") @db.VarChar(50)
  lastAlertDate   DateTime? @map("last_alert_date")
  createdAt       DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([alertStatus])
  @@map("min_stock_alert")
}

model InventoryDamage {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  inventoryItemId String   @map("inventory_item_id") @db.VarChar(36)
  warehouseId     String?  @map("warehouse_id") @db.VarChar(36)
  damageDate      DateTime @map("damage_date") @db.Date
  quantityDamaged Decimal  @map("quantity_damaged") @db.Decimal(18, 4)
  damageReason    String?  @map("damage_reason") @db.VarChar(255)
  estimatedValue  Decimal? @map("estimated_value") @db.Decimal(18, 2)
  notes           String?  @db.Text
  reportedBy      String?  @map("reported_by") @db.VarChar(36)
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([damageDate])
  @@map("inventory_damage")
}

model Role {
  id              String           @id @db.Char(36)
  tenantId        String           @map("tenant_id") @db.VarChar(36)
  roleName        String           @map("role_name") @db.VarChar(100)
  description     String?          @db.Text
  isSystemRole    Boolean          @default(false) @map("is_system_role")
  isActive        Boolean          @default(true) @map("is_active")
  createdAt       DateTime         @default(now()) @map("created_at")
  updatedAt       DateTime         @updatedAt @map("updated_at")
  permissions     RolePermission[]
  userRoles       UserRole[]
  roleDelegations RoleDelegation[]

  @@unique([tenantId, roleName])
  @@index([tenantId])
  @@map("role")
}

model Permission {
  id                 String                 @id @db.Char(36)
  tenantId           String                 @map("tenant_id") @db.VarChar(36)
  permissionName     String                 @map("permission_name") @db.VarChar(100)
  description        String?                @db.Text
  resource           String?                @db.VarChar(100)
  action             String?                @db.VarChar(50)
  isSystemPermission Boolean                @default(false) @map("is_system_permission")
  createdAt          DateTime               @default(now()) @map("created_at")
  updatedAt          DateTime               @updatedAt @map("updated_at")
  roles              RolePermission[]
  fieldPermissions   FieldLevelPermission[]

  @@unique([tenantId, permissionName])
  @@index([tenantId])
  @@index([resource])
  @@map("permission")
}

model RolePermission {
  id           String     @id @db.Char(36)
  tenantId     String     @map("tenant_id") @db.VarChar(36)
  roleId       String     @map("role_id") @db.VarChar(36)
  permissionId String     @map("permission_id") @db.VarChar(36)
  createdAt    DateTime   @default(now()) @map("created_at")
  role         Role       @relation(fields: [roleId], references: [id], onDelete: Cascade)
  permission   Permission @relation(fields: [permissionId], references: [id], onDelete: Cascade)

  @@unique([roleId, permissionId])
  @@index([tenantId])
  @@index([roleId])
  @@index([permissionId])
  @@map("role_permission")
}

model UserRole {
  id         String    @id @db.Char(36)
  tenantId   String    @map("tenant_id") @db.VarChar(36)
  userId     String    @map("user_id") @db.Char(36)
  roleId     String    @map("role_id") @db.VarChar(36)
  assignedAt DateTime  @default(now()) @map("assigned_at")
  assignedBy String?   @map("assigned_by") @db.VarChar(36)
  expiresAt  DateTime? @map("expires_at")
  createdAt  DateTime  @default(now()) @map("created_at")
  user       User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  role       Role      @relation(fields: [roleId], references: [id], onDelete: Cascade)

  @@unique([userId, roleId])
  @@index([tenantId])
  @@index([userId])
  @@index([roleId])
  @@map("user_role")
}

model Resource {
  id               String           @id @db.Char(36)
  tenantId         String           @map("tenant_id") @db.VarChar(36)
  resourceName     String           @map("resource_name") @db.VarChar(100)
  resourceType     String?          @map("resource_type") @db.VarChar(50)
  endpoint         String?          @db.VarChar(255)
  description      String?          @db.Text
  isProtected      Boolean          @default(true) @map("is_protected")
  createdAt        DateTime         @default(now()) @map("created_at")
  accessLogs       AccessLog[]
  resourceAccesses ResourceAccess[]

  @@index([tenantId])
  @@index([resourceType])
  @@map("resource")
}

model AccessLog {
  id         String    @id @db.Char(36)
  tenantId   String    @map("tenant_id") @db.VarChar(36)
  userId     String?   @map("user_id") @db.Char(36)
  resourceId String?   @map("resource_id") @db.VarChar(36)
  action     String?   @db.VarChar(50)
  status     String?   @db.VarChar(50)
  ipAddress  String?   @map("ip_address") @db.VarChar(45)
  userAgent  String?   @map("user_agent") @db.Text
  timestamp  DateTime  @default(now())
  user       User?     @relation(fields: [userId], references: [id], onDelete: SetNull)
  resource   Resource? @relation(fields: [resourceId], references: [id], onDelete: SetNull)

  @@index([tenantId])
  @@index([userId])
  @@index([timestamp])
  @@map("access_log")
}

model ResourceAccess {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  roleId      String   @map("role_id") @db.VarChar(36)
  resourceId  String   @map("resource_id") @db.VarChar(36)
  accessLevel String?  @map("access_level") @db.VarChar(50)
  createdAt   DateTime @default(now()) @map("created_at")
  resource    Resource @relation(fields: [resourceId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([roleId])
  @@index([resourceId])
  @@map("resource_access")
}

model TimeBasedPermission {
  id         String   @id @db.Char(36)
  tenantId   String   @map("tenant_id") @db.VarChar(36)
  roleId     String   @map("role_id") @db.VarChar(36)
  validFrom  DateTime @map("valid_from")
  validTo    DateTime @map("valid_to")
  daysOfWeek String?  @map("days_of_week") @db.VarChar(50)
  timeFrom   String?  @map("time_from") @db.VarChar(10)
  timeTo     String?  @map("time_to") @db.VarChar(10)
  createdAt  DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([roleId])
  @@map("time_based_permission")
}

model FieldLevelPermission {
  id           String     @id @db.Char(36)
  tenantId     String     @map("tenant_id") @db.VarChar(36)
  permissionId String     @map("permission_id") @db.VarChar(36)
  entityName   String     @map("entity_name") @db.VarChar(100)
  fieldName    String     @map("field_name") @db.VarChar(100)
  accessType   String     @map("access_type") @db.VarChar(50)
  createdAt    DateTime   @default(now()) @map("created_at")
  permission   Permission @relation(fields: [permissionId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([permissionId])
  @@map("field_level_permission")
}

model RoleDelegation {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  roleId      String   @map("role_id") @db.VarChar(36)
  delegatedTo String   @map("delegated_to") @db.Char(36)
  delegatedBy String   @map("delegated_by") @db.Char(36)
  validFrom   DateTime @map("valid_from")
  validTo     DateTime @map("valid_to")
  reason      String?  @db.Text
  createdAt   DateTime @default(now()) @map("created_at")
  role        Role     @relation(fields: [roleId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([roleId])
  @@map("role_delegation")
}

model BulkPermissionLog {
  id            String    @id @db.Char(36)
  tenantId      String    @map("tenant_id") @db.VarChar(36)
  batchNumber   String    @unique @map("batch_number") @db.VarChar(100)
  operation     String    @db.VarChar(50)
  roleIds       String?   @map("role_ids") @db.Text
  permissionIds String?   @map("permission_ids") @db.Text
  status        String    @default("pending") @db.VarChar(50)
  totalAffected Int       @map("total_affected")
  successCount  Int       @default(0) @map("success_count")
  failureCount  Int       @default(0) @map("failure_count")
  createdBy     String?   @map("created_by") @db.VarChar(36)
  completedAt   DateTime? @map("completed_at")
  createdAt     DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([status])
  @@map("bulk_permission_log")
}

model ChartOfAccount {
  id                         String               @id @db.Char(36)
  tenantId                   String               @map("tenant_id") @db.VarChar(36)
  accountCode                String               @unique @map("account_code") @db.VarChar(50)
  accountName                String               @map("account_name") @db.VarChar(255)
  accountType                String               @map("account_type") @db.VarChar(50)
  accountSubtype             String?              @map("account_subtype") @db.VarChar(50)
  description                String?              @db.Text
  balance                    Decimal              @default(0) @db.Decimal(18, 2)
  parentAccountId            String?              @map("parent_account_id") @db.VarChar(36)
  isHeader                   Boolean              @default(false) @map("is_header")
  isActive                   Boolean              @default(true) @map("is_active")
  createdAt                  DateTime             @default(now()) @map("created_at")
  updatedAt                  DateTime             @updatedAt @map("updated_at")
  glPostingTemplatesAsSource GlPostingTemplate[]  @relation("sourceAccount")
  glPostingTemplatesAsTarget GlPostingTemplate[]  @relation("targetAccount")
  glPostingTemplatesAsDebit  GlPostingTemplate[]  @relation("debitAccount")
  glPostingTemplatesAsCredit GlPostingTemplate[]  @relation("creditAccount")
  journalEntryDetails        JournalEntryDetail[]

  @@unique([tenantId, accountCode])
  @@index([tenantId])
  @@index([accountCode])
  @@index([accountType])
  @@map("chart_of_account")
}

model FinancialPeriod {
  id         String    @id @db.Char(36)
  tenantId   String    @map("tenant_id") @db.VarChar(36)
  periodName String    @map("period_name") @db.VarChar(100)
  periodType String    @map("period_type") @db.VarChar(50)
  startDate  DateTime  @map("start_date") @db.Date
  endDate    DateTime  @map("end_date") @db.Date
  isClosed   Boolean   @default(false) @map("is_closed")
  closedBy   String?   @map("closed_by") @db.VarChar(36)
  closedAt   DateTime? @map("closed_at")
  createdAt  DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([startDate, endDate])
  @@map("financial_period")
}

model JournalEntry {
  id              String               @id @db.Char(36)
  tenantId        String               @map("tenant_id") @db.VarChar(36)
  journalNumber   String               @unique @map("journal_number") @db.VarChar(50)
  entryDate       DateTime             @map("entry_date") @db.Date
  description     String?              @db.Text
  referenceNumber String?              @map("reference_number") @db.VarChar(100)
  referenceType   String?              @map("reference_type") @db.VarChar(50)
  totalDebit      Decimal              @default(0) @map("total_debit") @db.Decimal(18, 2)
  totalCredit     Decimal              @default(0) @map("total_credit") @db.Decimal(18, 2)
  status          String               @default("draft") @db.VarChar(50)
  approvedBy      String?              @map("approved_by") @db.VarChar(36)
  approvedAt      DateTime?            @map("approved_at")
  postedBy        String?              @map("posted_by") @db.VarChar(36)
  postedAt        DateTime?            @map("posted_at")
  createdBy       String?              @map("created_by") @db.VarChar(36)
  createdAt       DateTime             @default(now()) @map("created_at")
  updatedAt       DateTime             @updatedAt @map("updated_at")
  details         JournalEntryDetail[]

  @@index([tenantId])
  @@index([journalNumber])
  @@index([entryDate])
  @@index([status])
  @@map("journal_entry")
}

model JournalEntryDetail {
  id             String         @id @db.Char(36)
  tenantId       String         @map("tenant_id") @db.VarChar(36)
  journalEntryId String         @map("journal_entry_id") @db.VarChar(36)
  accountId      String         @map("account_id") @db.VarChar(36)
  debitAmount    Decimal        @default(0) @map("debit_amount") @db.Decimal(18, 2)
  creditAmount   Decimal        @default(0) @map("credit_amount") @db.Decimal(18, 2)
  description    String?        @db.Text
  createdAt      DateTime       @default(now()) @map("created_at")
  journalEntry   JournalEntry   @relation(fields: [journalEntryId], references: [id], onDelete: Cascade)
  account        ChartOfAccount @relation(fields: [accountId], references: [id])

  @@index([tenantId])
  @@index([journalEntryId])
  @@index([accountId])
  @@map("journal_entry_detail")
}

model GlAccountBalance {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  accountId      String   @map("account_id") @db.VarChar(36)
  fiscalYear     Int      @map("fiscal_year")
  periodNumber   Int      @map("period_number")
  openingBalance Decimal  @default(0) @map("opening_balance") @db.Decimal(18, 2)
  debitTotal     Decimal  @default(0) @map("debit_total") @db.Decimal(18, 2)
  creditTotal    Decimal  @default(0) @map("credit_total") @db.Decimal(18, 2)
  closingBalance Decimal  @default(0) @map("closing_balance") @db.Decimal(18, 2)
  createdAt      DateTime @default(now()) @map("created_at")
  updatedAt      DateTime @updatedAt @map("updated_at")

  @@unique([tenantId, accountId, fiscalYear, periodNumber])
  @@index([tenantId])
  @@index([accountId])
  @@map("gl_account_balance")
}

model TrialBalance {
  id               String   @id @db.Char(36)
  tenantId         String   @map("tenant_id") @db.VarChar(36)
  trialBalanceDate DateTime @map("trial_balance_date") @db.Date
  totalDebits      Decimal  @map("total_debits") @db.Decimal(18, 2)
  totalCredits     Decimal  @map("total_credits") @db.Decimal(18, 2)
  status           String   @db.VarChar(50)
  createdBy        String?  @map("created_by") @db.VarChar(36)
  createdAt        DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([trialBalanceDate])
  @@map("trial_balance")
}

model IncomeStatement {
  id                String   @id @db.Char(36)
  tenantId          String   @map("tenant_id") @db.VarChar(36)
  statementDate     DateTime @map("statement_date") @db.Date
  revenue           Decimal  @db.Decimal(18, 2)
  costOfSales       Decimal  @map("cost_of_sales") @db.Decimal(18, 2)
  grossProfit       Decimal  @map("gross_profit") @db.Decimal(18, 2)
  operatingExpenses Decimal  @map("operating_expenses") @db.Decimal(18, 2)
  operatingProfit   Decimal  @map("operating_profit") @db.Decimal(18, 2)
  netIncome         Decimal  @map("net_income") @db.Decimal(18, 2)
  createdBy         String?  @map("created_by") @db.VarChar(36)
  createdAt         DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("income_statement")
}

model BalanceSheet {
  id               String   @id @db.Char(36)
  tenantId         String   @map("tenant_id") @db.VarChar(36)
  sheetDate        DateTime @map("sheet_date") @db.Date
  totalAssets      Decimal  @map("total_assets") @db.Decimal(18, 2)
  totalLiabilities Decimal  @map("total_liabilities") @db.Decimal(18, 2)
  totalEquity      Decimal  @map("total_equity") @db.Decimal(18, 2)
  createdBy        String?  @map("created_by") @db.VarChar(36)
  createdAt        DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("balance_sheet")
}

model GlPostingTemplate {
  id              String         @id @db.Char(36)
  tenantId        String         @map("tenant_id") @db.VarChar(36)
  templateName    String         @map("template_name") @db.VarChar(255)
  description     String?        @db.Text
  transactionType String         @map("transaction_type") @db.VarChar(50)
  sourceAccountId String         @map("source_account_id") @db.VarChar(36)
  targetAccountId String         @map("target_account_id") @db.VarChar(36)
  debitAccountId  String         @map("debit_account_id") @db.VarChar(36)
  creditAccountId String         @map("credit_account_id") @db.VarChar(36)
  isActive        Boolean        @default(true) @map("is_active")
  createdAt       DateTime       @default(now()) @map("created_at")
  updatedAt       DateTime       @updatedAt @map("updated_at")
  sourceAccount   ChartOfAccount @relation("sourceAccount", fields: [sourceAccountId], references: [id])
  targetAccount   ChartOfAccount @relation("targetAccount", fields: [targetAccountId], references: [id])
  debitAccount    ChartOfAccount @relation("debitAccount", fields: [debitAccountId], references: [id])
  creditAccount   ChartOfAccount @relation("creditAccount", fields: [creditAccountId], references: [id])

  @@index([tenantId])
  @@index([transactionType])
  @@map("gl_posting_template")
}

model PayrollGlPosting {
  id                     String   @id @db.Char(36)
  tenantId               String   @map("tenant_id") @db.VarChar(36)
  payrollId              String   @map("payroll_id") @db.VarChar(36)
  journalEntryId         String   @map("journal_entry_id") @db.VarChar(36)
  salaryExpenseAccountId String   @map("salary_expense_account_id") @db.VarChar(36)
  salaryPayableAccountId String   @map("salary_payable_account_id") @db.VarChar(36)
  totalSalary            Decimal  @map("total_salary") @db.Decimal(15, 2)
  totalDeductions        Decimal  @map("total_deductions") @db.Decimal(15, 2)
  postingDate            DateTime @map("posting_date") @db.Date
  status                 String   @default("pending") @db.VarChar(50)
  createdAt              DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([payrollId])
  @@map("payroll_gl_posting")
}

model PurchaseGlPosting {
  id                 String   @id @db.Char(36)
  tenantId           String   @map("tenant_id") @db.VarChar(36)
  poId               String   @map("po_id") @db.VarChar(36)
  journalEntryId     String   @map("journal_entry_id") @db.VarChar(36)
  inventoryAccountId String   @map("inventory_account_id") @db.VarChar(36)
  expenseAccountId   String   @map("expense_account_id") @db.VarChar(36)
  payableAccountId   String   @map("payable_account_id") @db.VarChar(36)
  netAmount          Decimal  @map("net_amount") @db.Decimal(18, 2)
  postingDate        DateTime @map("posting_date") @db.Date
  status             String   @default("pending") @db.VarChar(50)
  createdAt          DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([poId])
  @@map("purchase_gl_posting")
}

model SalesGlPosting {
  id                  String   @id @db.Char(36)
  tenantId            String   @map("tenant_id") @db.VarChar(36)
  invoiceId           String   @map("invoice_id") @db.VarChar(36)
  journalEntryId      String   @map("journal_entry_id") @db.VarChar(36)
  revenueAccountId    String   @map("revenue_account_id") @db.VarChar(36)
  receivableAccountId String   @map("receivable_account_id") @db.VarChar(36)
  netAmount           Decimal  @map("net_amount") @db.Decimal(18, 2)
  postingDate         DateTime @map("posting_date") @db.Date
  status              String   @default("pending") @db.VarChar(50)
  createdAt           DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([invoiceId])
  @@map("sales_gl_posting")
}

model BankStatement {
  id               String    @id @db.Char(36)
  tenantId         String    @map("tenant_id") @db.VarChar(36)
  bankAccountId    String    @map("bank_account_id") @db.VarChar(36)
  statementDate    DateTime  @map("statement_date") @db.Date
  openingBalance   Decimal   @map("opening_balance") @db.Decimal(18, 2)
  closingBalance   Decimal   @map("closing_balance") @db.Decimal(18, 2)
  totalDeposits    Decimal   @default(0) @map("total_deposits") @db.Decimal(18, 2)
  totalWithdrawals Decimal   @default(0) @map("total_withdrawals") @db.Decimal(18, 2)
  statementFile    String?   @map("statement_file") @db.VarChar(255)
  uploadedBy       String?   @map("uploaded_by") @db.VarChar(36)
  uploadedAt       DateTime? @map("uploaded_at")
  createdAt        DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([bankAccountId])
  @@map("bank_statement")
}

model BankTransaction {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  bankStatementId String   @map("bank_statement_id") @db.VarChar(36)
  transactionDate DateTime @map("transaction_date") @db.Date
  description     String   @db.VarChar(255)
  amount          Decimal  @db.Decimal(18, 2)
  transactionType String   @map("transaction_type") @db.VarChar(50)
  referenceNumber String?  @map("reference_number") @db.VarChar(100)
  balance         Decimal  @db.Decimal(18, 2)
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([bankStatementId])
  @@map("bank_transaction")
}

model BankReconciliationMatch {
  id                String   @id @db.Char(36)
  tenantId          String   @map("tenant_id") @db.VarChar(36)
  bankTransactionId String   @map("bank_transaction_id") @db.VarChar(36)
  journalEntryId    String?  @map("journal_entry_id") @db.VarChar(36)
  matchDate         DateTime @map("match_date") @db.Date
  amount            Decimal  @db.Decimal(18, 2)
  status            String   @default("matched") @db.VarChar(50)
  createdAt         DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("bank_reconciliation_match")
}

model UnclearedItem {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  bankAccountId   String   @map("bank_account_id") @db.VarChar(36)
  journalEntryId  String?  @map("journal_entry_id") @db.VarChar(36)
  itemDate        DateTime @map("item_date") @db.Date
  description     String?  @db.VarChar(255)
  amount          Decimal  @db.Decimal(18, 2)
  itemType        String   @map("item_type") @db.VarChar(50)
  daysOutstanding Int?     @map("days_outstanding")
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("uncleared_item")
}

model CashFlowForecast {
  id                String   @id @db.Char(36)
  tenantId          String   @map("tenant_id") @db.VarChar(36)
  forecastDate      DateTime @map("forecast_date") @db.Date
  forecastPeriod    String   @map("forecast_period") @db.VarChar(50)
  projectedInflows  Decimal  @map("projected_inflows") @db.Decimal(18, 2)
  projectedOutflows Decimal  @map("projected_outflows") @db.Decimal(18, 2)
  projectedBalance  Decimal  @map("projected_balance") @db.Decimal(18, 2)
  createdBy         String?  @map("created_by") @db.VarChar(36)
  createdAt         DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("cash_flow_forecast")
}

model CashFlowItem {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  forecastId  String   @map("forecast_id") @db.VarChar(36)
  itemType    String   @map("item_type") @db.VarChar(50)
  description String?  @db.VarChar(255)
  amount      Decimal  @db.Decimal(18, 2)
  dueDate     DateTime @map("due_date") @db.Date
  createdAt   DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([forecastId])
  @@map("cash_flow_item")
}

model Employee {
  id                  String                        @id @db.Char(36)
  tenantId            String                        @map("tenant_id") @db.VarChar(36)
  employeeCode        String                        @unique @map("employee_code") @db.VarChar(50)
  firstName           String                        @map("first_name") @db.VarChar(100)
  lastName            String                        @map("last_name") @db.VarChar(100)
  email               String?                       @db.VarChar(255)
  phone               String?                       @db.VarChar(20)
  departmentId        String?                       @map("department_id") @db.VarChar(36)
  designationId       String?                       @map("designation_id") @db.VarChar(36)
  joiningDate         DateTime                      @map("joining_date") @db.Date
  status              String                        @default("active") @db.VarChar(50)
  createdAt           DateTime                      @default(now()) @map("created_at")
  updatedAt           DateTime                      @updatedAt @map("updated_at")
  employeeDetails     EmployeeDetails?
  leaveBalances       LeaveBalance[]
  epfRegistrations    EmployeeEPFRegistration[]
  esiRegistrations    EmployeeESIRegistration[]
  epfContributions    EPFContribution[]
  esiContributions    ESIContribution[]
  complianceChecklist EmployeeComplianceChecklist[]

  @@index([tenantId])
  @@index([employeeCode])
  @@index([status])
  @@map("employee")
}

model EmployeeDetails {
  id                String   @id @db.Char(36)
  tenantId          String   @map("tenant_id") @db.VarChar(36)
  employeeId        String   @unique @map("employee_id") @db.Char(36)
  fatherName        String?  @map("father_name") @db.VarChar(255)
  motherName        String?  @map("mother_name") @db.VarChar(255)
  spouse            String?  @db.VarChar(255)
  children          Int      @default(0)
  dateOfBirth       DateTime @map("date_of_birth") @db.Date
  bloodGroup        String?  @map("blood_group") @db.VarChar(5)
  aadhar            String?  @db.VarChar(50)
  pan               String?  @db.VarChar(50)
  pfNumber          String?  @map("pf_number") @db.VarChar(50)
  esiNumber         String?  @map("esi_number") @db.VarChar(50)
  bankAccountNumber String?  @map("bank_account_number") @db.VarChar(50)
  bankName          String?  @map("bank_name") @db.VarChar(100)
  ifscCode          String?  @map("ifsc_code") @db.VarChar(20)
  createdAt         DateTime @default(now()) @map("created_at")
  updatedAt         DateTime @updatedAt @map("updated_at")
  employee          Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("employee_details")
}

model LeaveType {
  id               String   @id @db.Char(36)
  tenantId         String   @map("tenant_id") @db.VarChar(36)
  leaveTypeName    String   @map("leave_type_name") @db.VarChar(100)
  allowedDays      Int      @map("allowed_days")
  accrualRate      Decimal? @map("accrual_rate") @db.Decimal(5, 2)
  isCarryOver      Boolean  @default(false) @map("is_carry_over")
  maxCarryOver     Int      @default(0) @map("max_carry_over")
  requiresApproval Boolean  @default(true) @map("requires_approval")
  createdAt        DateTime @default(now()) @map("created_at")

  @@unique([tenantId, leaveTypeName])
  @@index([tenantId])
  @@map("leave_type")
}

model LeaveBalance {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  employeeId     String   @map("employee_id") @db.Char(36)
  leaveTypeId    String   @map("leave_type_id") @db.VarChar(36)
  year           Int
  openingBalance Decimal  @map("opening_balance") @db.Decimal(5, 2)
  accrued        Decimal  @db.Decimal(5, 2)
  utilized       Decimal  @db.Decimal(5, 2)
  carried        Decimal  @db.Decimal(5, 2)
  closingBalance Decimal  @map("closing_balance") @db.Decimal(5, 2)
  updatedAt      DateTime @updatedAt @map("updated_at")
  employee       Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@unique([tenantId, employeeId, leaveTypeId, year])
  @@index([tenantId])
  @@map("leave_balance")
}

model Designation {
  id               String   @id @db.Char(36)
  tenantId         String   @map("tenant_id") @db.VarChar(36)
  designationName  String   @map("designation_name") @db.VarChar(100)
  designationLevel Int?     @map("designation_level")
  description      String?  @db.Text
  createdAt        DateTime @default(now()) @map("created_at")

  @@unique([tenantId, designationName])
  @@index([tenantId])
  @@map("designation")
}

model Department {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  departmentName String   @map("department_name") @db.VarChar(100)
  departmentCode String   @map("department_code") @db.VarChar(50)
  headId         String?  @map("head_id") @db.VarChar(36)
  costCenter     String?  @map("cost_center") @db.VarChar(50)
  description    String?  @db.Text
  createdAt      DateTime @default(now()) @map("created_at")

  @@unique([tenantId, departmentCode])
  @@index([tenantId])
  @@map("department")
}

model SalaryComponent {
  id            String   @id @db.Char(36)
  tenantId      String   @map("tenant_id") @db.VarChar(36)
  componentName String   @map("component_name") @db.VarChar(100)
  componentType String   @map("component_type") @db.VarChar(50)
  taxable       Boolean  @default(false)
  formula       String?  @db.Text
  createdAt     DateTime @default(now()) @map("created_at")

  @@unique([tenantId, componentName])
  @@index([tenantId])
  @@map("salary_component")
}

model PayrollRun {
  id              String    @id @db.Char(36)
  tenantId        String    @map("tenant_id") @db.VarChar(36)
  month           Int
  year            Int
  payrollStatus   String    @default("draft") @map("payroll_status") @db.VarChar(50)
  totalEmployees  Int       @map("total_employees")
  totalSalary     Decimal   @map("total_salary") @db.Decimal(15, 2)
  totalDeductions Decimal   @map("total_deductions") @db.Decimal(15, 2)
  netPayable      Decimal   @map("net_payable") @db.Decimal(15, 2)
  freezeDate      DateTime? @map("freeze_date")
  processedBy     String?   @map("processed_by") @db.VarChar(36)
  processedAt     DateTime? @map("processed_at")
  createdAt       DateTime  @default(now()) @map("created_at")

  @@unique([tenantId, month, year])
  @@index([tenantId])
  @@map("payroll_run")
}

model EPFConfiguration {
  id                       String   @id @db.Char(36)
  tenantId                 String   @map("tenant_id") @db.VarChar(36)
  epfNumber                String   @unique @map("epf_number") @db.VarChar(50)
  epfRegistrationDate      DateTime @map("epf_registration_date") @db.Date
  epfEstablishmentCode     String   @map("epf_establishment_code") @db.VarChar(50)
  companyContributionRate  Decimal  @map("company_contribution_rate") @db.Decimal(5, 2)
  employeeContributionRate Decimal  @map("employee_contribution_rate") @db.Decimal(5, 2)
  createdAt                DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("epf_configuration")
}

model ESIConfiguration {
  id                       String   @id @db.Char(36)
  tenantId                 String   @map("tenant_id") @db.VarChar(36)
  esiNumber                String   @unique @map("esi_number") @db.VarChar(50)
  esiRegistrationDate      DateTime @map("esi_registration_date") @db.Date
  companyContributionRate  Decimal  @map("company_contribution_rate") @db.Decimal(5, 2)
  employeeContributionRate Decimal  @map("employee_contribution_rate") @db.Decimal(5, 2)
  wageLimit                Decimal  @map("wage_limit") @db.Decimal(10, 2)
  createdAt                DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("esi_configuration")
}

model EmployeeEPFRegistration {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  employeeId     String   @map("employee_id") @db.Char(36)
  epfNumber      String   @map("epf_number") @db.VarChar(50)
  enrollmentDate DateTime @map("enrollment_date") @db.Date
  memberStatus   String   @default("active") @map("member_status") @db.VarChar(50)
  createdAt      DateTime @default(now()) @map("created_at")
  employee       Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("employee_epf_registration")
}

model EmployeeESIRegistration {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  employeeId     String   @map("employee_id") @db.Char(36)
  esiNumber      String   @map("esi_number") @db.VarChar(50)
  enrollmentDate DateTime @map("enrollment_date") @db.Date
  memberStatus   String   @default("active") @map("member_status") @db.VarChar(50)
  createdAt      DateTime @default(now()) @map("created_at")
  employee       Employee @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("employee_esi_registration")
}

model EPFContribution {
  id                   String    @id @db.Char(36)
  tenantId             String    @map("tenant_id") @db.VarChar(36)
  employeeId           String    @map("employee_id") @db.Char(36)
  payrollMonth         Int       @map("payroll_month")
  payrollYear          Int       @map("payroll_year")
  companyContribution  Decimal   @map("company_contribution") @db.Decimal(12, 2)
  employeeContribution Decimal   @map("employee_contribution") @db.Decimal(12, 2)
  submissionDate       DateTime? @map("submission_date") @db.Date
  createdAt            DateTime  @default(now()) @map("created_at")
  employee             Employee  @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("epf_contribution")
}

model ESIContribution {
  id                   String    @id @db.Char(36)
  tenantId             String    @map("tenant_id") @db.VarChar(36)
  employeeId           String    @map("employee_id") @db.Char(36)
  payrollMonth         Int       @map("payroll_month")
  payrollYear          Int       @map("payroll_year")
  companyContribution  Decimal   @map("company_contribution") @db.Decimal(12, 2)
  employeeContribution Decimal   @map("employee_contribution") @db.Decimal(12, 2)
  submissionDate       DateTime? @map("submission_date") @db.Date
  createdAt            DateTime  @default(now()) @map("created_at")
  employee             Employee  @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("esi_contribution")
}

model ComplianceRecord {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  recordType     String    @map("record_type") @db.VarChar(100)
  recordValue    String?   @map("record_value") @db.Text
  dueDate        DateTime? @map("due_date") @db.Date
  completionDate DateTime? @map("completion_date") @db.Date
  status         String    @default("pending") @db.VarChar(50)
  createdAt      DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([status])
  @@map("compliance_record")
}

model EmployeeComplianceChecklist {
  id              String    @id @db.Char(36)
  tenantId        String    @map("tenant_id") @db.VarChar(36)
  employeeId      String    @map("employee_id") @db.Char(36)
  itemDescription String    @map("item_description") @db.VarChar(255)
  isCompleted     Boolean   @default(false) @map("is_completed")
  completionDate  DateTime? @map("completion_date") @db.Date
  notes           String?   @db.Text
  createdAt       DateTime  @default(now()) @map("created_at")
  employee        Employee  @relation(fields: [employeeId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("employee_compliance_checklist")
}

model SalesLead {
  id                   String                    @id @db.Char(36)
  tenantId             String                    @map("tenant_id") @db.VarChar(36)
  leadCode             String                    @unique @map("lead_code") @db.VarChar(50)
  leadName             String                    @map("lead_name") @db.VarChar(255)
  email                String?                   @db.VarChar(255)
  phone                String?                   @db.VarChar(20)
  company              String?                   @db.VarChar(255)
  leadSource           String?                   @map("lead_source") @db.VarChar(100)
  leadValue            Decimal?                  @map("lead_value") @db.Decimal(15, 2)
  leadStatus           String                    @default("new") @map("lead_status") @db.VarChar(50)
  description          String?                   @db.Text
  assignedTo           String?                   @map("assigned_to") @db.VarChar(36)
  createdBy            String?                   @map("created_by") @db.VarChar(36)
  createdAt            DateTime                  @default(now()) @map("created_at")
  updatedAt            DateTime                  @updatedAt @map("updated_at")
  statusHistory        SalesStatusHistory[]
  followUps            SalesFollowUp[]
  attributionEvents    AttributionEvent[] // Events that drove this lead
  attributionSnapshots LeadAttributionSnapshot[] // Attribution analysis snapshots

  @@index([tenantId])
  @@index([leadCode])
  @@index([leadStatus])
  @@map("sales_lead")
}

model SalesCustomer {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  customerCode String   @unique @map("customer_code") @db.VarChar(50)
  name         String   @db.VarChar(255)
  email        String?  @db.VarChar(255)
  phone        String?  @db.VarChar(20)
  address      String?  @db.Text
  city         String?  @db.VarChar(100)
  state        String?  @db.VarChar(100)
  country      String?  @db.VarChar(100)
  postalCode   String?  @map("postal_code") @db.VarChar(20)
  customerType String?  @map("customer_type") @db.VarChar(50)
  creditLimit  Decimal? @map("credit_limit") @db.Decimal(15, 2)
  paymentTerms String?  @map("payment_terms") @db.VarChar(100)
  status       String   @default("active") @db.VarChar(50)
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")
  calls        Call[] // From callcenter module

  @@index([tenantId])
  @@index([customerCode])
  @@map("sales_customer")
}

model Quotation {
  id              String              @id @db.Char(36)
  tenantId        String              @map("tenant_id") @db.VarChar(36)
  quotationNumber String              @unique @map("quotation_number") @db.VarChar(50)
  customerId      String?             @map("customer_id") @db.VarChar(36)
  quotationDate   DateTime            @map("quotation_date") @db.Date
  validTill       DateTime            @map("valid_till") @db.Date
  totalAmount     Decimal?            @map("total_amount") @db.Decimal(18, 2)
  tax             Decimal             @default(0) @db.Decimal(18, 2)
  netAmount       Decimal?            @map("net_amount") @db.Decimal(18, 2)
  status          String              @default("draft") @db.VarChar(50)
  approvedBy      String?             @map("approved_by") @db.VarChar(36)
  approvedAt      DateTime?           @map("approved_at")
  createdBy       String?             @map("created_by") @db.VarChar(36)
  createdAt       DateTime            @default(now()) @map("created_at")
  updatedAt       DateTime            @updatedAt @map("updated_at")
  lineItems       QuotationLineItem[]

  @@index([tenantId])
  @@index([quotationNumber])
  @@index([status])
  @@map("quotation")
}

model QuotationLineItem {
  id          String    @id @db.Char(36)
  tenantId    String    @map("tenant_id") @db.VarChar(36)
  quotationId String    @map("quotation_id") @db.VarChar(36)
  description String?   @db.VarChar(500)
  quantity    Decimal   @db.Decimal(18, 4)
  unitPrice   Decimal   @map("unit_price") @db.Decimal(18, 4)
  lineAmount  Decimal   @map("line_amount") @db.Decimal(18, 2)
  tax         Decimal   @default(0) @db.Decimal(18, 2)
  lineTotal   Decimal   @map("line_total") @db.Decimal(18, 2)
  createdAt   DateTime  @default(now()) @map("created_at")
  quotation   Quotation @relation(fields: [quotationId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([quotationId])
  @@map("quotation_line_item")
}

model SalesOrder {
  id           String               @id @db.Char(36)
  tenantId     String               @map("tenant_id") @db.VarChar(36)
  orderNumber  String               @unique @map("order_number") @db.VarChar(50)
  customerId   String?              @map("customer_id") @db.VarChar(36)
  quotationId  String?              @map("quotation_id") @db.VarChar(36)
  orderDate    DateTime             @map("order_date") @db.Date
  deliveryDate DateTime?            @map("delivery_date") @db.Date
  totalAmount  Decimal?             @map("total_amount") @db.Decimal(18, 2)
  tax          Decimal              @default(0) @db.Decimal(18, 2)
  netAmount    Decimal?             @map("net_amount") @db.Decimal(18, 2)
  status       String               @default("draft") @db.VarChar(50)
  createdBy    String?              @map("created_by") @db.VarChar(36)
  createdAt    DateTime             @default(now()) @map("created_at")
  updatedAt    DateTime             @updatedAt @map("updated_at")
  lineItems    SalesOrderLineItem[]
  invoices     SalesInvoice[]

  @@index([tenantId])
  @@index([orderNumber])
  @@index([status])
  @@map("sales_order")
}

model SalesOrderLineItem {
  id                    String                 @id @db.Char(36)
  tenantId              String                 @map("tenant_id") @db.VarChar(36)
  orderid               String                 @map("order_id") @db.VarChar(36)
  description           String?                @db.VarChar(500)
  quantity              Decimal                @db.Decimal(18, 4)
  unitPrice             Decimal                @map("unit_price") @db.Decimal(18, 4)
  lineAmount            Decimal                @map("line_amount") @db.Decimal(18, 2)
  tax                   Decimal                @default(0) @db.Decimal(18, 2)
  lineTotal             Decimal                @map("line_total") @db.Decimal(18, 2)
  quantityDelivered     Decimal                @default(0) @map("quantity_delivered") @db.Decimal(18, 4)
  createdAt             DateTime               @default(now()) @map("created_at")
  order                 SalesOrder             @relation(fields: [orderid], references: [id], onDelete: Cascade)
  exportHSCodeLineItems ExportHSCodeLineItem[] // From import/export module

  @@index([tenantId])
  @@index([orderid])
  @@map("sales_order_line_item")
}

model SalesInvoice {
  id            String                 @id @db.Char(36)
  tenantId      String                 @map("tenant_id") @db.VarChar(36)
  invoiceNumber String                 @unique @map("invoice_number") @db.VarChar(50)
  orderId       String?                @map("order_id") @db.VarChar(36)
  customerId    String?                @map("customer_id") @db.VarChar(36)
  invoiceDate   DateTime               @map("invoice_date") @db.Date
  dueDate       DateTime?              @map("due_date") @db.Date
  totalAmount   Decimal?               @map("total_amount") @db.Decimal(18, 2)
  tax           Decimal                @default(0) @db.Decimal(18, 2)
  netAmount     Decimal?               @map("net_amount") @db.Decimal(18, 2)
  amountPaid    Decimal                @default(0) @map("amount_paid") @db.Decimal(18, 2)
  status        String                 @default("draft") @db.VarChar(50)
  createdBy     String?                @map("created_by") @db.VarChar(36)
  createdAt     DateTime               @default(now()) @map("created_at")
  updatedAt     DateTime               @updatedAt @map("updated_at")
  order         SalesOrder?            @relation(fields: [orderId], references: [id])
  lineItems     SalesInvoiceLineItem[]

  @@index([tenantId])
  @@index([invoiceNumber])
  @@index([status])
  @@map("sales_invoice")
}

model SalesInvoiceLineItem {
  id          String       @id @db.Char(36)
  tenantId    String       @map("tenant_id") @db.VarChar(36)
  invoiceId   String       @map("invoice_id") @db.VarChar(36)
  description String?      @db.VarChar(500)
  quantity    Decimal      @db.Decimal(18, 4)
  unitPrice   Decimal      @map("unit_price") @db.Decimal(18, 4)
  lineAmount  Decimal      @map("line_amount") @db.Decimal(18, 2)
  tax         Decimal      @default(0) @db.Decimal(18, 2)
  lineTotal   Decimal      @map("line_total") @db.Decimal(18, 2)
  createdAt   DateTime     @default(now()) @map("created_at")
  invoice     SalesInvoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([invoiceId])
  @@map("sales_invoice_line_item")
}

model SalesReturn {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  returnNumber String   @unique @map("return_number") @db.VarChar(50)
  invoiceId    String?  @map("invoice_id") @db.VarChar(36)
  returnDate   DateTime @map("return_date") @db.Date
  reason       String?  @db.Text
  totalAmount  Decimal  @map("total_amount") @db.Decimal(18, 2)
  status       String   @default("pending") @db.VarChar(50)
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([returnNumber])
  @@map("sales_return")
}

model SalesStatusHistory {
  id        String    @id @db.Char(36)
  tenantId  String    @map("tenant_id") @db.VarChar(36)
  leadId    String    @map("lead_id") @db.VarChar(36)
  oldStatus String    @map("old_status") @db.VarChar(50)
  newStatus String    @map("new_status") @db.VarChar(50)
  changedBy String?   @map("changed_by") @db.VarChar(36)
  remarks   String?   @db.Text
  changedAt DateTime  @default(now()) @map("changed_at")
  lead      SalesLead @relation(fields: [leadId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([leadId])
  @@map("sales_status_history")
}

model SalesFollowUp {
  id               String    @id @db.Char(36)
  tenantId         String    @map("tenant_id") @db.VarChar(36)
  leadId           String    @map("lead_id") @db.Char(36)
  followUpDate     DateTime  @map("follow_up_date") @db.Date
  followUpType     String    @map("follow_up_type") @db.VarChar(50)
  notes            String?   @db.Text
  result           String?   @db.VarChar(100)
  nextFollowUpDate DateTime? @map("next_follow_up_date") @db.Date
  createdBy        String?   @map("created_by") @db.VarChar(36)
  createdAt        DateTime  @default(now()) @map("created_at")
  lead             SalesLead @relation(fields: [leadId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([leadId])
  @@map("sales_follow_up")
}

model SalesTarget {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  period         String   @db.VarChar(50)
  salesPersonId  String   @map("sales_person_id") @db.VarChar(36)
  targetAmount   Decimal  @map("target_amount") @db.Decimal(15, 2)
  achievedAmount Decimal  @default(0) @map("achieved_amount") @db.Decimal(15, 2)
  createdAt      DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("sales_target")
}

model LeadStatusType {
  id            String   @id @db.Char(36)
  tenantId      String   @map("tenant_id") @db.VarChar(36)
  statusName    String   @map("status_name") @db.VarChar(100)
  statusCode    String   @map("status_code") @db.VarChar(50)
  description   String?  @db.Text
  colorCode     String?  @map("color_code") @db.VarChar(10)
  sequenceOrder Int      @map("sequence_order")
  createdAt     DateTime @default(now()) @map("created_at")

  @@unique([tenantId, statusCode])
  @@index([tenantId])
  @@map("lead_status_type")
}

model LeadConversionRate {
  id                String   @id @db.Char(36)
  tenantId          String   @map("tenant_id") @db.VarChar(36)
  sourceId          String   @map("source_id") @db.VarChar(36)
  statusId          String   @map("status_id") @db.VarChar(36)
  conversionPercent Decimal  @map("conversion_percent") @db.Decimal(5, 2)
  totalLeads        Int      @default(0) @map("total_leads")
  convertedLeads    Int      @default(0) @map("converted_leads")
  createdAt         DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("lead_conversion_rate")
}

model PropertyProject {
  id             String          @id @db.Char(36)
  tenantId       String          @map("tenant_id") @db.VarChar(36)
  projectName    String          @map("project_name") @db.VarChar(255)
  projectCode    String          @unique @map("project_code") @db.VarChar(50)
  location       String?         @db.VarChar(255)
  city           String?         @db.VarChar(100)
  state          String?         @db.VarChar(100)
  country        String?         @db.VarChar(100)
  postalCode     String?         @map("postal_code") @db.VarChar(20)
  projectType    String?         @map("project_type") @db.VarChar(50)
  totalArea      Decimal?        @map("total_area") @db.Decimal(15, 2)
  totalUnits     Int             @default(0) @map("total_units")
  launchDate     DateTime?       @map("launch_date") @db.Date
  completionDate DateTime?       @map("completion_date") @db.Date
  status         String          @default("planning") @db.VarChar(50)
  developerId    String?         @map("developer_id") @db.VarChar(36)
  description    String?         @db.LongText
  createdAt      DateTime        @default(now()) @map("created_at")
  updatedAt      DateTime        @updatedAt @map("updated_at")
  blocks         PropertyBlock[]
  units          PropertyUnit[]

  @@index([tenantId])
  @@index([projectCode])
  @@index([status])
  @@map("property_project")
}

model PropertyBlock {
  id         String          @id @db.Char(36)
  tenantId   String          @map("tenant_id") @db.VarChar(36)
  projectId  String          @map("project_id") @db.VarChar(36)
  blockName  String          @map("block_name") @db.VarChar(100)
  blockCode  String          @map("block_code") @db.VarChar(50)
  totalUnits Int             @default(0) @map("total_units")
  unitsLeft  Int             @default(0) @map("units_left")
  createdAt  DateTime        @default(now()) @map("created_at")
  project    PropertyProject @relation(fields: [projectId], references: [id], onDelete: Cascade)
  units      PropertyUnit[]

  @@unique([projectId, blockCode])
  @@index([tenantId])
  @@index([projectId])
  @@map("property_block")
}

model PropertyUnit {
  id               String          @id @db.Char(36)
  tenantId         String          @map("tenant_id") @db.VarChar(36)
  projectId        String          @map("project_id") @db.VarChar(36)
  blockId          String?         @map("block_id") @db.VarChar(36)
  unitNumber       String          @map("unit_number") @db.VarChar(50)
  unitType         String          @map("unit_type") @db.VarChar(50)
  builtUpArea      Decimal         @map("built_up_area") @db.Decimal(10, 2)
  carpetArea       Decimal         @map("carpet_area") @db.Decimal(10, 2)
  superBuiltUpArea Decimal?        @map("super_built_up_area") @db.Decimal(10, 2)
  bedrooms         Int?
  bathrooms        Int?
  floor            Int?
  basePrice        Decimal         @map("base_price") @db.Decimal(15, 2)
  status           String          @default("available") @db.VarChar(50)
  description      String?         @db.Text
  createdAt        DateTime        @default(now()) @map("created_at")
  updatedAt        DateTime        @updatedAt @map("updated_at")
  project          PropertyProject @relation(fields: [projectId], references: [id], onDelete: Cascade)
  block            PropertyBlock?  @relation(fields: [blockId], references: [id], onDelete: SetNull)
  costSheets       UnitCostSheet[]
  bookings         Booking[]
  paymentPlans     PaymentPlan[]

  @@unique([projectId, unitNumber])
  @@index([tenantId])
  @@index([projectId])
  @@index([status])
  @@map("property_unit")
}

model UnitCostSheet {
  id              String       @id @db.Char(36)
  tenantId        String       @map("tenant_id") @db.VarChar(36)
  unitId          String       @map("unit_id") @db.VarChar(36)
  basicPrice      Decimal      @map("basic_price") @db.Decimal(15, 2)
  floorRiseFactor Decimal      @default(0) @map("floor_rise_factor") @db.Decimal(5, 2)
  cornerFactor    Decimal      @default(0) @map("corner_factor") @db.Decimal(5, 2)
  otherCharges    Decimal      @default(0) @map("other_charges") @db.Decimal(15, 2)
  taxes           Decimal      @default(0) @db.Decimal(15, 2)
  totalPrice      Decimal      @map("total_price") @db.Decimal(15, 2)
  validFrom       DateTime     @map("valid_from") @db.Date
  validTill       DateTime?    @map("valid_till") @db.Date
  createdAt       DateTime     @default(now()) @map("created_at")
  unit            PropertyUnit @relation(fields: [unitId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([unitId])
  @@map("unit_cost_sheet")
}

model PaymentPlan {
  id             String        @id @db.Char(36)
  tenantId       String        @map("tenant_id") @db.VarChar(36)
  unitId         String        @map("unit_id") @db.VarChar(36)
  planName       String        @map("plan_name") @db.VarChar(100)
  totalPrice     Decimal       @map("total_price") @db.Decimal(15, 2)
  upfrontAmount  Decimal       @map("upfront_amount") @db.Decimal(15, 2)
  upfrontPercent Decimal?      @map("upfront_percent") @db.Decimal(5, 2)
  description    String?       @db.Text
  isActive       Boolean       @default(true) @map("is_active")
  createdAt      DateTime      @default(now()) @map("created_at")
  updatedAt      DateTime      @updatedAt @map("updated_at")
  unit           PropertyUnit  @relation(fields: [unitId], references: [id], onDelete: Cascade)
  installments   Installment[]

  @@index([tenantId])
  @@index([unitId])
  @@map("payment_plan")
}

model Installment {
  id                String      @id @db.Char(36)
  tenantId          String      @map("tenant_id") @db.VarChar(36)
  paymentPlanId     String      @map("payment_plan_id") @db.VarChar(36)
  installmentNumber Int         @map("installment_number")
  dueDate           DateTime    @map("due_date") @db.Date
  amount            Decimal     @db.Decimal(15, 2)
  description       String?     @db.VarChar(255)
  createdAt         DateTime    @default(now()) @map("created_at")
  paymentPlan       PaymentPlan @relation(fields: [paymentPlanId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([paymentPlanId])
  @@map("installment")
}

model Booking {
  id            String       @id @db.Char(36)
  tenantId      String       @map("tenant_id") @db.VarChar(36)
  unitId        String       @map("unit_id") @db.VarChar(36)
  customerId    String?      @map("customer_id") @db.VarChar(36)
  bookingDate   DateTime     @map("booking_date") @db.Date
  bookingAmount Decimal      @map("booking_amount") @db.Decimal(15, 2)
  status        String       @default("booked") @db.VarChar(50)
  notes         String?      @db.Text
  createdAt     DateTime     @default(now()) @map("created_at")
  updatedAt     DateTime     @updatedAt @map("updated_at")
  unit          PropertyUnit @relation(fields: [unitId], references: [id], onDelete: Cascade)

  @@unique([unitId])
  @@index([tenantId])
  @@index([customerId])
  @@map("booking")
}

model PropertyCostBreakup {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  unitId       String   @map("unit_id") @db.VarChar(36)
  costCategory String   @map("cost_category") @db.VarChar(100)
  costAmount   Decimal  @map("cost_amount") @db.Decimal(15, 2)
  costPercent  Decimal? @map("cost_percent") @db.Decimal(5, 2)
  description  String?  @db.Text
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([unitId])
  @@map("property_cost_breakup")
}

model PropertyAmenity {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  projectId   String?  @map("project_id") @db.VarChar(36)
  amenityName String   @map("amenity_name") @db.VarChar(100)
  amenityType String?  @map("amenity_type") @db.VarChar(50)
  description String?  @db.Text
  createdAt   DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("property_amenity")
}

model PropertyUnitAreaStatement {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  unitId      String   @map("unit_id") @db.VarChar(36)
  areaType    String   @map("area_type") @db.VarChar(100)
  areaValue   Decimal  @map("area_value") @db.Decimal(10, 2)
  areaUnit    String   @map("area_unit") @db.VarChar(20)
  description String?  @db.Text
  createdAt   DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("property_unit_area_statement")
}

model ProjectCostConfiguration {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  projectId       String   @map("project_id") @db.VarChar(36)
  costName        String   @map("cost_name") @db.VarChar(100)
  costFormula     String?  @map("cost_formula") @db.Text
  applicableUnits String?  @map("applicable_units") @db.Text
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("project_cost_configuration")
}

model PropertyCustomerProfile {
  id                 String   @id @db.Char(36)
  tenantId           String   @map("tenant_id") @db.VarChar(36)
  customerId         String   @map("customer_id") @db.VarChar(36)
  occupationStatus   String?  @map("occupation_status") @db.VarChar(100)
  incomeRange        String?  @map("income_range") @db.VarChar(50)
  investmentGoal     String?  @map("investment_goal") @db.VarChar(255)
  investmentTimeline String?  @map("investment_timeline") @db.VarChar(50)
  preferences        String?  @db.Text
  createdAt          DateTime @default(now()) @map("created_at")
  updatedAt          DateTime @updatedAt @map("updated_at")

  @@index([tenantId])
  @@index([customerId])
  @@map("property_customer_profile")
}

model PropertyComparable {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  projectId      String   @map("project_id") @db.VarChar(36)
  comparableType String   @map("comparable_type") @db.VarChar(100)
  location       String?  @db.VarChar(255)
  pricePerSqFt   Decimal  @map("price_per_sqft") @db.Decimal(10, 2)
  marketData     String?  @map("market_data") @db.Text
  createdAt      DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("property_comparable")
}

model SiteVisitFeedback {
  id               String   @id @db.Char(36)
  tenantId         String   @map("tenant_id") @db.VarChar(36)
  siteVisitId      String   @map("site_visit_id") @db.VarChar(36)
  feedback         String?  @db.Text
  rating           Decimal? @db.Decimal(3, 1)
  followUpRequired Boolean  @default(false) @map("follow_up_required")
  createdAt        DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("site_visit_feedback")
}

model ComplianceChecklist {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  checklistName  String    @map("checklist_name") @db.VarChar(255)
  description    String?   @db.Text
  frequency      String    @db.VarChar(50)
  dueDate        DateTime  @map("due_date") @db.Date
  completionDate DateTime? @map("completion_date") @db.Date
  status         String    @default("pending") @db.VarChar(50)
  completedBy    String?   @map("completed_by") @db.VarChar(36)
  createdAt      DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([status])
  @@map("compliance_checklist")
}

model TaxCalculation {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  transactionType String   @map("transaction_type") @db.VarChar(100)
  transactionId   String?  @map("transaction_id") @db.VarChar(36)
  taxType         String   @map("tax_type") @db.VarChar(50)
  taxableAmount   Decimal  @map("taxable_amount") @db.Decimal(15, 2)
  taxRate         Decimal  @map("tax_rate") @db.Decimal(5, 2)
  taxAmount       Decimal  @map("tax_amount") @db.Decimal(15, 2)
  calculatedDate  DateTime @map("calculated_date") @db.Date
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([transactionType])
  @@map("tax_calculation")
}

model AuditTrail {
  id         String   @id @db.Char(36)
  tenantId   String   @map("tenant_id") @db.VarChar(36)
  auditType  String   @map("audit_type") @db.VarChar(100)
  entityType String   @map("entity_type") @db.VarChar(100)
  entityId   String?  @map("entity_id") @db.VarChar(36)
  auditDate  DateTime @map("audit_date") @db.Date
  findings   String?  @db.LongText
  status     String   @db.VarChar(50)
  auditor    String?  @db.VarChar(255)
  createdAt  DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([auditType])
  @@map("audit_trail")
}

model RegulatoryRequirement {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  requirementName String   @map("requirement_name") @db.VarChar(255)
  requirementType String   @map("requirement_type") @db.VarChar(100)
  jurisdiction    String   @db.VarChar(100)
  dueDate         DateTime @map("due_date") @db.Date
  status          String   @default("pending") @db.VarChar(50)
  ownerDepartment String?  @map("owner_department") @db.VarChar(100)
  description     String?  @db.Text
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([status])
  @@map("regulatory_requirement")
}

model ComplianceDocument {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  complianceType String    @map("compliance_type") @db.VarChar(100)
  documentName   String    @map("document_name") @db.VarChar(255)
  documentPath   String?   @map("document_path") @db.VarChar(500)
  uploadDate     DateTime  @map("upload_date") @db.Date
  expiryDate     DateTime? @map("expiry_date") @db.Date
  uploadedBy     String?   @map("uploaded_by") @db.VarChar(36)
  createdAt      DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("compliance_document")
}

model ComplianceNotification {
  id               String    @id @db.Char(36)
  tenantId         String    @map("tenant_id") @db.VarChar(36)
  notificationType String    @map("notification_type") @db.VarChar(100)
  subject          String    @db.VarChar(255)
  message          String?   @db.LongText
  dueDate          DateTime  @map("due_date") @db.Date
  recipientEmail   String?   @map("recipient_email") @db.VarChar(255)
  sentDate         DateTime? @map("sent_date")
  status           String    @default("pending") @db.VarChar(50)
  createdAt        DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([status])
  @@map("compliance_notification")
}

model CommunicationChannel {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  channelName String   @map("channel_name") @db.VarChar(100)
  channelType String   @map("channel_type") @db.VarChar(50)
  description String?  @db.Text
  isActive    Boolean  @default(true) @map("is_active")
  configData  Json?    @map("config_data")
  createdAt   DateTime @default(now()) @map("created_at")

  @@unique([tenantId, channelName])
  @@index([tenantId])
  @@map("communication_channel")
}

model MessageTemplate {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  templateName String   @map("template_name") @db.VarChar(255)
  templateType String   @map("template_type") @db.VarChar(50)
  channelId    String?  @map("channel_id") @db.VarChar(36)
  subject      String?  @db.VarChar(255)
  body         String?  @db.LongText
  variables    String?  @db.Text
  isActive     Boolean  @default(true) @map("is_active")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@index([tenantId])
  @@map("message_template")
}

model CommunicationSession {
  id             String                 @id @db.Char(36)
  tenantId       String                 @map("tenant_id") @db.VarChar(36)
  sessionId      String                 @unique @map("session_id") @db.VarChar(100)
  initiatorId    String                 @map("initiator_id") @db.VarChar(36)
  participantIds String?                @map("participant_ids") @db.Text
  channelType    String                 @map("channel_type") @db.VarChar(50)
  subject        String?                @db.VarChar(255)
  status         String                 @default("active") @db.VarChar(50)
  startTime      DateTime               @map("start_time")
  endTime        DateTime?              @map("end_time")
  createdAt      DateTime               @default(now()) @map("created_at")
  messages       CommunicationMessage[]

  @@index([tenantId])
  @@index([sessionId])
  @@map("communication_session")
}

model CommunicationMessage {
  id             String               @id @db.Char(36)
  tenantId       String               @map("tenant_id") @db.VarChar(36)
  sessionId      String               @map("session_id") @db.VarChar(36)
  senderId       String               @map("sender_id") @db.VarChar(36)
  recipientIds   String?              @map("recipient_ids") @db.Text
  messageType    String               @map("message_type") @db.VarChar(50)
  subject        String?              @db.VarChar(255)
  body           String?              @db.LongText
  attachments    Json?                @map("attachments")
  deliveryStatus String               @default("pending") @map("delivery_status") @db.VarChar(50)
  readAt         DateTime?            @map("read_at")
  failureReason  String?              @map("failure_reason") @db.Text
  sentAt         DateTime             @default(now()) @map("sent_at")
  createdAt      DateTime             @default(now()) @map("created_at")
  session        CommunicationSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@index([sessionId])
  @@index([senderId])
  @@map("communication_message")
}

model EmailConfiguration {
  id         String   @id @db.Char(36)
  tenantId   String   @map("tenant_id") @db.VarChar(36)
  smtpServer String   @map("smtp_server") @db.VarChar(255)
  smtpPort   Int      @map("smtp_port")
  fromEmail  String   @map("from_email") @db.VarChar(255)
  fromName   String?  @map("from_name") @db.VarChar(255)
  username   String?  @db.VarChar(255)
  password   String?  @db.VarChar(500)
  useSSL     Boolean  @default(true) @map("use_ssl")
  isActive   Boolean  @default(false) @map("is_active")
  createdAt  DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("email_configuration")
}

model SMSConfiguration {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  provider       String   @db.VarChar(100)
  apiKey         String   @map("api_key") @db.VarChar(500)
  senderID       String   @map("sender_id") @db.VarChar(50)
  accountBalance Decimal? @map("account_balance") @db.Decimal(15, 2)
  isActive       Boolean  @default(false) @map("is_active")
  createdAt      DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("sms_configuration")
}

model WebhookEndpoint {
  id              String    @id @db.Char(36)
  tenantId        String    @map("tenant_id") @db.VarChar(36)
  endpointUrl     String    @map("endpoint_url") @db.VarChar(500)
  eventType       String    @map("event_type") @db.VarChar(100)
  isActive        Boolean   @default(true) @map("is_active")
  retryCount      Int       @default(3) @map("retry_count")
  timeout         Int       @default(30)
  lastTriggeredAt DateTime? @map("last_triggered_at")
  createdAt       DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("webhook_endpoint")
}

model WebhookLog {
  id            String    @id @db.Char(36)
  tenantId      String    @map("tenant_id") @db.VarChar(36)
  webhookId     String    @map("webhook_id") @db.VarChar(36)
  eventType     String    @map("event_type") @db.VarChar(100)
  payload       Json?     @map("payload")
  statusCode    Int?      @map("status_code")
  response      String?   @db.LongText
  attemptNumber Int       @map("attempt_number")
  nextRetryAt   DateTime? @map("next_retry_at")
  triggeredAt   DateTime  @default(now()) @map("triggered_at")

  @@index([tenantId])
  @@index([webhookId])
  @@map("webhook_log")
}

model NotificationPreference {
  id               String   @id @db.Char(36)
  tenantId         String   @map("tenant_id") @db.VarChar(36)
  userId           String   @map("user_id") @db.Char(36)
  notificationType String   @map("notification_type") @db.VarChar(100)
  channelType      String   @map("channel_type") @db.VarChar(50)
  isEnabled        Boolean  @default(true) @map("is_enabled")
  frequency        String?  @db.VarChar(50)
  createdAt        DateTime @default(now()) @map("created_at")

  @@unique([tenantId, userId, notificationType, channelType])
  @@index([tenantId])
  @@map("notification_preference")
}

model CommunicationLog {
  id                String    @id @db.Char(36)
  tenantId          String    @map("tenant_id") @db.VarChar(36)
  communicationType String    @map("communication_type") @db.VarChar(50)
  fromId            String    @map("from_id") @db.VarChar(36)
  toId              String    @map("to_id") @db.VarChar(36)
  subject           String?   @db.VarChar(255)
  status            String    @db.VarChar(50)
  sentAt            DateTime  @default(now()) @map("sent_at")
  deliveredAt       DateTime? @map("delivered_at")
  readAt            DateTime? @map("read_at")

  @@index([tenantId])
  @@index([fromId, toId])
  @@map("communication_log")
}

model VOIPProvider {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  providerName String   @map("provider_name") @db.VarChar(100)
  apiKey       String   @map("api_key") @db.VarChar(500)
  apiSecret    String   @map("api_secret") @db.VarChar(500)
  endpoint     String?  @db.VarChar(255)
  isActive     Boolean  @default(true) @map("is_active")
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("voip_provider")
}

model ClickToCallSession {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  sessionId      String    @unique @map("session_id") @db.VarChar(100)
  initiatorId    String    @map("initiator_id") @db.VarChar(36)
  receiverId     String?   @map("receiver_id") @db.VarChar(36)
  initiatorPhone String    @map("initiator_phone") @db.VarChar(20)
  receiverPhone  String?   @map("receiver_phone") @db.VarChar(20)
  status         String    @db.VarChar(50)
  duration       Int       @default(0)
  recordingUrl   String?   @map("recording_url") @db.VarChar(500)
  startTime      DateTime  @map("start_time")
  endTime        DateTime? @map("end_time")
  callType       String?   @map("call_type") @db.VarChar(50)
  notes          String?   @db.Text
  createdAt      DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([sessionId])
  @@map("click_to_call_session")
}

model CallRoutingRule {
  id            String   @id @db.Char(36)
  tenantId      String   @map("tenant_id") @db.VarChar(36)
  ruleName      String   @map("rule_name") @db.VarChar(100)
  priority      Int
  source        String?  @db.VarChar(255)
  destination   String?  @db.VarChar(255)
  routingType   String   @map("routing_type") @db.VarChar(50)
  targetNumber  String?  @map("target_number") @db.VarChar(20)
  targetGroupId String?  @map("target_group_id") @db.VarChar(36)
  isActive      Boolean  @default(true) @map("is_active")
  createdAt     DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("call_routing_rule")
}

model CallDTMFInteraction {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  sessionId    String   @map("session_id") @db.VarChar(36)
  dtmfSequence String   @map("dtmf_sequence") @db.VarChar(50)
  action       String   @db.VarChar(100)
  timestamp    DateTime @default(now())

  @@index([tenantId])
  @@index([sessionId])
  @@map("call_dtmf_interaction")
}

model IVRMenu {
  id           String          @id @db.Char(36)
  tenantId     String          @map("tenant_id") @db.VarChar(36)
  menuName     String          @map("menu_name") @db.VarChar(100)
  prompt       String          @db.Text
  recordingUrl String?         @map("recording_url") @db.VarChar(500)
  isActive     Boolean         @default(true) @map("is_active")
  createdAt    DateTime        @default(now()) @map("created_at")
  options      IVRMenuOption[]

  @@index([tenantId])
  @@map("ivr_menu")
}

model IVRMenuOption {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  menuId      String   @map("menu_id") @db.VarChar(36)
  optionKey   String   @map("option_key") @db.VarChar(10)
  optionLabel String   @map("option_label") @db.VarChar(255)
  actionType  String   @map("action_type") @db.VarChar(50)
  actionValue String?  @map("action_value") @db.VarChar(255)
  createdAt   DateTime @default(now()) @map("created_at")
  menu        IVRMenu  @relation(fields: [menuId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("ivr_menu_option")
}

model AIModel {
  id           String    @id @db.Char(36)
  tenantId     String    @map("tenant_id") @db.VarChar(36)
  modelName    String    @map("model_name") @db.VarChar(255)
  modelVersion String    @map("model_version") @db.VarChar(50)
  modelType    String    @map("model_type") @db.VarChar(50)
  description  String?   @db.Text
  accuracy     Decimal?  @db.Decimal(5, 2)
  trainingDate DateTime? @map("training_date") @db.Date
  isActive     Boolean   @default(true) @map("is_active")
  createdAt    DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("ai_model")
}

model AIInteraction {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  sessionId      String   @map("session_id") @db.VarChar(36)
  modelId        String?  @map("model_id") @db.VarChar(36)
  input          String?  @db.LongText
  output         String?  @db.LongText
  confidence     Decimal? @db.Decimal(5, 2)
  processingTime Int?     @map("processing_time")
  createdAt      DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([sessionId])
  @@map("ai_interaction")
}

model TeamChatChannel {
  id          String            @id @db.Char(36)
  tenantId    String            @map("tenant_id") @db.VarChar(36)
  channelName String            @map("channel_name") @db.VarChar(100)
  channelType String            @map("channel_type") @db.VarChar(50)
  isPublic    Boolean           @default(true) @map("is_public")
  description String?           @db.Text
  createdBy   String?           @map("created_by") @db.VarChar(36)
  createdAt   DateTime          @default(now()) @map("created_at")
  members     TeamChatMember[]
  messages    TeamChatMessage[]

  @@index([tenantId])
  @@map("team_chat_channel")
}

model TeamChatMember {
  id        String          @id @db.Char(36)
  tenantId  String          @map("tenant_id") @db.VarChar(36)
  channelId String          @map("channel_id") @db.VarChar(36)
  userId    String          @map("user_id") @db.Char(36)
  role      String          @db.VarChar(50)
  joinedAt  DateTime        @default(now()) @map("joined_at")
  channel   TeamChatChannel @relation(fields: [channelId], references: [id], onDelete: Cascade)

  @@unique([channelId, userId])
  @@index([tenantId])
  @@map("team_chat_member")
}

model TeamChatMessage {
  id          String             @id @db.Char(36)
  tenantId    String             @map("tenant_id") @db.VarChar(36)
  channelId   String             @map("channel_id") @db.VarChar(36)
  senderId    String             @map("sender_id") @db.Char(36)
  message     String?            @db.LongText
  attachments Json?              @map("attachments")
  editedAt    DateTime?          @map("edited_at")
  deletedAt   DateTime?          @map("deleted_at")
  createdAt   DateTime           @default(now()) @map("created_at")
  channel     TeamChatChannel    @relation(fields: [channelId], references: [id], onDelete: Cascade)
  reactions   TeamChatReaction[]

  @@index([tenantId])
  @@index([channelId])
  @@map("team_chat_message")
}

model TeamChatReaction {
  id        String          @id @db.Char(36)
  tenantId  String          @map("tenant_id") @db.VarChar(36)
  messageId String          @map("message_id") @db.VarChar(36)
  userId    String          @map("user_id") @db.Char(36)
  emoji     String          @db.VarChar(10)
  createdAt DateTime        @default(now()) @map("created_at")
  message   TeamChatMessage @relation(fields: [messageId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("team_chat_reaction")
}

model VoiceVideoCall {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  sessionId      String    @unique @map("session_id") @db.VarChar(100)
  initiatorId    String    @map("initiator_id") @db.Char(36)
  participantIds String    @map("participant_ids") @db.Text
  callType       String    @map("call_type") @db.VarChar(50)
  status         String    @db.VarChar(50)
  startTime      DateTime  @map("start_time")
  endTime        DateTime? @map("end_time")
  duration       Int       @default(0)
  recordingUrl   String?   @map("recording_url") @db.VarChar(500)
  createdAt      DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([sessionId])
  @@map("voice_video_call")
}

model Meeting {
  id               String    @id @db.Char(36)
  tenantId         String    @map("tenant_id") @db.VarChar(36)
  meetingTitle     String    @map("meeting_title") @db.VarChar(255)
  meetingStartTime DateTime  @map("meeting_start_time")
  meetingEndTime   DateTime? @map("meeting_end_time")
  organizerId      String    @map("organizer_id") @db.Char(36)
  participantIds   String?   @map("participant_ids") @db.Text
  description      String?   @db.Text
  location         String?   @db.VarChar(255)
  status           String    @db.VarChar(50)
  recordingUrl     String?   @map("recording_url") @db.VarChar(500)
  createdAt        DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([organizerId])
  @@map("meeting")
}

model WorkItem {
  id             String            @id @db.Char(36)
  tenantId       String            @map("tenant_id") @db.VarChar(36)
  title          String            @db.VarChar(255)
  description    String?           @db.LongText
  assignedTo     String?           @map("assigned_to") @db.Char(36)
  status         String            @db.VarChar(50)
  priority       String            @db.VarChar(50)
  dueDate        DateTime?         @map("due_date") @db.Date
  completionDate DateTime?         @map("completion_date")
  createdBy      String?           @map("created_by") @db.Char(36)
  createdAt      DateTime          @default(now()) @map("created_at")
  comments       WorkItemComment[]

  @@index([tenantId])
  @@index([status])
  @@map("work_item")
}

model WorkItemComment {
  id         String   @id @db.Char(36)
  tenantId   String   @map("tenant_id") @db.VarChar(36)
  workItemId String   @map("work_item_id") @db.VarChar(36)
  userId     String   @map("user_id") @db.Char(36)
  comment    String   @db.LongText
  createdAt  DateTime @default(now()) @map("created_at")
  workItem   WorkItem @relation(fields: [workItemId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("work_item_comment")
}

model Notification {
  id         String    @id @db.Char(36)
  tenantId   String    @map("tenant_id") @db.VarChar(36)
  userId     String    @map("user_id") @db.Char(36)
  title      String    @db.VarChar(255)
  message    String?   @db.LongText
  type       String    @db.VarChar(50)
  entityId   String?   @map("entity_id") @db.VarChar(36)
  entityType String?   @map("entity_type") @db.VarChar(100)
  isRead     Boolean   @default(false) @map("is_read")
  readAt     DateTime? @map("read_at")
  createdAt  DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@index([userId])
  @@index([isRead])
  @@map("notification")
}

model TaskAssignment {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  workItemId     String    @map("work_item_id") @db.VarChar(36)
  assignedTo     String    @map("assigned_to") @db.Char(36)
  assignedBy     String    @map("assigned_by") @db.Char(36)
  assignmentDate DateTime  @map("assignment_date")
  dueDate        DateTime? @map("due_date") @db.Date
  priority       String    @db.VarChar(50)
  createdAt      DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("task_assignment")
}

model ProjectTimeline {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  projectId      String    @map("project_id") @db.VarChar(36)
  milestone      String    @db.VarChar(255)
  targetDate     DateTime  @map("target_date") @db.Date
  completionDate DateTime? @map("completion_date") @db.Date
  status         String    @db.VarChar(50)
  createdAt      DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("project_timeline")
}

model TeamMeetingNotes {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  meetingId   String   @map("meeting_id") @db.VarChar(36)
  notes       String?  @db.LongText
  actionItems String?  @map("action_items") @db.Text
  attendees   String?  @db.Text
  createdBy   String?  @map("created_by") @db.Char(36)
  createdAt   DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("team_meeting_notes")
}

model FixedAsset {
  id                    String                 @id @db.Char(36)
  tenantId              String                 @map("tenant_id") @db.VarChar(36)
  assetCode             String                 @unique @map("asset_code") @db.VarChar(50)
  assetName             String                 @map("asset_name") @db.VarChar(255)
  assetCategory         String                 @map("asset_category") @db.VarChar(100)
  acquisitionDate       DateTime               @map("acquisition_date") @db.Date
  acquisitionCost       Decimal                @map("acquisition_cost") @db.Decimal(15, 2)
  currentValue          Decimal                @map("current_value") @db.Decimal(15, 2)
  location              String?                @db.VarChar(255)
  status                String                 @default("active") @db.VarChar(50)
  usefulLife            Int?                   @map("useful_life")
  createdAt             DateTime               @default(now()) @map("created_at")
  depreciationSchedules DepreciationSchedule[]

  @@index([tenantId])
  @@index([assetCode])
  @@map("fixed_asset")
}

model DepreciationSchedule {
  id                 String     @id @db.Char(36)
  tenantId           String     @map("tenant_id") @db.VarChar(36)
  assetId            String     @map("asset_id") @db.VarChar(36)
  period             String     @db.VarChar(50)
  openingValue       Decimal    @map("opening_value") @db.Decimal(15, 2)
  depreciationRate   Decimal    @map("depreciation_rate") @db.Decimal(5, 2)
  depreciationAmount Decimal    @map("depreciation_amount") @db.Decimal(15, 2)
  closingValue       Decimal    @map("closing_value") @db.Decimal(15, 2)
  createdAt          DateTime   @default(now()) @map("created_at")
  asset              FixedAsset @relation(fields: [assetId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("depreciation_schedule")
}

model AssetRevaluation {
  id                  String   @id @db.Char(36)
  tenantId            String   @map("tenant_id") @db.VarChar(36)
  assetId             String   @map("asset_id") @db.VarChar(36)
  revaluationDate     DateTime @map("revaluation_date") @db.Date
  previousValue       Decimal  @map("previous_value") @db.Decimal(15, 2)
  newValue            Decimal  @map("new_value") @db.Decimal(15, 2)
  revaluationGainLoss Decimal  @map("revaluation_gain_loss") @db.Decimal(15, 2)
  reason              String?  @db.Text
  createdBy           String?  @map("created_by") @db.VarChar(36)
  createdAt           DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("asset_revaluation")
}

model AssetDisposal {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  assetId        String   @map("asset_id") @db.VarChar(36)
  disposalDate   DateTime @map("disposal_date") @db.Date
  disposalMethod String   @map("disposal_method") @db.VarChar(50)
  disposalPrice  Decimal  @map("disposal_price") @db.Decimal(15, 2)
  bookValue      Decimal  @map("book_value") @db.Decimal(15, 2)
  gainLoss       Decimal  @map("gain_loss") @db.Decimal(15, 2)
  approvedBy     String?  @map("approved_by") @db.VarChar(36)
  createdAt      DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("asset_disposal")
}

model AssetMaintenance {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  assetId         String   @map("asset_id") @db.VarChar(36)
  maintenanceType String   @map("maintenance_type") @db.VarChar(50)
  maintenanceDate DateTime @map("maintenance_date") @db.Date
  cost            Decimal  @db.Decimal(15, 2)
  vendor          String?  @db.VarChar(255)
  notes           String?  @db.Text
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("asset_maintenance")
}

model AssetTransfer {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  assetId      String   @map("asset_id") @db.VarChar(36)
  transferDate DateTime @map("transfer_date") @db.Date
  fromLocation String   @map("from_location") @db.VarChar(255)
  toLocation   String   @map("to_location") @db.VarChar(255)
  reason       String?  @db.Text
  approvedBy   String?  @map("approved_by") @db.VarChar(36)
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("asset_transfer")
}

model CostCenter {
  id                 String           @id @db.Char(36)
  tenantId           String           @map("tenant_id") @db.VarChar(36)
  costCenterCode     String           @unique @map("cost_center_code") @db.VarChar(50)
  costCenterName     String           @map("cost_center_name") @db.VarChar(255)
  department         String?          @db.VarChar(100)
  parentCostCenterId String?          @map("parent_cost_center_id") @db.VarChar(36)
  manager            String?          @db.VarChar(36)
  status             String           @default("active") @db.VarChar(50)
  createdAt          DateTime         @default(now()) @map("created_at")
  costAllocations    CostAllocation[]
  budgets            Budget[]

  @@index([tenantId])
  @@map("cost_center")
}

model CostAllocation {
  id               String     @id @db.Char(36)
  tenantId         String     @map("tenant_id") @db.VarChar(36)
  costCenterId     String     @map("cost_center_id") @db.VarChar(36)
  glAccountId      String     @map("gl_account_id") @db.VarChar(36)
  amount           Decimal    @db.Decimal(15, 2)
  percentage       Decimal    @db.Decimal(5, 2)
  allocationMethod String     @map("allocation_method") @db.VarChar(50)
  createdAt        DateTime   @default(now()) @map("created_at")
  costCenter       CostCenter @relation(fields: [costCenterId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("cost_allocation")
}

model Budget {
  id              String     @id @db.Char(36)
  tenantId        String     @map("tenant_id") @db.VarChar(36)
  budgetCode      String     @unique @map("budget_code") @db.VarChar(50)
  budgetName      String     @map("budget_name") @db.VarChar(255)
  costCenterId    String     @map("cost_center_id") @db.VarChar(36)
  fiscalYear      Int        @map("fiscal_year")
  budgetPeriod    String     @map("budget_period") @db.VarChar(20)
  budgetedAmount  Decimal    @map("budgeted_amount") @db.Decimal(15, 2)
  actualAmount    Decimal    @default(0) @map("actual_amount") @db.Decimal(15, 2)
  committedAmount Decimal    @default(0) @map("committed_amount") @db.Decimal(15, 2)
  availableAmount Decimal    @map("available_amount") @db.Decimal(15, 2)
  status          String     @default("active") @db.VarChar(50)
  createdAt       DateTime   @default(now()) @map("created_at")
  costCenter      CostCenter @relation(fields: [costCenterId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("budget")
}

model BudgetVariance {
  id                 String   @id @db.Char(36)
  tenantId           String   @map("tenant_id") @db.VarChar(36)
  budgetId           String   @map("budget_id") @db.VarChar(36)
  variancePeriod     String   @map("variance_period") @db.VarChar(20)
  budgetedAmount     Decimal  @map("budgeted_amount") @db.Decimal(15, 2)
  actualAmount       Decimal  @map("actual_amount") @db.Decimal(15, 2)
  varianceAmount     Decimal  @map("variance_amount") @db.Decimal(15, 2)
  variancePercentage Decimal  @map("variance_percentage") @db.Decimal(5, 2)
  varianceType       String   @map("variance_type") @db.VarChar(20)
  createdAt          DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("budget_variance")
}

model BudgetAllocation {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  budgetId        String   @map("budget_id") @db.VarChar(36)
  glAccountId     String   @map("gl_account_id") @db.VarChar(36)
  allocatedAmount Decimal  @map("allocated_amount") @db.Decimal(15, 2)
  spentAmount     Decimal  @default(0) @map("spent_amount") @db.Decimal(15, 2)
  remainingAmount Decimal  @map("remaining_amount") @db.Decimal(15, 2)
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("budget_allocation")
}

model BudgetApproval {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  budgetId     String   @map("budget_id") @db.VarChar(36)
  approvedBy   String   @map("approved_by") @db.VarChar(36)
  approvalDate DateTime @map("approval_date") @db.Date
  comments     String?  @db.Text
  status       String   @db.VarChar(50)
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("budget_approval")
}

model Dashboard {
  id              String            @id @db.Char(36)
  tenantId        String            @map("tenant_id") @db.VarChar(36)
  dashboardName   String            @map("dashboard_name") @db.VarChar(255)
  dashboardType   String            @map("dashboard_type") @db.VarChar(100)
  createdBy       String            @map("created_by") @db.VarChar(36)
  isPublic        Boolean           @default(false) @map("is_public")
  refreshInterval Int?              @map("refresh_interval")
  status          String            @default("active") @db.VarChar(50)
  createdAt       DateTime          @default(now()) @map("created_at")
  widgets         DashboardWidget[]

  @@index([tenantId])
  @@map("dashboard")
}

model DashboardWidget {
  id              String    @id @db.Char(36)
  tenantId        String    @map("tenant_id") @db.VarChar(36)
  dashboardId     String    @map("dashboard_id") @db.VarChar(36)
  widgetName      String    @map("widget_name") @db.VarChar(255)
  widgetType      String    @map("widget_type") @db.VarChar(100)
  position        Int
  size            String    @db.VarChar(50)
  configuration   String?   @db.LongText
  refreshInterval Int?      @map("refresh_interval")
  createdAt       DateTime  @default(now()) @map("created_at")
  dashboard       Dashboard @relation(fields: [dashboardId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("dashboard_widget")
}

model KPIDefinition {
  id          String     @id @db.Char(36)
  tenantId    String     @map("tenant_id") @db.VarChar(36)
  kpiCode     String     @unique @map("kpi_code") @db.VarChar(100)
  kpiName     String     @map("kpi_name") @db.VarChar(255)
  kpiCategory String     @map("kpi_category") @db.VarChar(100)
  description String?    @db.Text
  formula     String     @db.LongText
  targetValue Decimal?   @map("target_value") @db.Decimal(15, 4)
  minValue    Decimal?   @map("min_value") @db.Decimal(15, 4)
  maxValue    Decimal?   @map("max_value") @db.Decimal(15, 4)
  unit        String     @db.VarChar(50)
  frequency   String     @db.VarChar(50)
  owner       String?    @db.VarChar(36)
  status      String     @default("active") @db.VarChar(50)
  createdAt   DateTime   @default(now()) @map("created_at")
  values      KPIValue[]

  @@index([tenantId])
  @@map("kpi_definition")
}

model KPIValue {
  id          String        @id @db.Char(36)
  tenantId    String        @map("tenant_id") @db.VarChar(36)
  kpiId       String        @map("kpi_id") @db.VarChar(36)
  valueDate   DateTime      @map("value_date") @db.Date
  actualValue Decimal       @map("actual_value") @db.Decimal(15, 4)
  targetValue Decimal?      @map("target_value") @db.Decimal(15, 4)
  variance    Decimal?      @db.Decimal(15, 4)
  status      String        @default("normal") @db.VarChar(50)
  trend       String?       @db.VarChar(50)
  createdAt   DateTime      @default(now()) @map("created_at")
  kpi         KPIDefinition @relation(fields: [kpiId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("kpi_value")
}

model Report {
  id          String            @id @db.Char(36)
  tenantId    String            @map("tenant_id") @db.VarChar(36)
  reportCode  String            @unique @map("report_code") @db.VarChar(100)
  reportName  String            @map("report_name") @db.VarChar(255)
  reportType  String            @map("report_type") @db.VarChar(100)
  description String?           @db.Text
  query       String            @db.LongText
  schedule    String?           @db.VarChar(100)
  lastRunDate DateTime?         @map("last_run_date")
  nextRunDate DateTime?         @map("next_run_date")
  owner       String?           @db.VarChar(36)
  isPublished Boolean           @default(false) @map("is_published")
  status      String            @default("active") @db.VarChar(50)
  createdAt   DateTime          @default(now()) @map("created_at")
  executions  ReportExecution[]

  @@index([tenantId])
  @@map("report")
}

model ReportExecution {
  id            String   @id @db.Char(36)
  tenantId      String   @map("tenant_id") @db.VarChar(36)
  reportId      String   @map("report_id") @db.VarChar(36)
  executedBy    String   @map("executed_by") @db.VarChar(36)
  executionDate DateTime @map("execution_date") @db.DateTime
  executionTime Int      @map("execution_time")
  recordCount   Int      @default(0) @map("record_count")
  outputFile    String?  @map("output_file") @db.VarChar(255)
  status        String   @db.VarChar(50)
  errorMessage  String?  @map("error_message") @db.Text
  createdAt     DateTime @default(now()) @map("created_at")
  report        Report   @relation(fields: [reportId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("report_execution")
}

model AnalyticsDataCache {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  entityType      String   @map("entity_type") @db.VarChar(100)
  period          String   @db.VarChar(50)
  dimensionValues String?  @map("dimension_values") @db.LongText
  metricName      String   @map("metric_name") @db.VarChar(255)
  metricValue     Decimal  @map("metric_value") @db.Decimal(15, 4)
  lastUpdated     DateTime @map("last_updated") @db.DateTime
  expiryDate      DateTime @map("expiry_date") @db.Date
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("analytics_data_cache")
}

model CustomReport {
  id         String   @id @db.Char(36)
  tenantId   String   @map("tenant_id") @db.VarChar(36)
  reportName String   @map("report_name") @db.VarChar(255)
  createdBy  String   @map("created_by") @db.VarChar(36)
  columns    String   @db.LongText
  filters    String?  @db.LongText
  groupBy    String?  @map("group_by") @db.LongText
  orderBy    String?  @map("order_by") @db.LongText
  format     String   @default("pdf") @db.VarChar(50)
  isPublic   Boolean  @default(false) @map("is_public")
  createdAt  DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("custom_report")
}

model ReportSchedule {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  reportId        String   @map("report_id") @db.VarChar(36)
  frequency       String   @db.VarChar(50)
  dayOfWeek       Int?     @map("day_of_week")
  dayOfMonth      Int?     @map("day_of_month")
  hour            Int
  minute          Int
  emailRecipients String?  @map("email_recipients") @db.Text
  isActive        Boolean  @default(true) @map("is_active")
  nextRunDate     DateTime @map("next_run_date") @db.DateTime
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("report_schedule")
}

model AnalyticsEvent {
  id         String   @id @db.Char(36)
  tenantId   String   @map("tenant_id") @db.VarChar(36)
  eventType  String   @map("event_type") @db.VarChar(100)
  entityType String   @map("entity_type") @db.VarChar(100)
  entityId   String?  @map("entity_id") @db.VarChar(36)
  userId     String?  @map("user_id") @db.VarChar(36)
  eventData  String?  @map("event_data") @db.LongText
  timestamp  DateTime @db.DateTime
  createdAt  DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("analytics_event")
}

model MobileDevice {
  id                String                   @id @db.Char(36)
  tenantId          String                   @map("tenant_id") @db.VarChar(36)
  userId            String                   @map("user_id") @db.VarChar(36)
  deviceId          String                   @unique @map("device_id") @db.VarChar(255)
  deviceType        String                   @map("device_type") @db.VarChar(50)
  osType            String                   @map("os_type") @db.VarChar(50)
  osVersion         String?                  @map("os_version") @db.VarChar(50)
  appVersion        String?                  @map("app_version") @db.VarChar(50)
  pushToken         String?                  @map("push_token") @db.Text
  deviceModel       String?                  @map("device_model") @db.VarChar(100)
  manufacturer      String?                  @db.VarChar(100)
  isActive          Boolean                  @default(true) @map("is_active")
  lastActiveAt      DateTime                 @map("last_active_at") @db.DateTime
  createdAt         DateTime                 @default(now()) @map("created_at")
  sessions          MobileSession[]
  pushNotifications MobilePushNotification[]

  @@index([tenantId])
  @@map("mobile_device")
}

model MobileSession {
  id           String       @id @db.Char(36)
  tenantId     String       @map("tenant_id") @db.VarChar(36)
  deviceId     String       @map("device_id") @db.VarChar(36)
  userId       String       @map("user_id") @db.VarChar(36)
  sessionToken String       @unique(map: "idx_mobile_session_token") @map("session_token") @db.VarChar(500)
  loginTime    DateTime     @map("login_time") @db.DateTime
  logoutTime   DateTime?    @map("logout_time") @db.DateTime
  ipAddress    String?      @map("ip_address") @db.VarChar(45)
  userAgent    String?      @map("user_agent") @db.Text
  isActive     Boolean      @default(true) @map("is_active")
  createdAt    DateTime     @default(now()) @map("created_at")
  device       MobileDevice @relation(fields: [deviceId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("mobile_session")
}

model MobilePushNotification {
  id               String       @id @db.Char(36)
  tenantId         String       @map("tenant_id") @db.VarChar(36)
  deviceId         String       @map("device_id") @db.VarChar(36)
  title            String       @db.VarChar(255)
  body             String       @db.Text
  notificationType String       @map("notification_type") @db.VarChar(100)
  entityType       String?      @map("entity_type") @db.VarChar(100)
  entityId         String?      @map("entity_id") @db.VarChar(36)
  payload          String?      @db.LongText
  sentAt           DateTime     @map("sent_at") @db.DateTime
  deliveredAt      DateTime?    @map("delivered_at") @db.DateTime
  openedAt         DateTime?    @map("opened_at") @db.DateTime
  status           String       @default("pending") @db.VarChar(50)
  createdAt        DateTime     @default(now()) @map("created_at")
  device           MobileDevice @relation(fields: [deviceId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("mobile_push_notification")
}

model MobileAppUpdate {
  id               String   @id @db.Char(36)
  tenantId         String   @map("tenant_id") @db.VarChar(36)
  versionNumber    String   @map("version_number") @db.VarChar(50)
  releaseNotes     String?  @map("release_notes") @db.LongText
  downloadUrl      String   @map("download_url") @db.Text
  minimumOsVersion String?  @map("minimum_os_version") @db.VarChar(50)
  forceUpdate      Boolean  @default(false) @map("force_update")
  releaseDate      DateTime @map("release_date") @db.Date
  status           String   @db.VarChar(50)
  downloadCount    Int      @default(0) @map("download_count")
  createdAt        DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("mobile_app_update")
}

model MobileOfflineData {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  deviceId     String   @map("device_id") @db.VarChar(36)
  entityType   String   @map("entity_type") @db.VarChar(100)
  entityId     String   @map("entity_id") @db.VarChar(36)
  dataSnapshot String   @map("data_snapshot") @db.LongText
  lastSyncedAt DateTime @map("last_synced_at") @db.DateTime
  syncRequired Boolean  @default(false) @map("sync_required")
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("mobile_offline_data")
}

model MobileAppConfig {
  id          String   @id @db.Char(36)
  tenantId    String   @map("tenant_id") @db.VarChar(36)
  configKey   String   @map("config_key") @db.VarChar(255)
  configValue String   @map("config_value") @db.LongText
  configType  String   @map("config_type") @db.VarChar(100)
  description String?  @db.Text
  updatedBy   String?  @map("updated_by") @db.VarChar(36)
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@index([tenantId])
  @@map("mobile_app_config")
}

model MobileAnalytics {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  deviceId        String   @map("device_id") @db.VarChar(36)
  screenName      String   @map("screen_name") @db.VarChar(255)
  eventName       String   @map("event_name") @db.VarChar(255)
  eventValue      String?  @map("event_value") @db.LongText
  sessionDuration Int?     @map("session_duration")
  crashReported   Boolean  @default(false) @map("crash_reported")
  timestamp       DateTime @db.DateTime
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("mobile_analytics")
}

model ConstructionProject {
  id                 String                     @id @db.Char(36)
  tenantId           String                     @map("tenant_id") @db.VarChar(36)
  projectCode        String                     @unique @map("project_code") @db.VarChar(50)
  projectName        String                     @map("project_name") @db.VarChar(255)
  location           String                     @db.Text
  projectManager     String?                    @map("project_manager") @db.VarChar(36)
  startDate          DateTime                   @map("start_date") @db.Date
  completionDate     DateTime?                  @map("completion_date") @db.Date
  estimatedBudget    Decimal                    @map("estimated_budget") @db.Decimal(15, 2)
  actualBudget       Decimal                    @default(0) @map("actual_budget") @db.Decimal(15, 2)
  status             String                     @default("planning") @db.VarChar(50)
  percentageComplete Decimal                    @default(0) @map("percentage_complete") @db.Decimal(5, 2)
  createdAt          DateTime                   @default(now()) @map("created_at")
  phases             ConstructionPhase[]
  materials          ConstructionMaterial[]
  laborEntries       ConstructionLabor[]
  equipment          ConstructionEquipment[]
  qualityChecks      ConstructionQualityCheck[]
  safetyIncidents    ConstructionSafety[]
  siteVisits         SiteVisit[]

  @@index([tenantId])
  @@map("construction_project")
}

model ConstructionPhase {
  id              String              @id @db.Char(36)
  tenantId        String              @map("tenant_id") @db.VarChar(36)
  projectId       String              @map("project_id") @db.VarChar(36)
  phaseName       String              @map("phase_name") @db.VarChar(255)
  description     String?             @db.Text
  startDate       DateTime            @map("start_date") @db.Date
  expectedEndDate DateTime            @map("expected_end_date") @db.Date
  actualEndDate   DateTime?           @map("actual_end_date") @db.Date
  budgetedAmount  Decimal             @map("budgeted_amount") @db.Decimal(15, 2)
  actualAmount    Decimal             @default(0) @map("actual_amount") @db.Decimal(15, 2)
  status          String              @default("not_started") @db.VarChar(50)
  sequence        Int
  createdAt       DateTime            @default(now()) @map("created_at")
  project         ConstructionProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("construction_phase")
}

model ConstructionMaterial {
  id               String              @id @db.Char(36)
  tenantId         String              @map("tenant_id") @db.VarChar(36)
  projectId        String              @map("project_id") @db.VarChar(36)
  materialCode     String              @map("material_code") @db.VarChar(100)
  materialName     String              @map("material_name") @db.VarChar(255)
  quantity         Decimal             @db.Decimal(18, 4)
  unit             String              @db.VarChar(50)
  unitCost         Decimal             @map("unit_cost") @db.Decimal(15, 2)
  totalCost        Decimal             @map("total_cost") @db.Decimal(15, 2)
  supplier         String?             @db.VarChar(255)
  deliveryDate     DateTime            @map("delivery_date") @db.Date
  receivedQuantity Decimal             @default(0) @map("received_quantity") @db.Decimal(18, 4)
  wastageQuantity  Decimal             @default(0) @map("wastage_quantity") @db.Decimal(18, 4)
  status           String              @default("pending") @db.VarChar(50)
  createdAt        DateTime            @default(now()) @map("created_at")
  project          ConstructionProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("construction_material")
}

model ConstructionLabor {
  id             String              @id @db.Char(36)
  tenantId       String              @map("tenant_id") @db.VarChar(36)
  projectId      String              @map("project_id") @db.VarChar(36)
  laborDate      DateTime            @map("labor_date") @db.Date
  laborType      String              @map("labor_type") @db.VarChar(100)
  workers        Int
  hoursPerWorker Decimal             @map("hours_per_worker") @db.Decimal(5, 2)
  ratePerHour    Decimal             @map("rate_per_hour") @db.Decimal(10, 2)
  totalCost      Decimal             @map("total_cost") @db.Decimal(15, 2)
  supervisor     String?             @db.VarChar(36)
  notes          String?             @db.Text
  createdAt      DateTime            @default(now()) @map("created_at")
  project        ConstructionProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("construction_labor")
}

model ConstructionEquipment {
  id             String              @id @db.Char(36)
  tenantId       String              @map("tenant_id") @db.VarChar(36)
  projectId      String              @map("project_id") @db.VarChar(36)
  equipmentCode  String              @unique @map("equipment_code") @db.VarChar(100)
  equipmentName  String              @map("equipment_name") @db.VarChar(255)
  equipmentType  String              @map("equipment_type") @db.VarChar(100)
  allocationDate DateTime            @map("allocation_date") @db.Date
  releaseDate    DateTime?           @map("release_date") @db.Date
  dailyCost      Decimal             @map("daily_cost") @db.Decimal(15, 2)
  totalCost      Decimal             @default(0) @map("total_cost") @db.Decimal(15, 2)
  status         String              @default("allocated") @db.VarChar(50)
  createdAt      DateTime            @default(now()) @map("created_at")
  project        ConstructionProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("construction_equipment")
}

model ConstructionQualityCheck {
  id             String              @id @db.Char(36)
  tenantId       String              @map("tenant_id") @db.VarChar(36)
  projectId      String              @map("project_id") @db.VarChar(36)
  checkDate      DateTime            @map("check_date") @db.Date
  checkType      String              @map("check_type") @db.VarChar(100)
  checkedBy      String              @map("checked_by") @db.VarChar(36)
  area           String              @db.VarChar(255)
  findings       String?             @db.LongText
  status         String              @db.VarChar(50)
  passedCriteria Int                 @map("passed_criteria")
  totalCriteria  Int                 @map("total_criteria")
  nextCheckDate  DateTime?           @map("next_check_date") @db.Date
  createdAt      DateTime            @default(now()) @map("created_at")
  project        ConstructionProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("construction_quality_check")
}

model ConstructionSafety {
  id                    String              @id @db.Char(36)
  tenantId              String              @map("tenant_id") @db.VarChar(36)
  projectId             String              @map("project_id") @db.VarChar(36)
  incidentDate          DateTime            @map("incident_date") @db.Date
  incidentType          String              @map("incident_type") @db.VarChar(100)
  severity              String              @db.VarChar(50)
  description           String              @db.LongText
  reportedBy            String              @map("reported_by") @db.VarChar(36)
  affectedWorkers       Int?                @map("affected_workers")
  lostDays              Int?                @map("lost_days")
  investigationRequired Boolean             @default(false) @map("investigation_required")
  status                String              @default("reported") @db.VarChar(50)
  createdAt             DateTime            @default(now()) @map("created_at")
  project               ConstructionProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("construction_safety")
}

model SiteVisit {
  id              String              @id @db.Char(36)
  tenantId        String              @map("tenant_id") @db.VarChar(36)
  projectId       String              @map("project_id") @db.VarChar(36)
  visitDate       DateTime            @map("visit_date") @db.Date
  visitedBy       String              @map("visited_by") @db.VarChar(36)
  purpose         String              @db.Text
  observations    String?             @db.LongText
  photographs     String?             @db.LongText
  actionsRequired String?             @map("actions_required") @db.LongText
  status          String              @default("completed") @db.VarChar(50)
  createdAt       DateTime            @default(now()) @map("created_at")
  project         ConstructionProject @relation(fields: [projectId], references: [id], onDelete: Cascade)

  @@index([tenantId])
  @@map("site_visit")
}

model CustomFieldDefinition {
  id             String   @id @db.Char(36)
  tenantId       String   @map("tenant_id") @db.VarChar(36)
  fieldName      String   @map("field_name") @db.VarChar(255)
  fieldCode      String   @map("field_code") @db.VarChar(100)
  entityType     String   @map("entity_type") @db.VarChar(100)
  fieldType      String   @map("field_type") @db.VarChar(50)
  fieldLength    Int?     @map("field_length")
  isRequired     Boolean  @default(false) @map("is_required")
  isUnique       Boolean  @default(false) @map("is_unique")
  defaultValue   String?  @map("default_value") @db.Text
  validationRule String?  @map("validation_rule") @db.Text
  displayOrder   Int      @map("display_order")
  helpText       String?  @map("help_text") @db.Text
  status         String   @default("active") @db.VarChar(50)
  createdAt      DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("custom_field_definition")
}

model CustomFieldValue {
  id                String   @id @db.Char(36)
  tenantId          String   @map("tenant_id") @db.VarChar(36)
  fieldDefinitionId String   @map("field_definition_id") @db.VarChar(36)
  entityType        String   @map("entity_type") @db.VarChar(100)
  entityId          String   @map("entity_id") @db.VarChar(36)
  fieldValue        String?  @map("field_value") @db.LongText
  createdAt         DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("custom_field_value")
}

model MultiLanguageResource {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  resourceKey     String   @map("resource_key") @db.VarChar(255)
  language        String   @db.VarChar(10)
  resourceValue   String   @map("resource_value") @db.LongText
  resourceContext String?  @map("resource_context") @db.VarChar(100)
  lastUpdated     DateTime @map("last_updated") @db.DateTime
  createdAt       DateTime @default(now()) @map("created_at")

  @@unique([resourceKey, language, tenantId])
  @@index([tenantId])
  @@map("multi_language_resource")
}

model DataImportTemplate {
  id              String   @id @db.Char(36)
  tenantId        String   @map("tenant_id") @db.VarChar(36)
  templateName    String   @map("template_name") @db.VarChar(255)
  templateCode    String   @unique @map("template_code") @db.VarChar(100)
  entityType      String   @map("entity_type") @db.VarChar(100)
  fileFormat      String   @map("file_format") @db.VarChar(50)
  columnMapping   String   @map("column_mapping") @db.LongText
  validationRules String?  @map("validation_rules") @db.LongText
  transformations String?  @db.LongText
  createdBy       String   @map("created_by") @db.VarChar(36)
  isPublished     Boolean  @default(false) @map("is_published")
  createdAt       DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("data_import_template")
}

model DataImportJob {
  id             String    @id @db.Char(36)
  tenantId       String    @map("tenant_id") @db.VarChar(36)
  templateId     String    @map("template_id") @db.VarChar(36)
  fileName       String    @map("file_name") @db.VarChar(255)
  filePath       String    @map("file_path") @db.Text
  uploadedBy     String    @map("uploaded_by") @db.VarChar(36)
  totalRecords   Int       @default(0) @map("total_records")
  successCount   Int       @default(0) @map("success_count")
  errorCount     Int       @default(0) @map("error_count")
  status         String    @default("pending") @db.VarChar(50)
  errorLog       String?   @map("error_log") @db.LongText
  startTime      DateTime? @map("start_time") @db.DateTime
  completionTime DateTime? @map("completion_time") @db.DateTime
  createdAt      DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("data_import_job")
}

model DataExportTemplate {
  id           String   @id @db.Char(36)
  tenantId     String   @map("tenant_id") @db.VarChar(36)
  templateName String   @map("template_name") @db.VarChar(255)
  templateCode String   @unique @map("template_code") @db.VarChar(100)
  entityType   String   @map("entity_type") @db.VarChar(100)
  columns      String   @db.LongText
  filters      String?  @db.LongText
  sortOrder    String?  @map("sort_order") @db.LongText
  fileFormat   String   @map("file_format") @db.VarChar(50)
  createdBy    String   @map("created_by") @db.VarChar(36)
  isPublished  Boolean  @default(false) @map("is_published")
  createdAt    DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("data_export_template")
}

model DataExportJob {
  id              String    @id @db.Char(36)
  tenantId        String    @map("tenant_id") @db.VarChar(36)
  templateId      String    @map("template_id") @db.VarChar(36)
  requestedBy     String    @map("requested_by") @db.VarChar(36)
  totalRecords    Int       @default(0) @map("total_records")
  exportedRecords Int       @default(0) @map("exported_records")
  status          String    @default("pending") @db.VarChar(50)
  fileLocation    String?   @map("file_location") @db.Text
  downloadUrl     String?   @map("download_url") @db.Text
  expiryDate      DateTime? @map("expiry_date") @db.Date
  startTime       DateTime? @map("start_time") @db.DateTime
  completionTime  DateTime? @map("completion_time") @db.DateTime
  createdAt       DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("data_export_job")
}

model Plugin {
  id            String   @id @db.Char(36)
  tenantId      String   @map("tenant_id") @db.VarChar(36)
  pluginName    String   @map("plugin_name") @db.VarChar(255)
  pluginCode    String   @unique @map("plugin_code") @db.VarChar(100)
  pluginVersion String   @map("plugin_version") @db.VarChar(50)
  author        String?  @db.VarChar(255)
  description   String?  @db.LongText
  pluginUrl     String?  @map("plugin_url") @db.Text
  settings      String?  @db.LongText
  isActive      Boolean  @default(false) @map("is_active")
  installDate   DateTime @map("install_date") @db.Date
  createdAt     DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("plugin")
}

model PluginEvent {
  id            String   @id @db.Char(36)
  tenantId      String   @map("tenant_id") @db.VarChar(36)
  pluginId      String   @map("plugin_id") @db.VarChar(36)
  eventType     String   @map("event_type") @db.VarChar(100)
  eventData     String?  @map("event_data") @db.LongText
  eventStatus   String   @map("event_status") @db.VarChar(50)
  executionTime Int?     @map("execution_time")
  errorMessage  String?  @map("error_message") @db.Text
  timestamp     DateTime @db.DateTime
  createdAt     DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("plugin_event")
}

model ServiceIntegration {
  id              String    @id @db.Char(36)
  tenantId        String    @map("tenant_id") @db.VarChar(36)
  integrationName String    @map("integration_name") @db.VarChar(255)
  integrationCode String    @unique @map("integration_code") @db.VarChar(100)
  serviceType     String    @map("service_type") @db.VarChar(100)
  apiEndpoint     String    @map("api_endpoint") @db.Text
  apiKey          String?   @map("api_key") @db.Text
  authType        String    @map("auth_type") @db.VarChar(50)
  settings        String?   @db.LongText
  isActive        Boolean   @default(false) @map("is_active")
  lastSyncDate    DateTime? @map("last_sync_date") @db.DateTime
  createdAt       DateTime  @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("service_integration")
}

model IntegrationLog {
  id            String   @id @db.Char(36)
  tenantId      String   @map("tenant_id") @db.VarChar(36)
  integrationId String   @map("integration_id") @db.VarChar(36)
  action        String   @db.VarChar(100)
  requestData   String?  @map("request_data") @db.LongText
  responseData  String?  @map("response_data") @db.LongText
  statusCode    Int?     @map("status_code")
  errorMessage  String?  @map("error_message") @db.Text
  executionTime Int?     @map("execution_time")
  timestamp     DateTime @db.DateTime
  createdAt     DateTime @default(now()) @map("created_at")

  @@index([tenantId])
  @@map("integration_log")
}

model ImportShipment {
  id                   String                 @id @default(cuid())
  tenantId             String
  shipmentNumber       String                 @unique // BOL or customs reference
  containerNumber      String?
  vesselName           String?
  voyageNumber         String?
  exporterName         String
  exporterCountry      String // ISO country code
  importerName         String
  importerIEC          String // IEC (Importer-Exporter Code)
  importLicense        ImportLicense?         @relation("ImportShipmentToLicense", fields: [importLicenseId], references: [id])
  importLicenseId      String?
  incoterm             String // CIF, FOB, CNF, DDP, etc.
  cifValue             Decimal                @db.Decimal(15, 2)
  fobValue             Decimal                @db.Decimal(15, 2)
  insuranceValue       Decimal                @db.Decimal(12, 2)
  freight              Decimal                @db.Decimal(12, 2)
  quantity             Decimal                @db.Decimal(12, 3)
  unit                 String // KG, PCS, MT, etc.
  hsCodeLineItems      ImportHSCodeLineItem[]
  customsDocumentation CustomsDocumentation[]
  dutyCalculations     DutyCalculation[]
  status               String // "In-Transit", "PortArrived", "CustomsClearing", "Cleared", "Delivered"
  estimatedArrival     DateTime?
  actualArrival        DateTime?
  clearanceDate        DateTime?
  warehouseId          String?
  vendorInvoiceId      String?
  shipmentTracking     ShipmentTracking[]
  complianceCheck      ComplianceCheckImEx?
  createdAt            DateTime               @default(now())
  updatedAt            DateTime               @updatedAt
  userId               String

  @@index([tenantId])
  @@index([status])
  @@index([estimatedArrival])
}

model ExportShipment {
  id                   String                 @id @default(cuid())
  tenantId             String
  shipmentNumber       String                 @unique // Export reference
  containerNumber      String?
  vesselName           String?
  voyageNumber         String?
  exporterName         String
  exporterIEC          String // IEC for exports
  importerName         String
  importerCountry      String // ISO country code
  salesOrderId         String?
  invoiceId            String?
  incoterm             String // FOB, CIF, CIP, DDP, etc.
  fobValue             Decimal                @db.Decimal(15, 2)
  quantity             Decimal                @db.Decimal(12, 3)
  unit                 String
  hsCodeLineItems      ExportHSCodeLineItem[]
  customsDocumentation CustomsDocumentation[]
  status               String // "Packed", "In-Transit", "Delivered", "Lost"
  shipmentDate         DateTime
  deliveryDate         DateTime?
  shipmentTracking     ShipmentTracking[]
  complianceCheck      ComplianceCheckImEx?
  createdAt            DateTime               @default(now())
  updatedAt            DateTime               @updatedAt
  userId               String

  @@index([tenantId])
  @@index([status])
  @@index([shipmentDate])
}

model ImportHSCodeLineItem {
  id               String           @id @default(cuid())
  tenantId         String
  importShipment   ImportShipment   @relation(fields: [importShipmentId], references: [id], onDelete: Cascade)
  importShipmentId String
  hsCode           String           @db.Char(8) // 8-digit Harmonized System code
  description      String
  quantity         Decimal          @db.Decimal(12, 3)
  unit             String // KG, PCS, MT, etc.
  unitPrice        Decimal          @db.Decimal(12, 4)
  cifValue         Decimal          @db.Decimal(15, 2)
  dutyCalculation  DutyCalculation?
  gstRate          Decimal          @db.Decimal(5, 2)
  gstAmount        Decimal          @db.Decimal(12, 2)
  warehouseStock   StockLevel?      @relation(fields: [stockLevelId], references: [id])
  stockLevelId     String?
  createdAt        DateTime         @default(now())
  updatedAt        DateTime         @updatedAt

  @@index([importShipmentId])
  @@index([hsCode])
}

model ExportHSCodeLineItem {
  id                 String              @id @default(cuid())
  tenantId           String
  exportShipment     ExportShipment      @relation(fields: [exportShipmentId], references: [id], onDelete: Cascade)
  exportShipmentId   String
  hsCode             String              @db.Char(8)
  description        String
  quantity           Decimal             @db.Decimal(12, 3)
  unit               String
  unitPrice          Decimal             @db.Decimal(12, 4)
  fobValue           Decimal             @db.Decimal(15, 2)
  salesOrderLineItem SalesOrderLineItem? @relation(fields: [soLineItemId], references: [id])
  soLineItemId       String?
  createdAt          DateTime            @default(now())
  updatedAt          DateTime            @updatedAt

  @@index([exportShipmentId])
  @@index([hsCode])
}

model DutyCalculation {
  id                   String                    @id @default(cuid())
  tenantId             String
  importShipment       ImportShipment            @relation(fields: [importShipmentId], references: [id])
  importShipmentId     String
  lineItem             ImportHSCodeLineItem      @relation(fields: [lineItemId], references: [id], onDelete: Cascade)
  lineItemId           String                    @unique
  basicCustomsDutyRate Decimal                   @db.Decimal(5, 2) // 0-100%
  basicCustomsDuty     Decimal                   @db.Decimal(12, 2)
  additionalDutyRate   Decimal                   @db.Decimal(5, 2) // 0-20% (countervailing duty)
  additionalDuty       Decimal                   @db.Decimal(12, 2)
  safeguardDutyRate    Decimal                   @db.Decimal(5, 2) // 0-25% (if notified)
  safeguardDuty        Decimal                   @db.Decimal(12, 2)
  antiDumpingDutyRate  Decimal                   @db.Decimal(5, 2) // 0-50% (if notified)
  antiDumpingDuty      Decimal                   @db.Decimal(12, 2)
  totalCustomsDuty     Decimal                   @db.Decimal(15, 2)
  iGSTRate             Decimal                   @db.Decimal(5, 2) // On CIF + Duty
  iGST                 Decimal                   @db.Decimal(12, 2)
  tradeAgreement       TradeAgreementPreference? @relation(fields: [tradeAgreementId], references: [id])
  tradeAgreementId     String?
  preferentialDutyRate Decimal                   @db.Decimal(5, 2) // Reduced duty %
  preferentialDuty     Decimal                   @db.Decimal(12, 2) // If FTA/CEPA applied
  totalPayable         Decimal                   @db.Decimal(15, 2) // Sum of all duties + GST
  createdAt            DateTime                  @default(now())
  updatedAt            DateTime                  @updatedAt

  @@index([importShipmentId])
}

model CustomsDocumentation {
  id               String          @id @default(cuid())
  tenantId         String
  importShipment   ImportShipment? @relation(fields: [importShipmentId], references: [id])
  importShipmentId String?
  exportShipment   ExportShipment? @relation(fields: [exportShipmentId], references: [id])
  exportShipmentId String?
  documentType     String // "BOE", "GatePass", "FF240", "PackingList", "CommercialInvoice", "CertificateOfOrigin"
  documentNumber   String // Official customs reference (e.g., BOE number)
  referenceNumber  String // User-friendly reference
  status           String // "Draft", "Filed", "Approved", "Rejected"
  generatedDate    DateTime
  filedDate        DateTime?
  approvedDate     DateTime?
  rejectionReason  String?
  documentFile     Bytes? // PDF stored as LONGBLOB
  documentPath     String? // If stored on cloud (S3, etc.)
  createdAt        DateTime        @default(now())
  updatedAt        DateTime        @updatedAt
  userId           String
  approverUserId   String?

  @@index([tenantId])
  @@index([documentType])
  @@index([status])
}

model ShipmentTracking {
  id               String          @id @default(cuid())
  tenantId         String
  importShipment   ImportShipment? @relation(fields: [importShipmentId], references: [id])
  importShipmentId String?
  exportShipment   ExportShipment? @relation(fields: [exportShipmentId], references: [id])
  exportShipmentId String?
  location         String // Port, In-Transit, Warehouse, Customs, etc.
  status           String // "In-Transit", "Arrived", "CustomsClearing", "Cleared", "Delivered"
  timestamp        DateTime
  notes            String?
  gpsCoordinates   String? // Lat,Long for real-time tracking
  createdAt        DateTime        @default(now())

  @@index([tenantId])
  @@index([importShipmentId])
  @@index([exportShipmentId])
  @@index([timestamp])
}

model ImportLicense {
  id              String           @id @default(cuid())
  tenantId        String
  licenseNumber   String           @unique // IEC number
  licenseType     String // "Individual", "Partnership", "Company", "Association"
  tradingCategory String // "General", "Restricted", "Prohibited"
  validityFrom    DateTime
  validityTo      DateTime
  status          String // "Active", "Suspended", "Expired", "Cancelled"
  issuedBy        String // DGFT (Directorate General of Foreign Trade)
  importShipments ImportShipment[] @relation("ImportShipmentToLicense")
  createdAt       DateTime         @default(now())
  updatedAt       DateTime         @updatedAt

  @@index([tenantId])
  @@index([licenseNumber])
  @@index([status])
}

model ComplianceCheckImEx {
  id                       String          @id @default(cuid())
  tenantId                 String
  importShipment           ImportShipment? @relation(fields: [importShipmentId], references: [id])
  importShipmentId         String?         @unique
  exportShipment           ExportShipment? @relation(fields: [exportShipmentId], references: [id])
  exportShipmentId         String?         @unique
  gstIECMatch              Boolean         @default(false) // IEC in GSTN matches
  gstEligibleForITC        Boolean         @default(false) // Can claim input credit
  gstRate                  Decimal         @db.Decimal(5, 2)
  gstCompliance            String // "Compliant", "Non-Compliant", "Flagged"
  dgftRestricted           Boolean         @default(false) // Item on restricted list
  dgftLicenseRequired      Boolean         @default(false) // License needed
  dgftLicenseNumber        String? // Reference to license
  dgftStatus               String // "Cleared", "Flagged", "Rejected"
  rbiEligible              Boolean         @default(false) // Complies with RBI guidelines
  femaCompliant            Boolean         @default(false) // Advance remittance allowed
  advanceRemittanceAllowed Boolean         @default(false) // >180 days advance payment OK
  femaStatus               String // "Compliant", "Non-Compliant"
  overallStatus            String // "Compliant", "Non-Compliant", "Flagged", "Rejected"
  issues                   String? // JSON array of compliance issues found
  createdAt                DateTime        @default(now())
  updatedAt                DateTime        @updatedAt
  userId                   String

  @@index([tenantId])
  @@index([overallStatus])
}

model ImportExportPartner {
  id                String   @id @default(cuid())
  tenantId          String
  partnerType       String // "FreightForwarder", "CustomsAgent", "Consolidator", "Bank"
  companyName       String
  licenseNumber     String // CHA, FF license
  licenseCategory   String // "Customs Agent", "Freight Forwarder", etc.
  validUntil        DateTime
  portsOfOperation  Json // Array of port codes
  countriesCovered  Json // Array of country codes
  contactName       String
  email             String
  phone             String
  website           String?
  reliabilityRating Decimal  @default(0) @db.Decimal(3, 1) // 0-5 stars
  turnaroundTime    Int      @default(0) // Days
  isActive          Boolean  @default(true)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@index([tenantId])
  @@index([partnerType])
  @@index([isActive])
}

model HSCodeMaster {
  id                      String    @id @default(cuid())
  tenantId                String
  hsCode                  String    @unique @db.Char(8) // 8-digit code
  description             String
  longDescription         String?
  gstRate                 Decimal   @db.Decimal(5, 2) // 0, 5, 12, 18, 28
  gstCategory             String // "Exempt", "Standard", "Reduced"
  basicCustomsDutyRate    Decimal   @db.Decimal(5, 2)
  additionalDutyRate      Decimal   @db.Decimal(5, 2)
  isExempted              Boolean   @default(false) // GST exempt
  isSafeguardApplicable   Boolean   @default(false)
  isAntiDumpingApplicable Boolean   @default(false)
  isRestricted            Boolean   @default(false) // Restricted import/export
  requiresLicense         Boolean   @default(false) // License needed
  restrictions            String? // "Prohibited", "Licensed", etc.
  notes                   String?
  lastUpdatedFrom         String // "CBIC", "Ministry", "GoI Website"
  lastUpdatedDate         DateTime
  validFrom               DateTime
  validTo                 DateTime?
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt

  @@index([tenantId])
  @@index([hsCode])
  @@index([gstRate])
}

model TradeAgreementPreference {
  id                   String            @id @default(cuid())
  tenantId             String
  agreementName        String // "India-UAE CEPA", "India-UK DTTA", "India-Mauritius CEPA", etc.
  agreementCode        String // ISO code (e.g., "CEPA-AE", "DTTA-GB")
  hsCode               String            @db.Char(8)
  originCountry        String // ISO country code (e.g., "AE" for UAE)
  standardDutyRate     Decimal           @db.Decimal(5, 2) // Normal duty %
  preferentialDutyRate Decimal           @db.Decimal(5, 2) // Reduced duty %
  dutyReduction        Decimal           @db.Decimal(5, 2) // Absolute saving %
  requiresDocuments    Json // ["Certificate of Origin", "Certificate of Authenticity"]
  documentType         String // "Form A", "Form D", "CIQ", "ECS", etc.
  validFrom            DateTime
  validTo              DateTime?
  isActive             Boolean           @default(true)
  dutyCalculations     DutyCalculation[]
  createdAt            DateTime          @default(now())
  updatedAt            DateTime          @updatedAt

       String?   // Reference to license
  dgftStatus              String    // "Cleared", "Flagged", "Rejected"
  rbiEligible             Boolean   @default(false)  // Complies with RBI guidelines
  femaCompliant           Boolean   @default(false)  // Advance remittance allowed
  advanceRemittanceAllowed Boolean @default(false)  // >180 days advance payment OK
  femaStatus              String    // "Compliant", "Non-Compliant"
  overallStatus           String    // "Compliant", "Non-Compliant", "Flagged", "Rejected"
  issues                  String?   // JSON array of compliance issues found
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt
  userId                  String
  @@index([tenantId])
  @@index([overallStatus])
}
model ImportExportPartner {
  id                      String    @id @default(cuid())
  tenantId                String
  partnerType             String    // "FreightForwarder", "CustomsAgent", "Consolidator", "Bank"
  companyName             String
  licenseNumber           String    // CHA, FF license
  licenseCategory         String    // "Customs Agent", "Freight Forwarder", etc.
  validUntil              DateTime
  portsOfOperation        Json                  // Array of port codes
  countriesCovered        Json                  // Array of country codes
  contactName             String
  email                   String
  phone                   String
  website                 String?
  reliabilityRating       Decimal   @db.Decimal(3, 1) @default(0)  // 0-5 stars
  turnaroundTime          Int       @default(0)  // Days
  isActive                Boolean   @default(true)
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt
  @@index([tenantId])
  @@index([partnerType])
  @@index([isActive])
}
model HSCodeMaster {
  id                      String    @id @default(cuid())
  tenantId                String
  hsCode                  String    @unique @db.Char(8)  // 8-digit code
  description             String
  longDescription         String?
  gstRate                 Decimal   @db.Decimal(5, 2)  // 0, 5, 12, 18, 28
  gstCategory             String    // "Exempt", "Standard", "Reduced"
  basicCustomsDutyRate    Decimal   @db.Decimal(5, 2)
  additionalDutyRate      Decimal   @db.Decimal(5, 2)
  isExempted              Boolean   @default(false)     // GST exempt
  isSafeguardApplicable   Boolean   @default(false)
  isAntiDumpingApplicable Boolean   @default(false)
  isRestricted            Boolean   @default(false)     // Restricted import/export
  requiresLicense         Boolean   @default(false)     // License needed
  restrictions            String?   // "Prohibited", "Licensed", etc.
  notes                   String?
  lastUpdatedFrom         String    // "CBIC", "Ministry", "GoI Website"
  lastUpdatedDate         DateTime
  validFrom               DateTime
  validTo                 DateTime?
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt
  @@index([tenantId])
  @@index([hsCode])
  @@index([gstRate])
}
model TradeAgreementPreference {
  id                      String    @id @default(cuid())
  tenantId                String
  agreementName           String    // "India-UAE CEPA", "India-UK DTTA", "India-Mauritius CEPA", etc.
  agreementCode           String    // ISO code (e.g., "CEPA-AE", "DTTA-GB")
  hsCode                  String    @db.Char(8)
  originCountry           String    // ISO country code (e.g., "AE" for UAE)
  standardDutyRate        Decimal   @db.Decimal(5, 2)   // Normal duty %
  preferentialDutyRate    Decimal   @db.Decimal(5, 2)   // Reduced duty %
  dutyReduction           Decimal   @db.Decimal(5, 2)   // Absolute saving %
  requiresDocuments       Json                         // ["Certificate of Origin", "Certificate of Authenticity"]
  documentType            String    // "Form A", "Form D", "CIQ", "ECS", etc.
  validFrom               DateTime
  validTo                 DateTime?
  isActive                Boolean   @default(true)
  dutyCalculations        DutyCalculation[]
  createdAt               DateTime  @default(now())
  updatedAt               DateTime  @updatedAt
  @@index([tenantId])
  @@index([agreementName])
  @@index([hsCode])
  @@index([originCountry])
}
