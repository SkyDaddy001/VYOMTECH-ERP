// ============================================================
// ADVANCED FEATURES MODULE
// ============================================================
// Purpose: Custom Fields, Multi-language, Data Import/Export, Plugins
// Tables: 12

model CustomFieldDefinition {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  fieldName         String   @db.VarChar(255) @map("field_name")
  fieldCode         String   @db.VarChar(100) @map("field_code")
  entityType        String   @db.VarChar(100) @map("entity_type")
  fieldType         String   @db.VarChar(50) @map("field_type")
  fieldLength       Int?     @map("field_length")
  isRequired        Boolean  @default(false) @map("is_required")
  isUnique          Boolean  @default(false) @map("is_unique")
  defaultValue      String?  @db.Text @map("default_value")
  validationRule    String?  @db.Text @map("validation_rule")
  displayOrder      Int      @map("display_order")
  helpText          String?  @db.Text @map("help_text")
  status            String   @default("active") @db.VarChar(50)
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("custom_field_definition")
}

model CustomFieldValue {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  fieldDefinitionId String   @db.VarChar(36) @map("field_definition_id")
  entityType        String   @db.VarChar(100) @map("entity_type")
  entityId          String   @db.VarChar(36) @map("entity_id")
  fieldValue        String?  @db.LongText @map("field_value")
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("custom_field_value")
}

model MultiLanguageResource {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  resourceKey       String   @db.VarChar(255) @map("resource_key")
  language          String   @db.VarChar(10)
  resourceValue     String   @db.LongText @map("resource_value")
  resourceContext   String?  @db.VarChar(100) @map("resource_context")
  lastUpdated       DateTime @map("last_updated") @db.DateTime
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@unique([resourceKey, language, tenantId])
  @@index([tenantId])
  @@map("multi_language_resource")
}

model DataImportTemplate {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  templateName      String   @db.VarChar(255) @map("template_name")
  templateCode      String   @unique @db.VarChar(100) @map("template_code")
  entityType        String   @db.VarChar(100) @map("entity_type")
  fileFormat        String   @db.VarChar(50) @map("file_format")
  columnMapping     String   @db.LongText @map("column_mapping")
  validationRules   String?  @db.LongText @map("validation_rules")
  transformations   String?  @db.LongText
  createdBy         String   @db.VarChar(36) @map("created_by")
  isPublished       Boolean  @default(false) @map("is_published")
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("data_import_template")
}

model DataImportJob {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  templateId        String   @db.VarChar(36) @map("template_id")
  fileName          String   @db.VarChar(255) @map("file_name")
  filePath          String   @db.Text @map("file_path")
  uploadedBy        String   @db.VarChar(36) @map("uploaded_by")
  totalRecords      Int      @default(0) @map("total_records")
  successCount      Int      @default(0) @map("success_count")
  errorCount        Int      @default(0) @map("error_count")
  status            String   @default("pending") @db.VarChar(50)
  errorLog          String?  @db.LongText @map("error_log")
  startTime         DateTime? @map("start_time") @db.DateTime
  completionTime    DateTime? @map("completion_time") @db.DateTime
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("data_import_job")
}

model DataExportTemplate {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  templateName      String   @db.VarChar(255) @map("template_name")
  templateCode      String   @unique @db.VarChar(100) @map("template_code")
  entityType        String   @db.VarChar(100) @map("entity_type")
  columns           String   @db.LongText
  filters           String?  @db.LongText
  sortOrder         String?  @db.LongText @map("sort_order")
  fileFormat        String   @db.VarChar(50) @map("file_format")
  createdBy         String   @db.VarChar(36) @map("created_by")
  isPublished       Boolean  @default(false) @map("is_published")
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("data_export_template")
}

model DataExportJob {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  templateId        String   @db.VarChar(36) @map("template_id")
  requestedBy       String   @db.VarChar(36) @map("requested_by")
  totalRecords      Int      @default(0) @map("total_records")
  exportedRecords   Int      @default(0) @map("exported_records")
  status            String   @default("pending") @db.VarChar(50)
  fileLocation      String?  @db.Text @map("file_location")
  downloadUrl       String?  @db.Text @map("download_url")
  expiryDate        DateTime? @map("expiry_date") @db.Date
  startTime         DateTime? @map("start_time") @db.DateTime
  completionTime    DateTime? @map("completion_time") @db.DateTime
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("data_export_job")
}

model Plugin {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  pluginName        String   @db.VarChar(255) @map("plugin_name")
  pluginCode        String   @unique @db.VarChar(100) @map("plugin_code")
  pluginVersion     String   @db.VarChar(50) @map("plugin_version")
  author            String?  @db.VarChar(255)
  description       String?  @db.LongText
  pluginUrl         String?  @db.Text @map("plugin_url")
  settings          String?  @db.LongText
  isActive          Boolean  @default(false) @map("is_active")
  installDate       DateTime @map("install_date") @db.Date
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("plugin")
}

model PluginEvent {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  pluginId          String   @db.VarChar(36) @map("plugin_id")
  eventType         String   @db.VarChar(100) @map("event_type")
  eventData         String?  @db.LongText @map("event_data")
  eventStatus       String   @db.VarChar(50) @map("event_status")
  executionTime     Int?     @map("execution_time")
  errorMessage      String?  @db.Text @map("error_message")
  timestamp         DateTime @db.DateTime
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("plugin_event")
}

model ServiceIntegration {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  integrationName   String   @db.VarChar(255) @map("integration_name")
  integrationCode   String   @unique @db.VarChar(100) @map("integration_code")
  serviceType       String   @db.VarChar(100) @map("service_type")
  apiEndpoint       String   @db.Text @map("api_endpoint")
  apiKey            String?  @db.Text @map("api_key")
  authType          String   @db.VarChar(50) @map("auth_type")
  settings          String?  @db.LongText
  isActive          Boolean  @default(false) @map("is_active")
  lastSyncDate      DateTime? @map("last_sync_date") @db.DateTime
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("service_integration")
}

model IntegrationLog {
  id                String   @id @db.Char(36)
  tenantId          String   @db.VarChar(36) @map("tenant_id")
  integrationId     String   @db.VarChar(36) @map("integration_id")
  action            String   @db.VarChar(100)
  requestData       String?  @db.LongText @map("request_data")
  responseData      String?  @db.LongText @map("response_data")
  statusCode        Int?     @map("status_code")
  errorMessage      String?  @db.Text @map("error_message")
  executionTime     Int?     @map("execution_time")
  timestamp         DateTime @db.DateTime
  createdAt         DateTime @default(now()) @map("created_at")

  // Relations

  @@index([tenantId])
  @@map("integration_log")
}
